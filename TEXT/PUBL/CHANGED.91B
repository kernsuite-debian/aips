-----------------------------------------------------------------------
;  Copyright (C) 1995
;  Associated Universities, Inc. Washington DC, USA.
;
;  This program is free software; you can redistribute it and/or
;  modify it under the terms of the GNU General Public License as
;  published by the Free Software Foundation; either version 2 of
;  the License, or (at your option) any later version.
;
;  This program is distributed in the hope that it will be useful,
;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;  GNU General Public License for more details.
;
;  You should have received a copy of the GNU General Public
;  License along with this program; if not, write to the Free
;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
;  MA 02139, USA.
;
;  Correspondence concerning AIPS should be addressed as follows:
;          Internet email: aipsmail@nrao.edu.
;          Postal address: AIPS Project Office
;                          National Radio Astronomy Observatory
;                          520 Edgemont Road
;                          Charlottesville, VA 22903-2475 USA
-----------------------------------------------------------------------
          This file must be used to record any changes made to the
   code on the Charlottesville VAX in the logon area [AIPS].  The format
   to use is:

     line 1:  Date    Program name     Your name
     line 2:  What was done
     line 3:  Where has this change been moved (e.g. 15OCT90)
     line 4:  Blank

   The details of line 1 are important since programs are used to find
   specified strings and do conversions on them.  It MUST be typed as
   follows: 1 blank, 4 digits, a period, two blanks, then the Month, day,
   comma, year, some space, a title, some more space, your name.


                      Changes to 15APR91

   ***********************************************************************

          Changes while 15APR91  was TST:

   ***********************************************************************
   ***********************************************************************

   6305.  September 24,1990           MK3IN               Athol/Bill C
          Extensive improvements and enhancements.
          1. Extensions for Spectral Line Data.

          Some changes in the Fourier transform conventions were
          neccessary in handling multiple correlator module lag functions.
          In particular the lag order convention needed to be reversed to
          concatenate the output of the modules. This produced several
          other changes in the Fourier transform of the lag functions to
          cross-power spectra which are discussed in a separate memo.  A
          difference in sign convention between FOURG and QUIKFT was
          resolved.  The cross-power spectra are reversed in frequency and
          have opposite sign of phase with respect to the original MK3IN.
          The frequency order is consistent with the known single dish
          spectra and the sign convention is consistent with the SAO
          program MK3MK2 (which claims to use the NRAO convention).

             AC functions are treated separately and are corrected for bias
          and clipping effects before being transformed to AC spectra.
          Auto-correlation functions are typically generated by
          cross-correlating half the XC lag range. Individual correlator
          modules can however be placed in auto-correlation mode and this
          may be used in the future.  Some changes in the code were
          neccessary to deal with the two methods of generating AC
          functions.
             Correlation functions which do not have the same number of
          lags as the output file are skipped and a warning is printed.
          This is neccessary to avoid 8-lag fringe finding scans which are
          often included in the output tape. A warning message is also
          printed if the centre lag of the correlation function is
          non-zero.  Magic value blanking is used in the lag domain to
          avoid transforming lag functions with missing lags.

          2.  Multiple Observing Bands.
             The new MK3IN produces an FQ table and allows multiple
          observing bands.

          3.  FBS Corrections
             Numerous test were carried out to determine the FBS model
          exactly.  The new version should now do this correctly.

          4.  Checks on A-tape File Structure.
             Some checks were introduced to ensure that the A-tape file
          structure is as expected by MK3IN. The A-tape file headers are
          decoded and the MK3 file parameters are extracted. A warning is
          printed if the tape is a member of a multi-volume SAVEM set, as
          this may cause loss of data.  The type 50 records within each
          extent are required to be in the expected order and only
          complete scan-baseline headers are used.

             These checks should diminish the effect of tape errors which
          may cause loss of synchronization and will also alert the user
          to any future changes in the MK3 data format.

          5. Data Rejection Criteria
             The data rejection criteria used by FRNGE at the Haystack
          correlator were implemented in the new MK3IN version. A
          breakdown of the error statistics is available for each scan
          which can optionally be indexed on correlator module serial
          number. This feature was requested by the Bonn correlator group
          for spectral line data.


          6. Baseline Indexing
             The MK3 tape format is baseline-based and consequently there
          is a high degree of redundancy in source- and antenna-based
          parameters which is the format that AIPS requires. The new
          version of MK3IN assumes that source and antenna parameters in
          files for different baselines may not be consistent and carries
          out several checks in this regard. The data are not rejected or
          changed in any way but a warning message is printed. The
          correlator model input parameters (or closely associated
          quantities) are also monitored throughout the run. A summary of
          the correlator model is printed at the end of the run.
             These consistency checks should help to isolate problems in
          the data set caused by changes in the correlation strategy or
          when merging data correlated at different times or different
          correlators. These checks may also alert the user to any
          unnanounced changes in the MK3 output tape format.

          7. New Input Parameters
             Some minor changes in the input parameters were unavoidable
          but these were kept to a minimum. The APARM parameters are now:

          APARM(1)     CL table increment (min).
          APARM(2)     Maximum parity error rate (def: 0.01) (previously
                       PE count).
          APARM(3)     Maximum dropout rate (def 0.5). Correlator modules
                       are rejected if the number of bits correlated is
                       less than this fraction of the expected correlator
                         count.
          APARM(4)     ge. 1 => No FBS (previous APARM(3))
          APARM(5)     Max no of files on tape to process. (0 = until
                       EOF). This is useful for short test runs where it
                       is important that task terminates normally and
                       writes the full complement  of tables.
          APARM(9)     Print level (0,1,2,3). See below.
          APARM(10)    Debug flag (as before).

          Experiment file parameters:
          STATIONS    Station names (as before).
          TIMEOFF     IAT-UTC  (as before).
          NO_LAGS     Accept only lag functions of this length (if not
                      present this will be set by the first lag function
                      encountered). This parameter was introduced to avoid
                      problems when the first scan is a fringe finding
                      scan.

          NO_IF       Number of AIPS IF's in output file. Introduced for
                      similar reasons to NO_LAGS. Optional, if not given
                      then this is determined from the first scan.

          SIDEBAND    Force double sideband structure in AIPS output file
                      (if this parameter is 'DOUBLE'). Optional, the
                      sidebands will be concatenated if both USB and LSB
                      data are present.

          STOKES      from set {'RR','LL','RL','LR'}. Define the Stokes
                      range of the output file. The largest contiguous range
                      within the parameters is used to define the output
                      file. Optional, if not given this will be determined
                      from the first scan.

          FREQCODE    MK3 character codes for {RR,LL,RL,LR} in that order.
                      These codes are not very standardised. A warning is
                      given if an unidentified MK3 code is encountered.
                      Previously these data were assigned the lowest
                      Stokes value.  (def: 'R','L','r','l').

             The optional parameters defining the AIPS output file
          structure were introduced to deal with tapes containing test
          scans as the first files (eg AC tests) and to force consistency.

          8. Print Levels
          The print levels available are:
          0:      Print only a source header for each scan.
          1:      Include a one line error summary for the scan.
          2:      Print the MK3 file names and extent numbers.
          3:      Produce a error summary for each correlator module.

          9. Miscellaneous
             The time indexing of each data record required modification
          due to a few minor typographical errors and rounding errors. It
          was also discovered that data records may not have time marks at
          integral correlator accumulation periods for the nominal scan
          start time. A scan start time offset is accumulated for each
          scan and the time mark is written for the AP midpoint.
             The HP number conversion routines were checked against known
          HP number reprresentations. A minor error in the conversion of
          single precision reals was found.
             A correlator index is generated from the 20XX module
          cross-reference table before processing each new type 51 data
          extent. This allows video converters to be multiply assigned in
          a given scan and should allow XC/AC mixing. The delay offsets
          can be in arbitrary order in the cross-ref table.

          10. Code Consolidation
             The large common blocks were broken up into smaller units to
          reduce considerable compiler overheads (debug tables) and the
          preamble comments were updated and consolidated.
          Moved to 15JAN91 and 15OCT90  this date.

   6306.  September 24, 1990       VLA cont. calib. test        Bill C.
          Added a new suite of POPS scripts to time and verify the
          correctness of the AIPS continuum calibration software
          especially as used for VLA data.  These tests are patterened
          after the DDT tests and consist of two RUN files: VLACLOAD.001
          and VLACEXEC.001; the first to read in procedures and the second
          to execute the tests.  The two HELP files are VLAC.HLP and
          VLACSAVE.HLP.  The test data and the master copy of the answers
          are on a FITS tape and were computed on a Sun 3/60.  The test
          will run in 15JAN91 and later releases of AIPS.  The tasks
          tested in some modes are: UVLOD, IMLOD, FITTP, UVCOP, TABED,
          UVFLG, SETJY, CALIB, TASRT, TASAV, GETJY, CLCAL, PCAL, TACOP,
          CLCOR, LISTR, SPLIT, UVDIF, HORUS and COMB.
          Moved to 15JAN91 this date.

   6307.  September 24, 1990          PCAL, PCAL.HLP     Bill C.
          Added option (CPARM(1)) to average IFs.
          Moved nowhere.

   6308.  September 24, 1990        Bad characters in POPS   Bill C.
          Added traps for bad characters in INPUT, GO, TPUT, TGET, SHOW
          and TELL by adding calls to VERSTR in AU1A, AU2, AU2A.
          Moved nowhere.

   6309.  September 24, 1990        Bad character traps        Bill C.
          Added two new routines for trapping bad characters:
          APLSUB:CHKCHR.FOR  Checks that all characters in a string are
             one of the following: A-Z, a-z, blank, 0-9 and
             +-*?_=!@#$%^&(){}[]:";~`,./<>|
          AIPSUB:VERSTR.FOR  Checks that a character string or array in
             POPS memory contains only valid characters.
          Moved nowhere

   6310.  September 24, 1990              AVSPC                Phil
          After much negotiation with Neil we have finally settled
          on what AVSPC should do with the reference frequency,
          it leaves it alone, so the reference pixel is updated to
          reflect freq. changes due to channel selection. Also
          the bandwidth in the output file is the input bandwidth
          * the number of channels averaged.
          Moved to 15OCT90 and 15JAN91 today.

   6311.  September 24, 1990                 BPASS                Phil
          There were two problems remaining with LL polarized line
          data: (1) If the user had a dual polzn database and
          requested solutions for LL alone, an indexing error
          caused the channels to be shifted to the right by one,
          this meant that the last channel in the internal buffer
          was occupied by the u, v, w of the next record, this
          caused large closure error messages to be printed.
          (2) Also in a dual polzn database, when dividing by
          an external channel 0, another indexing error caused
          the LL line data to be divided by the RR continuum.
             I discovered that I had also broken the ability to
          generate seperate BPASS entries for multiple bandpass
          calibrator scans.
          Moved to 15OCT90 and 15JAN91 today.

   6312.  September 24, 1990                ACFIT              Phil
          I added the ability to use the SNVER adverb, by incorporating
          a call to the CALSEL subroutine. In the course of debugging
          this I fixed a couple of other problems: (1) the last entry
          for a particular run of ACFIT had the incorrect source number;
          (2) if the user just wanted to solve for a single antenna
          rather than all antennas, there were logic problems, although
          it still worked; (3) if there was no valid data at all for
          a particular solution the program printed confusing error
          messages, but again still worked.
          Moved to 15JAN91 this date.

   6313.  September 24, 1990         New adverbs                   Phil
          Two new task-specific adverbs, XAXIS is used in SNPLT to
          specifiy which type of axis is to be plotted on the abscissa;
          DOERBAR is used by VBPLT and SNPLT to specify the use of
          error bars on the plots. Modified POPSDAT.HLP and NEWPARMS.001.
          Moved to 15JAN91 this date.

   6314.  September 24, 1990           AIPSPUBL:COOKZ.TEX        Bill J.
          Changes at the AOC necessitated changes in this document.
            (1) OS 8.1 tape handling is somewhat different.
                  Changed this for nrao1 also.
            (2) AIPS logical disks were renamed a couple of weeks back.
            (3) An additional disk was added on yucca.
            (4) Printer queues were changed to allow use of QMS PS 1500
                laser printer.
            (5) Various typos and errors in layout were fixed.

          Moved nowhere.

   6315.  September 24, 1990         UVBAS              Juan Uson/Bill C
          Fixed a problem with flagged channels.  If a channel was
          flagged, no higher channel numbers were processed in averaging
          the "continuum" channels.
          Moved to 15JAN91 this date.

   6316.  September 24, 1990            UVPLT                  Phil
          Added the user option (BPARM(10)) to include the autocorrelation
          spectra in any plot made. The default is not to use that
          data. Modified the help file accordingly.
          Moved nowhere.

   6317.  September 24, 1990           MAKMAP/UVPREP/HORUS     Glen
          MAKMAP was modified to call UVGRTB which will grid any size
          problem (up to 4096).  Unfortuately an assumption in a
          subroutine UVPREP was not correct for HORUS (although it was
          correct for MX.)  UVPREP fixed and HORUS relinked.
          Moved to 15JAN91 this date.

   6318.  September 24, 1990           MX                      Glen
          Surprise. A long standing bug was uncovered.  MX did not scale
          U,V,W to second IF for data selection.  This caused some data
          to be outside ALGSTB, ALGSUB limits in gridded subtraction.
          Particularily frequent when working with multi-array data.
          Modified only MX subroutine MXSEL.
          Moved to 15JAN91 this date.

   6319.  September 25, 1990               AVSPC                  Phil
          A philosophical argument with Neil was finally resolved
          (in Neil's favour unfortunately), and the calculation of the
          new reference pixel was changed.
          Moved to 15OCT90 and 15JAN91 today.

   6320.  September 26, 1990     AIPSHELP.HLP                  Bill C.
          Next Designated AIP cycle.
          Moved nowhere.

   6321.  September 26, 1990     MK3IN.FOR                     Athol
          Extended visibility buffer size from 1024 to 2048. Also
          some changes to cope with null A-tape records  (type 50, id=0).
          Moved nowhere.

   6322.  September 27, 1990     MK3IN.FOR                     Athol
          Correct bug in data rejection criteria.
          Moved nowhere.

   6323.  September 30, 1990     APGNOT:FILLM.FOR              Gareth
          This new version of FILLM represents several months' reworking
          and debugging.  The major changes are as follows:
          1.  The keywords associated with the multi-source files have
          been changed from LINECHAN and CORRMODE to OBSCHANS, CORRMODE,
          SELCHANS, and VLAIFS.  This is to permit more sophisticated
          selection criteria for appending data to existing datasets.
                  OBSCHANS        number of channels on VLA archive tape
                  CORRMODE        the VLA correlator mode
                  SELCHANS        channels selected from OBSCHANS
                  VLAIFS          the names of the VLA IFs used
          (OBSCHANS and SELCHANS are not used for continuum data.)  A
          multi-source file is checked for all of these parameters as well
          as the Band, # polarizations, 1st Stokes' parameter, and # IFs
          to determine whether data should be appended to the file by
          FILLM.  This change will mean that this version of FILLM cannot
          append data to databases created by previous versions.
          2.  The naming convention for output files has been simplified.
          The classes are '? BAND' for continuum, and 'LINE' and 'CH 0'
          for spectral line.  Classes such as 'CH 0 1' are obsolete.
          3.  A new source (NX) entry is now forced whenever the Start LST
          of the observation changes.  This is how the VLA on-line system
          marks a new scan.  This forces a new source in some cases where
          the older versions did not.  It has a two main advantages: it
          reliably detects a source scan change without checking for the
          almost infinite possible changes in the set-up of the
          observations; and it allows QUACK to be run subsequently for
          each change of the on-line system configuration.  The only
          disadvantage, that logically contiguous data are now in separate
          scans, can be easily addressed by running INDXR post facto.
          4.  The subroutine MCWANT, which controls the selection of data
          and the changes in configuration, has been completely recast.
          Selection criteria that are always in effect are timerange (and
          date), program name, and VLA subarray.  Selection criteria that
          may be overridden by DOALL=1 (true) are observing mode, number
          of channels per baseline, frequency, and band.
          5.  All possible spectral line observations with the VLA are now
          fully supported.  The flexibility now built in to the VLA
          on-line system is reflected in the complexity of the subroutine
          MCINI.  There are 26 different ways (3 continuum and 23 spectral
          line) of writing the data into up to 8 multi-source files in
          parallel.  (An additional 8 ways, for mixed continuum and
          spectral line data, are supported here but not yet provided by
          the VLA).
          6.  The derivation of the number of channels per IF has been
          moved from subroutine MCINI to MCH1, where most other control
          information from the VLA archive tape is decoded.
          Bugs fixed include:
          1.  FILLM did not always correctly respond to a configuration
          change, such as FQ number or correlator mode, when averaging
          data.  This was helped by the simpler and more rigorous scan
          change criterion (see above).  A change introduced in February
          1990 in the 15APR90 version had this unreliability as an
          undesirable side effect.
          2.  A baseline record that was split between to physical tape
          records had a jump in phase.  The subroutine MCGBRC miscounted
          by 1 the number of data points (real and imaginary being counted
          as 2) left at the end of the first record.  This change was also
          introduced in February 1990 and was not noticed for several
          months except by two careful observers.  It did not affect
          continuum data at all.  Since the VLA has been in the larger (A
          and B) configurations since that time, there has not been much
          use of the spectral line modes.
          Moved to 15JAN91 this date.

   6324.  October 1, 1990           APLSUB:LMPIX.FOR              Bill J.
          IMLOD failed when trying to read an IMPS(!) tape due to
          divide-by-zero in LMPIX when setting up the reference pixel.
          Trap added.
          Moved nowhere.

   6325.  October 3, 1990        New directories/logicals      Bill C.
          Added several new directories and corresponding logicals in
          AREAS.DAT.
          ...APL/DEV/UNIX/BERK/IBM (APLIBM) IBM RS/6000 Z routines
          ...APL/DEV/UNIX/BERK/DEC (APLDEC) Decstation Z routines
          ...Q/DEV/PSAP/IBM (QIBM) IBM RS/6000 Q routines
          ...Q/DEV/PSAP/DEC (QDEC) Decstation Q routines
          ...INC/NOTST/IBM (INCIBM) IBM RS/6000 includes
          ...INC/NOTST/DEC (INCDEC) Decstation includes
          ...SYSTEM/UNIX/IBM (SYSIBM) IBM RS/6000 shell scripts etc.
          ...SYSTEM/UNIX/DEC (SYSDEC) Decstation shell scripts etc.
          ...APL/CONTRIB (APLCONTR) is a directory for contributed
          software that is not to be included in the standard installation
          but is available for users to compile, link and use.  Source and
          HELP files go in this directory.
          Moved to 15JAN91 this date.

   6326.  October 4, 1990                 POSSM                     Phil
          Minor logic error caused the freq. labelling of the x-axis
          to fail. Fixed.
          Moved to 15JAN91 this date.

   6327.  October 9, 1990    Contributed code from Leiden  Walter Jaffee/Bill C
          A number of tasks and their help files were put in directory
          APLCONTR where they can be manually compiled and linked.  These
          tasks may not run (or even compile) on a given machine.
          These are:
          WSLOD - Read Westerbork data tapes
          RDCAL - Westerbork style redundancy calibration.
          SAD   - Finds sources and fits Gaussians to an image.
          CCNTR - Plots symbols at positions of components in a CC table
                  the way CNTR plots ST tables.
          STARC - Read a CC table from an ASCII table (the analog of STARS
                  for ST tables).
          Moved to 15JAN91 this date.

   6328.  October 11, 1990           POSSM                          Eric
          Changed the setting of plot scales to avoid the 360-degree phase
          ambiguity when possible and to give some slight borders around
          the data.  Also corrected an error message.

          Used the latest version from CV to return to CV, but did not
          keep it here.  It claims to do phase shifting for position
          offsets but does not support sprectral-line data - and this in a
          spectral-line program!
          Moved from Oz this date to 15APR91 and 15JAN91.

   6329.  October 11, 1990       SPFLG, TVFLG, Calibration          Eric
          Changed:
          SOUFIL    It did not close the SU table on error and did not
                    examine the kind of error from ISTAB but simply
                    assumed that any ISTAB error meant non-existant SU
                    table (a non-error condition).  Now it will close
                    the table and treats most ISTAB errors as real errors.
          OTBSRT    Changed it to write a scratch table as the output
                    and then to rename it to the desired output name
                    only if everything has worked.  Otherwise, when a
                    file was sorted onto itself it could be destroyed
                    by any error.
          TABSRT    Removed close of input table - it is always needed
                    now to go to scratch table.  Corrected a recent
                    addition to the code --- it is okay to exit quickly
                    when there are no records, but only if the OUTVER
                    is the same as the INVER.
          SPFLG     Changed to call SOUFIL only when it is relevant and
                    to honor its error return.  Before it called it always
                    and ignored the error return.
          TVFLG     Changed to call SOUFIL only when it is relevant and
                    to honor its error return.  Before it called it always
                    and ignored the error return.
          Moved from Oz this date to 15APR91 and 15JAN91.

   6330.  October 11, 1990         SPFLG, TVFLG                    Eric
          Changed them so that when they apply the flags to the main
          FG table they remove them from the master grid file.  This
          means changing the FC table to zero entries and going
          through the master grid file and magic-value blanking all
          SPFLG'd or TVFLG'd pixels.
          Moved from Oz this date to 15JAN91 and 15APR91.

   6331.  October 11, 1990             LISTR                     Eric
          Changed SCAN display to show number of visibilities for each
          scan in the NX table list whenever the display is wider than
          79 characters.
          Moved from Oz this date to 15JAN91 and 15APR91.

   6332.  October 11, 1990            SETJY                     Eric
          Cleaned up the typing and display of the input values in the
          history routine.  Added 1934-634 for AT folks and increased
          the formula to 4th order.  Did other clean ups of typing and
          logic, including getting all calculated fluxes into the HI.
          Moved from Oz this date to 15APR91 only.

   6333.  October 11, 1990       SPFLG, TVFLG, TVFIDL            Eric
          Changed SPFLG to display time and channel in all flagging
          modes.  Otherwise, the flux displayed doesn't mean much.
          Also changed SPFLG to force TVPSEUDO to display some color
          initially.  And changed TVFIDL to do have better initial
          values and hence not zoom further when it starts zoomed
          and to do black and white first even if a zoom was done
          ahead of all coloring.  Changed TVFLG as SPFLG.
          Moved from Oz this date to 15APR91 and 15JUL91.

   6334.  October 11, 1990          SCHOLD                        Eric
          Corrected SCHOLD to move 4 characters to upper case so that
          "quit" would be accepted as such rather than as an (illegal)
          AIPS verb.
          Moved from Oz this date to 15APR91 and 15JAN91.

   6335.  October 11, 1990     AVSPC                     Bill C.
          Added option to average in IF as well as frequency by calling
          routine AVGIF.  Added adverbs AVOPTION, BIF and EIF.  Modified
          the description of the function of the task in AVSPC.HLP.
          Moved nowhere.

   6336.  October 11, 1990      New adverb AVOPTION     Bill C.
          Added new adverb AVOPTION (averaging option) in POPSDAT.HLP,
          NEWPARMS.001 and AVOPTION.HLP.
          Moved nowhere.

   6337.  October 11, 1990        AVGIF                  Bill C.
          New routine in APLSUB to average a visibility record in IF and
          frequency, selecting frequency channels and a range of IFs.
          Moved nowhere.

   6338.  October 11, 1990        UVAVG                          Bill C.
          Modified not to take weighted sum of source and FQ id
          parameters.  This putting garbage into these variables.
          Moved to 15JAN91 this date.

   6339.  October 11, 1990   APLIBM:* SYSIBM:* INCIBM:* QIBM:*   Brian
          Checked Kerry's IBM RS/6000 modifications into the system.
          The files were:
          APLIBM:
          D2IBM.FOR    ZCREA2.C      ZGNAME.FOR      ZTAP2.C         ZTPWAD.C
          D2IEEE.FOR   ZDATE.C       ZLPCL2.C        ZTIME.C         ZTQSP2.C
          S2IBM.FOR    ZDCHI2.FOR    ZR32RL.FOR      ZTKILL.C        ZTTOPN.FOR
          S2IEEE.FOR   ZDCHIC.C      ZR64RL.FOR      ZTPCLD.C        ZTTYIO.FOR
          ZABOR2.C     ZDEAXF.FOR    ZRLR32.FOR      ZTPMID.C        ZTXMA2.C
          ZABORS.C     ZFRE2.C       ZRLR64.FOR      ZTPMIO.FOR
          ZGNAM2.C     ZTACT2.C      ZTPOPD.C
          (ZACTV9 is checked out by Chris - I'll put it in later).

          INCIBM:
          DAPC.INC        DBUF.INC        DSEL.INC

          QIBM:
          QCFFT.FOR       QINIT.FOR       QRLSE.FOR
          QCLNSU.FOR      QMULCL.FOR      WHNALT.FOR

          SYSIBM:
          AIPS           ASSNLOCAL.SH    FCOPTS.SH    LIBR.DAT   ZLPCL2
          AIPXAS         CCOPTS.SH       INCS.SH      LINK       ZTRLOG.C
          ASOPTS.SH      CDVER.CSH       LDOPTS.SH    OPT2.LIS
          ASSNLOCAL.CSH  CDVER.SH        LIBR         PP
          Moved to 15JAN91 this date.

   6340.  October 15, 1990      DOCTXT:UGUIDE,VGUIDE.RNO     Bill C.
          Updated for     15OCT90 release.
          Moved nowhere.

   6341.  October 16, 1990                   IBLED             Phil
          Several new features and some bug fixes:
          (1) IBLED now has a mode in which it can create catalogued
              uv work files to which you can return for an editing
              session. (I call this its 'fire-and-forget' mode).
          (2) It now creates all its necessary scratch files at the
              start of the session to avoid disc space problems later.
          (3) The antennas, baselines adverbs are now used to select
              antennas to be edited.
          (4) The handling of the FC tables has been changed, previously
              when an FC table existed reading it and applying its
              contents was a painfully slow business. This table is now
              sorted to time order and the application is much more
              efficient.
          (5) IBLED could not apply the flagging information to single
              source compressed files, fixed this.
          (6) When averaging in time there was an error which caused
              one more visibility to be averaged each time, i.e. you
              asked for 2 minutes averaging time, you got three.
          (7) The times in the FG table were equal to time +/-
              interval/2, this was wrong it is now time +/- interval.
          (8) A display buffer was not being cleared so that when a
              new baseline or frame was displayed with a smaller number
              of points the old data from the previous buffer load was
              still visible.
          Also changed IBLED.HLP
          Moved to 15JAN91 and 15OCT90 this date.

   6342.  October 17, 1990                  CVEL             Phil
          I ran a profile on cvel and discovered that 28% of the cpu time
          was spent in TABIO, this was due to the fact that the CL table
          was read from the beginning for each visibility until the
          doppler freq. offset for a particular time was found. I
          changed this to keep an index of where I was in the CL table
          for each antenna and CL time and interval, this reduces the
          amount of TABIOing needed dramtically.
          Moved to 15JAN91 this date.

   6343.  October 17, 1990              MX                  Glen
          Slight modification to correct Max, Min UVrange to
          allow second IF to be included in UV data if first IF fits
          in allowed range.

   6344.  October 17, 1990     ALGSTB/UVGRTB/UVGRID/UVAPAS  Glen
          Corrections to routines to correctly handle multi-if data for
          case when not all map fits in "AP".  Essentially requires
          multi-channel passes for two IFs widely separated.  Single
          IF and case of all map in "AP" are not affected by the changes.
          Will move to 15JAN91 in a week.

   6345.  October 17, 1990    DDTLOAD.001                   Glen
          Added declaration of adverb TERSE to user environment.
          If TERSE greater than 1, then PRTAC is NOT run.
          Moved to 15OCT90 and 15JAN91.

   6346.  October 17, 1990   IMLOD/UVLOD/FITTP               Brian
          To work around a bug in the Sun f77 compiler, the number
          -2147483648 was changed to -2147483647 - 1. (In 2s complement
          most_positive_int < abs(most_negative int)).
          Moved to 15JAN91 and 15OCT91 (tape) this date.

   6347.  October 19, 1990           XVSS                      Chris
          XVSS may now optionally use the MIT shared memory extension to
          the X Windows System.  This should speed up XVSS on machines
          with large amounts of physical memory.  In order to use the
          shared memory extension you must have a version of Unix that
          supports System V shared memory: SunOS supports this as an
          option (the kernel may have to be rebuilt on some systems).  You
          must build XVSS with SHMOPT set to -DUSE_SHM in the Makefile and
          add the line:
            {\tt xvss.useSharedMemory: True}
          to the X resources database before starting XVSS (the X
          resources database is normally initialised from {\tt
          .Xdefaults}).  If this line is missing or {\tt
          xvss.useSharedMemory} is set to {\tt False} shared memory is
          disabled.  This is recommended for machines with smaller
          memories since the use of large amounts of shared memory may
          cause severe paging problems.
          Also replaced the Makefile, which was missing from the .SHR
          file and made the following minor changes.
          - Excessive blank space has been removed from the control panel.
          - XVSS will now read the colour of the graphics plane from the
          {\tt xvss.graphicsColor} (for Americans who can't spell)
          resource in the X resource database.  The value of {\tt
          xvss.graphicsColor} may be a named colour from the X colour
          database or a hexadecimal specification in the normal X11
          #RRGGBB format.  The default colour is now green (the previous
          purple colour has a poor contrast against the blue dominated
          AIPS spectral colourmaps, particularly on slides);  users with
          the old style Sun greyscale monitors that run off the red gun
          may wish to set {\tt graphicsColour} to {\tt red} or {\tt
          white}.
          - XVSS now has OPEN LOOK help available for all components.
          This is limited at the moment since the current version of XView
          does not support scrolling help windows but it does provide an
          on-line reminder of the keyboard accelerator bindings.  The
          help text is provided in a seperate uuencoded file, xvss.uu,
          because the bloody checkin system on CVAX won't accept the long
          lines of text.
          Moved to 15JAN91 this date (because of missing Makefile).

   6348.  October 19, 1990        APGNOT:FILLM.FOR        Gareth
          A bug in routine FLMDAT was causing the CH0 and LINE datasets to
          differ in the number of visibility data points.  This annoyed
          BPASS considerably.  The bug only occurred when the last
          visibility of a given time-stamp was flagged bad.  The logic
          error had also caused the first good visibility after a flagged
          visibility in a given time-stamp to be rejected!  This had not
          been noticed.  The bug only affected spectral line data, but the
          missing visibility occurred in continuum data as well.
          Moved to 15JAN91 and 15APR91 this date.

   6349.  October 22, 1990       APGNOT:DAYFX.FOR         Glen
          Array crash caused times to be set to zero.  Previous version
          of DAYFX fixed the DAY but left time 0, so TVFLG and many
          other tasks would not work.   DAYFX now fixes day as before,
          but if, after fix, the time is still less than previous, the
          time is set to previous time.  No data flagging is done.
          Moved nowhere.

   6350.  October 22, 1990        ZLOCK in APLBERK                Chris
          Added a conditional compilation branch that uses the POSIX
          fcntl interface to file locking if _POSIX_SOURCE is defined.
          As POSIX advisory locks use a separate mechanism from the
          BSD flock() interface this may clear up the problems due to
          apparently spurious locks under Convex OS.  Unfortunately,
          the separate mechanism also means that there is a risk of
          files being corrupted or information being lost until all AIPS
          tasks have been linked with the new variant.  In case the
          locking problems do not vanish the POSIX code branch will
          attempt to get information on any conflicting lock and print
          the ID of the process that has locked the file; this is not robust
          --- it is possible that the locking process could release a lock
          in the interval between ZLOCK detecting that the file is locked and
          ZLOCK requesting information about the lock (the PID will then
          be meaningless).
          Moved nowhere pending thorough testing.

   6351.  October 22, 1990        APGNOT:FILLM            Gareth
          Fixed two tests in the selection criteria that were reversed
          (qualifier and channel code) and led to the exclusion of the
          requested data rather than the inclusion.
          Moved to 15JAN91 and 15APR91 this date.

   6352.  October 23, 1990       POSSM                      Phil
          When the phase centre shifting option was invoked the shift
          done was a constant across the band. This was in error the
          u, v, w's used to calculate the shift should have been
          scaled with frequency for each channel and the phase rotation
          calculated with the scaled values. This is now done, the
          error in most cases was fairly minor since the frequency
          difference across the band is normally a very small fraction
          of the observed frequency.
          Another minor bug, when the user wished to plot the BP table
          and specified a source name then that was compared with the
          sourcename in the table, if they didn't match the data were not
          selected for plotting. I had missed the case of the source
          number in the table being 0, in which case it should be plotted.
          Fixed that.
          Moved nowhere.

   6353.  October 25, 1990    APLSUB:CATKEY               Brian
          There was an off by one error so that an illegal type (of 0)
          was being accepted.
          Moved 15JAN91 this date.

   6354.  October 25, 1990     APLSUB:SCREAT               Brian
          SCREAT was modified to put the SYSTEM name (SYSNAM in DDCH)
          in any scratch files it creates in 3 keywords, SYSNAME1,
          SYSNAME2 and SYSNAME3. The idea is that we only want to
          automatically destroy scratch files created on the current
          cpu since we can't yet interrogate processes on remote
          machines.
          Moved nowhere.

   6355.  October 25, 1990    AIPSUB:DESCR               Brian
          Check the system name keywords in the scratch files
          and only delete files that either belong to this CPU or
          don't have the keywords in the scratch file (so this system
          and the old one can coexist without the disk filling up with
          scratch files).
          Moved nowhere.

   6356.  October 25, 1990    APLBERK:ZTQSP2               Brian
          Use a better heuristic to cut down on the number of aips only
          processes (something at the end of a line that has capital
          letters and ends in a number).
          Moved to 15JAN91 this date.

   6357.  October 26, 1990      SYSIBM APLIBM INCIBM      Brian
             SYSIBM:AIPS     - source rather than execute AIPXAS
             SYSIBM:AIPXAS   - allow XAS display on remote hosts.
             APLIBM:ZACTV9   - ZACTV9 was out and couldn't be checked
                               in earlier.
             APLIBM:ZFRE2    - AIXized so that free now works.
             APLIBM:ZTQSP2   - Spy now works
             APLIBM:ZMOUN2   - Mount issues a rewind and selects
                               the correct device for 1600 or 6250
                               density. In general this will need to be
                               changed from site to site, althout most
                               machines won't have a 1/2" tape drive.
             INCIBM:DSEL.INC - No longer needed by xlf.
             INCIBM:DBUF.INC - No longer needed by xlf.
          Move to 15APR91 this date.

   6358.  October 29, 1990     APLIBM:ZLPCL2.C              Brian
          Removed this stubbed version so we can print from the ibm.
          Removed from 15JAN91 this date.

   6359.  October 30, 1990     APLNOT:SOUELV.FOR            Glen
          Limited hour angle output range to between -12 and 12
          hours (-pi to pi).
          Moved to 15JAN91 this date.

   6360.  October 31, 1990     INC/DAPC.INC QPSAP           Glen
          Modified the QPSAP Pseudo-AP memory size include file,
          Increasing the default size to a total of 256 K Words.
          The main AP size is 64 K and the secondary is 192 K.
          The subroutine QPSAP/QINIT was modified to automatically
          take advantage of the larger size.
          Moved Nowhere.

   6361.  October 31, 1990     QPSAP/QCLNSU.FOR             Glen
          Modified this routine to eliminate conversions from
          integer to real in most cases.  Significantly speeds
          machines with fast floating point operations.  If
          savings is significant, this will be moved to new.
          Moved Nowhere.

   6362.  October 31, 1990        DOCTXT:USERNO.LIS       Gareth
          The file USERNO.LIS is used by various site-specific routines to
          display the local system use.  It contains the NRAO user number
          list.  This has not heretofore been part of the standard
          distribution for reasons that I do not understand.  It is now.
          Moved to 15JAN91 this date

   6363.  October 31, 1990           AIPS' K array                     Eric
          Changed POPSGN, AIPS, AIPSB, and AIPSC to use a 950-word array
          in the K array for temporary litorals.  The previous limit of
          250 was too little for Bill's new DDT clone.  Changed SGLOCA to
          force a new SG-file version.
          Moved from Oz this date to 15APR91 only.

   6364.  November 1, 1990      DOCTXT:APPENDIXC.TEX          Bill C
          Updated description of thecontents of the GRfile to include the
          one-line summary and e-Mail entries.
          Moved nowhere.

   6365.  November 1, 1990            CLBSNR                 Phil
          In the self-cal mode of CALIB, and when no closure errors
          are requested to be printed, CALIB changes the no closure
          errors to huge closure errors just to catch ridiculous
          values. This is OK but the user then gets a message on his/her
          screen for every integration. Changed this to print out the
          closure error message header only when there is an error.
          Moved to 15JAN91 this date.

   6366.  November 1, 1990               APLNOT:NCALC        Phil
          NCALC assumed that routine DNRM2 was still a function but
          it was changed to a subroutine months ago. I'm surprised
          no one tripped over this before, I suppose it shows how
          often the GCON option in CALIB is used.
          Moved to 15JAN91 this date.

   6367.  November 2, 1990               SPFLG                        Eric
          Corrected error which caused an incorrect upper channel number
          to be used for actual flagging when in the one-channel mode.
          Moved from Oz to 15JAN91 and 15APR91.

   6368.  November 2, 1990            SGLOCA                       Eric
          Corrected bad code for POPS error handling.
          Moved from Oz to 15JAN91 and 15APR91.

   6369.  November 2, 1990            AIPS                         Eric
          Corrected to actually abort on an error in INIT and not to
          say "ABORT!!!" when the Sg LASTEXIT file is too old.
          Moved from Oz to 15JAN91 and 15APR91.

   6370.  November 2, 1990           SQASH                        Phil
          Apparently SQASH has never worked when a sub-image in the first
          two coordinates was requested. The code looped from 1 -> NY
          (where NY = # output pixels in y direction) whereas it should
          have looped from BLC(2) to TRC(2). The loop in the x-direction
          was OK.
          Moved to 15JAN91 today.

   6371.  November 2, 1990           APLPGM:UVDIF.FOR             Glen
          Has been broken for some time for UN-Compressed UVdata.  (At
          least uncompressed UVdata in the DDTs.)  Recent fix to allow
          Compressed data caused it to die for Uncompressed, so
          Compressed data checks are skipped for uncompressed data.
          Moved to 15JAN91 this date.

   6372.  November 2, 1990           APGNOT:MK3IN.FOR             Athol K.
          Updated the maximum number of correlator module entries
          expected in the correlator module cross-reference table
          for each baseline. The MK3 documentation suggested that
          that 100 was a reasonable choice but a tape was encountered
          with 112 entries (new maximum = 200).
          Moved nowhere.

   6373.  November 2, 1990            AIPSPUBL:COOK11.TEX      Phil
          Added a section on fringe-fitting MkIII data. Also changed
          references to CALIB to FRING where relevant.
          Moved nowhere.

   6374.  November 6, 1990          UVLOD                 Phil
          Athol and I encountered a situation where the array decleration
          for VISPRT in subr. UVFDAT was not big enough. Changed it to be
          4096 rather than 512.
          Moved nowhere.

   6375.  November 6, 1990           FITTP                    Bill J.
          Subroutine EXTWRT was not writing flagged table rows to tape
          (IERR = -1 from TABIO in "READ").  Consequently, there was a
          mismatch between the number of records written in "NAXIS2"
          and what was actually on the tape.  This caused PRTTP problems
          (and UVLOD too, I would think).  Now, FITTP writes ALL rows
          to the output buffer.
          Also corrected a typo: "ISORTORD =" --> "ISORTORD=".
          Moved to 15JAN91 today.

   6374.  November 7, 1990           FITTP                   Bill J.
          The act of writing all rows to the tape effectively unflags
          the flagged rows (see 6375) so instead FITTP now finds the
          actual number of unflagged rows and writes these only to tape.
          The value of NAXI2 is the number of unflagged records --- i.e.
          the actual number transferred to tape.  Obviously, the fact
          that the contents of the tape are different from the disk file
          means that this is at variance with our usual philosophy.  This
          is temporary and should be revised when the FITS tape writer
          is modified for VLBA data.
          Moved to 15JAN91 today.

   6375.  November 7, 1990            CLBSNR             Phil
          Moved the printing of the closure phase error header message
          down 2 lines, in its current position it printed the header
          > 1 times before printing the closuer errors.
          Moved to 15JAN91 this date.

   6376.  November 7, 1990            FILLM                     Bill J.
          Added call to CHLTOU (case conversion) for the observing program
          id prior to comparison with the user-supplied character string.
          This needed for the rare cases where the program code is lower case
          due to bug in OBSERVE.
          Moved nowhere.

   6377.  November 8,  1990       CONVL                Bill C.
          Fixed several logic errors that kept OPCODE='DGAU' from working.
          Also the values of T and F (true and false) were not set in
          CONDIV.  CONVL probably still doesn't work in this mode but at
          least it runs to completion.
          Moved nowhere.

   6378.  November 8, 1990        APLNOT:TABFQ, TABNDX     Gareth
          Minor changes in the declarations of EQUIVALENCEd arrays in
          TABFQ and TABNDX so that they can be used, in debugging, with
          array bounds checking turned on.
          Moved to 15APR91 and 15JAN91 this date.

   6379.  November 9, 1990      APLIBM:ZDELA2         Tom Pauls/Brian
          Tom Pauls has supplied a nice ZDELA2 (based on sleep/usleep)
          that actually works. I put in a paranoid error check.
          Moved from NRL to 15APR91 and 15JAN91 this date.

   6380.  November 10, 1990          IBLED                Phil
          More new features and bug fixes.
          (1) Users had complained about the way IBLED switched between
              the editing and menu screens, this caused a lot of
              flashing on the IIS and IVAS and was painfully slow on
              the Sun's. Changed so that now the menu's appear on the
              same screen as the editing frame, they are always visible.
              Makes the process much more efficient.
          (2) Added a new menu option: SELECT FRAME - which enables the
              user to select his/her own frame to be edited by
              positioning the cursor on the total vis. fn at the top
              and define a start and stop position., this is then
              displayed in the main editing frame.
          (3) Added an on-line help facility, when users point to a menu
              item and hit button D a help message is printed on the
              terminal.
          (4) The user can now specify the OUTDISK to which the
              catalogued uv workfile goes, 0 => lets IBLED choose.
          (5) Added some checks to prevent users hitting the wrong buttons
              in some of the editing modes.
          (6) Discovered that when a user came to re-edit a file using
              an already existing catalogued file his/her previous
              editing appeared not to have been applied. Actually the
              editing info was present in the FG table but when reading
              a catalogued uv-file the FG table is not applied. So when
              finishing a session the FC table is copied to the uv
              work file before being translated to an FG table and deleted
              from the master file, so when a new session is started the FC
              table is copied back to the master file and applied before
              any data is displayed. Also updated the helpfile.
          Will move to 15JAN91 soon.

   6381.  November 11, 1990               VBPLT, VBPLT.HLP      Phil
          Converted VBPLT to work with multi-source compressed data if
          so desired. It can now apply all the calibration adverbs on
          the fly in the same manner that other routines can. One
          limitation that had to be built in is that when plotting a model
          against the data I force the user to specify a source name if
          the data is a multi-source file. Also modified the helpfile to
          relect the changes.
          Moved nowhere.

   6382.  November 13, 1990                IBLED.HLP              Phil
          Put back the wrong version of IBLED.HLP on the 11th, the
          number of adverbs in the helpfile was not the same as the
          task expected.
          Moved nowhere.

   6383.  November 13, 1990   TVFLG.FOR TVFLG.HLP DTVF.INC        Brian
          Modified TVFLG to write/read its grid file on the disk
          pointed at by IN2DISK.
          Moved to 15JAN91 this date.

   6384.  November 13, 1990                 LISTR              Bill J.
          Another LL only bug.  GAIUV1 and GAINUV subroutines get the
          indexing of the columns wrong in the solution table if there
          is one only polarisation in the database and it is 'LL'.
          Moved to 15JAN91 today.

   6385.  November 14, 1990       APGNOT:FILLM            Gareth
          Two major changes:  1. if the user is silly enough to try to
          force FILLM to append to a file which has incompatible data,
          FILLM now stops;  2. all character fields read from the data
          tape are forced to upper case.  Also fixed a pedantic complaint:
          DOCONCAT is now true only if >0.
          Moved to 15JAN91 this date.

   6386.  November 14, 1990      MAPIT.001/MAPIT.HLP         Glen
          Added set of AIPS procedures called MAPIT in the $RUNSYS area.
          HELP MAPIT explains the inputs and the procedures are run
          by typing MAPIT.  First round of procedures, extensive changes
          antisipated.
          Moved Nowhere.

   6387.  November 14, 1990      APGNOT:UVPRM/CCFND          Glen
          Two New Tasks.  UVPRM has three functions, to find a reference
          antenna, the maximum UV-spacing in the data and to find
          the UV-spacing at which the average flux of the source is
          greater than the input FLUX.      CCFND finds the last
          clean component before a negative clean component then finds
          the clean component FACTOR brighter than the negative component.
          These tasks are useful for setting self-calibration parameters.
          Moved Nowhere.

   6388. November 15, 1990      APLSUB:IMERGE                 Brian
         LISTR was not properly selecting baselines because of a bug
         in IMERGE.FOR - unique antennas were being rejected as
         duplicates. Besides being buggy, the code was quadratic
         although this wasn't necessary.
         Moved to 15JAN91 this date.

   6389. November 15, 1990      APGNOT:IMMOD                   Brian
         The conversion of degrees to radians for BPA was done in
         exactly the wrong sense.
         Moved to 15JAN91 this date.

   6390. November 15, 1990          IBLED                   Phil
         When flagging an area and hitting button B to flag another area
         a logical was not being reset so that you had to reselect the
         menu option. IBLED should also now work under SSS and XAS.
         In the helpfile changed OUTDISK -> IN2DISK to match what Brian
         did to TVFLG.
         Moved nowhere

   6391. November 15, 1990         CLBSNR                  Phil
         Finally fixed up CLBSNR to write the closure error message
         only onece each time the routine is called.
         Moved to 15JAN91 today.

   6392. November 16, 1990         CVEL                      Phil
         The AC functions were being shifted in the opposite direction
         to the XC functions, this didn't matter too much for VLBA
         stations but did for intercontinental experiments.
         Moved to 15JAN91 today.

   6393. November 19, 1990         APLNOT:FRQTAB            Brian
         Fix up FRQTAB so that it will work correctly if the IF and
         Frequency axes are in non-standard order. (Relinked FRING
         and HORUS to try to force problems if any to the fore).
         Moved nowhere.

   6394. November 19, 1990    RUNSYS:MAPIT.001             Glen
         Replaced ASCAL and GNPLT with CALIB and SNPLT.
         Moved nowhere.

   6395.  November 20, 1990    Corrections to Delay residuals   Bill C.
          There were several places where corrections were being made to
          delay residuals without a corresponding correction to the phase
          residual.  Since, in the presence of delay errors, the phase is
          defined as the phase correction at the reference frequency.
          When a delay residual is corrected the phase must also be
          corrected.  This change was made in APLNOT:SNSMO.FOR,
          APGNOT:CLSMO.FOR and APLNOT:CALREF.FOR.  The change to CALREF
          required a change to it's call sequence.  This was required
          further changes in APLNOT:CALADJ.FOR, QPGNOT:CALIB.FOR and
          QPGNOT:FRING.FOR.  Also added FQ id code to the call sequence to
          SNSMO.
          Moved to 15JAN91 this date.

   6396.  November 20, 1990         APGNOT:CLCAL.FOR          Bill C.
          Changed call sequence to SNSMO.  Also changed to allow
          OPCODE='SMOO' for multisource data.
          Moved to 15JAN91 this date.

   6397.  November 20, 1990       APLNOT:SN2CL.FOR            Bill C.
          Removed the use of the weights in the SN table in determining
          the interpolation in the SN table.  This practice could cause
          serious problems if the SN table weights (SNRs) were not in fact
          related to the data quality.  An example of this is when, in one
          scan an antenna is used as the reference antenna in fringe
          fitting and thus has a low "SNR" = min acceptable + 1.0 and in
          the next scan was not the reference antenna and has a much
          higher weight="SNR".
          Moved to 15JAN91 this date.

   6398.  November 20, 1990       APGNOT:DECOR.FOR            Bill C.
          New task to compute the decorrelation amoung a set of selected
          correlations.  The output values have a real part that is the
          ratio of the scalar amplitude average of the selected
          correlations to the vector average.  This progam is especially
          useful for looking for coherence problems in multi IF and/or
          multi channel data.  This task allows application of calibration
          and/or editing and will write a new multi source file.
          Moved to 15JAN91 this date.  Also DECOR.HLP

   6399.  November 20, 1990       APGNOT:SNCOR.FOR            Bill C.
          New task to apply corrections to SN tables.  The corrent version
          only contains the option to force the residual fringe rates to
          the average of the selected IF/polarization.  This option
          appears necessary to maintain coherence between the
          polarizations for MkIII VLBA data.
          Moved to 15JAN91 this date.

   6400.  November 20, 1990       APLPGM:DIFRL.FOR            Bill C.
          new task to divide the RR correlations by the LL correlations.
          This task is useful for looking for coherence and amplitude
          calibration  problems between RR and LL correlations. It should
          be generalized to allow referencing phases to an arbitrary
          correlation.
          Moved to 15JAN91 this date.

   6401.  November 20, 1990       QPGNOT: FRING.FOR           Bill C.
          Fixed number of words of pops adverbs to ask GTPARM for (it was
          about 30 too few).  Also fixed indexing  and numerous other
          problem that occured when averaging frequencies in the output
          of a single source compressed data file.
          Moved to 15JAN91 this date.

   6402.  November 20, 1990       APGNOT:SHOUV.FOR            Bill C.
          New task.  A clone of LISTR that does column listings of closure
          phases for selected triplets or listings with different
          IF/channels in different columns.  These displays are very
          useful for detecting and analysing problems in multi IF/channel
          data sets.  Also SHOUV.HLP.
          Moved to 15 JAN91 this date.

   6403.  November 20, 1990       APGNOT:GLENS.FOR            Glen
          Created a Gravitational LENS modeling program.  Makes models
          of a Blandford elliptical galaxy or a point mass (black hole).
          Also $HLPFIL:GLENS.HLP.
          Moved nowhere

   6404.  November 20, 1990       RUNSYS:DDTLOAD.FOR          Glen
          Made the TERSE option alittle Terser.  Does not print error
          messages separately if TERSE is true.  Unchanged if TERSE<=0.
          Moved nowhere

   6405.  November 21, 1990              TVFIDL                   Eric
          Correct to use the correct zoom factor when restarting in an
          already zoomed mode.
          Moved from Oz to TST only.

   6406.  November 21, 1990   APGNOT:FETCH FETCH.HLP    Frank Ghigo/Brian
          A bug was fixed that only allowed square images to be input.
          The number of characters allowed in a line was bumped up to
          16k to allow larger images to be Fetched.
          Moved to 15APR91 and 15JAN91 20-Nov-1990.

   6407.  November 21, 1990     APLNOT:FQFTAB          Bill C./Brian
          This returns the FQ ID/IF table of frequency offsets and
          channel increments. This is Bill's original version and hasn't
          been really tested yet.
          Moved nowhere.

   6408.  November 21, 1990          FLAGGING LL DATA        Phil
          Found and fixed a bug that caused FG tables attached to LL
          only data not to be applied. In DATFLG the loop that
          applied the flag ran from 1 -> NCOR, where NCOR is 1, but
          the logical array inside the loop was set up as 0,1,1,1
          i.e. to flag all L correlations, so it only read the 0
          and jumped out of the loop. Changed UVGET to record the
          ICOR0 of the input data and added a pointer inside the
          DATFLG loop which depends on ABS(KCOR0) - 1. This
          meant a change in DSEL.INC with the agony that accompanies
          that. Also found that BPASS and SDTUV used a variable called
          KCOR0, changed its name.
          Moved nowhere.

   6409.  November 26, 1990        APGNOT:DECOR            Bill J.
          The count of NPARMS was low by 1 so OUTDISK never functioned.
          Also fixed a couple of typos in the HELP file.
          Moved to 15JAN91 today.

   6410.  November 27, 1990    Gripe verb and file                  Bill C
          The gripe verb now asks for an e-mail address and a one line
          summary of the gripe.  These are the 8th and 9th entries in the
          GR file.  Changed AUC.FOR and CHGRIP.FOR in AIPSUB.
          Moved nowhere.

   6411.  November 27, 1990        UVDIF.FOR              Bill C.
          The data being printed was read from the wrong buffer for
          compressed data causing very erratic results.  Added a second
          decompression buffer and now data to be printed are always
          copied to and used from the decompression buffers.
          Moved to 15JAN91 this date.

   6412.  November 27, 1990      APLUNIX:ZBYTF2            Brian
          ZBYTF2 was determining if the input and output arrays were
          the same incorrectly. Also, the case of no byteflip was
          not being handled properly (but ZBYTFL short-circuits this
          anyway).

   6413.  November 27, 1990      RUNSYS:MAPIT.001          Glen
          Added a few more adverb initializations and comments.
          Moved nowhere.

   6414.  November 27, 1990      APLSUB:FNDXY.FOR          Glen
          Removed a subroutine from UVPRM.FOR (identical to one
          in UVPLT.FOR). Modernized and commented.
          Moved nowhere.

   6415.  November 27, 1990      APGNOT:UVPRM.FOR          Glen
          Changed binning of UV-data for calculating source flux
          and added more comments.  Removed subroutine FNDXY.FOR
          Moved nowhere.

   6416.  November 27, 1990       APLGEN:ZR32RL             Brian
          ZR32RL was doing byteflips but not word flips which caused
          the Decstation to turn perfectly good IEEE numbers into garbage.
          The other 32 and 64 bit real conversion routines will need to
          be similarly changed (32 bit ints are wordflipped!).
          Moved to 15JAN91 this date.

   6417.  November 28, 1990        FRING                      Bill C.
          Removed unused adverb GAINERR.  Also FRING.HLP
          Moved nowhere.

   6418.  November 28, 1990        MX.HLP                     Bill C.
          Improved documentation about sort order.
          Moved nowhere.

   6419.  November 28, 1990        SPLIT.HLP                    Bill C.
          Improved documentation of APARM(2) (the input data averaging time).
          Moved nowhere.

   6420.  November 28, 1990       HORUS                Robert Braun/Bill C.
          HOURS was only applying uniform weighting corrections to the
          first of each group of images.
          Move to 15JAN91 this date.

   6421.  November 19, 1990  ZR32RL ZRLR32 ZR64RL ZRLR64      Brian
          None of these worked for the decstation because although the bytes
          were properly flipped, the words weren't. Moreover the blank and
          zero checks were wrong as well.
          Moved to 15JAN91 this date.

   6422.  November 30, 1990       FILLM.FOR, FILLM.HLP    Gareth
          1. Fixed bug (denkfehler) introduced when the multi-colored VLA
          spectral line options were added.  Two VLA IF spectra from
          different polarizations (e.g. A & D) were put into the same AIPS
          IF even if the frequencies were different.  They are now
          correctly separated into different multi-source files.
          2. Allow a timerange as short as 10 seconds for debugging
          purposes.
          3. Added code to deal with VLA holography measurements.
          Moved to 15APR91 and 15JAN91 this date.

   6423.  December 1, 1990        QPSAP:QMULCL.FOR           Glen
          Ed Fomalont found that under rare conditions one of several
          fields being mapped with MX would have NO residuals loaded into
          the AP.  When this happened, QMULCL, would not correctly locate
          the max for the next clean cycle.  Added logic for fields with
          NO map pixels in AP.  Would not effect the convex which use
          a different QMULCL.
          Will move to 15JAN91 at the end of the week.

   6424.  December 1, 1990        QIBM,QSUN:QCLNSU.FOR       Glen
          First Sun specific Q routine, which does minor cycle beam
          subtraction.  Should be 20% faster than PSAP routine for SUN's
          and the IBM's which are strangely slow at real to integer
          conversions.  For large DDT test, MX is in QCLNSU 30% of time.
          Moved nowhere.

   6425.  December 3, 1990        APLGEN:ZRHPRL.FOR          Athol
          Small error in the conversion of HP reals (a part in
          10**6 or less). The mantissa is a 2's complement signed
          integer and should be decremented by 1 if the sign bit
          is set.
          Moved nowhere.

   6426.  December 3, 1990        QPSAP:QMULCL.FOR           Glen
          Error in location of first maximum in minor cycle loop.
          Moved nowhere.

   6427.  December 3, 1990        RUNSYS:DDTLOAD.001         Glen
          Yet another adjustment in TERSE so that some results are
          always printed.
          Moved to 15JAN91 this date.

   6428.  December 3, 1990        ANCAL                          Bill C.
          Implemented the advertised capability to give baseline dependent
          calibration factors by writing a BL table if "BASELINE" cards
          are present in the calibration file.  This implementation allows
          only one set of baseline factors per uv data file.  Also
          improved the documentation in ANCAL.HLP.  Added adverb BLVER to
          specify the output BL table.
             Fix an indexing error for LCP only data when POLNO=2 in the
          input file.
          Moved nowhere.

   6429.  December 3, 1990      AU7 (RENAME)                    Bill C.
          In it's check for duplicate file names RENAME was including
          type; thus it was possible to have an MA and a UV file with the
          same name, class, sequence and disk number.  This causes problem
          for a number of verbs and tasks (e.g. IMHEAD) which no longer
          have INTYPE as an adverb and always pick the one it finds first
          in the catalog.
          Moved nowhere.

   6430.  December 4, 1990     GETJY                           Bill C.
          Added adverbs SOUCODE to allow specifying a source "cal code"
          and SNVER to specify a particular SN table.  Did some general
          cleanup of the code.
          Moved nowhere.

   6431.  December 4, 1990      ZABOR2.C                       Brian
          I changed every ZABOR2.C, i.e. in APLUNIX, APLBERK, APLBELL,
          APLSUN, APLCRI, APLIBM. Instead of handing the signal handler
          a function we have been typically giving it an uninitialized
          external function pointer which through a quirk of the linker
          has normally been resolved correctly - everywhere but on the
          IBM and Decstation. I am checking everything into TST and the
          IBM version only into New.
          Moved nowhere (mostly).

   6432.  December 4, 1990          BLCAL                      Bill C.
          Added a trap in BLCDIV to barf and die if multiple sources are
          selected and/or a flux density to be used is missing.
          Moved nowhere.

   6433.  December 4, 1990         APLSUB:LPOPEN               Brian
          A harmless looking unneeded common caused the Decstation to
          be unhappy so I removed it.
          Moved Nowhere

   6434.  December4, 1990    APLDEC INCDEC QDEC SYSDEC        Brian
          The routines to make the Decstation work under AIPS. QDEC
          is currently empty, i.e. pure QPSAP.
          APLDEC: (Notable: byte problem in ZXASX2, Dec doesn't use
          the unix convention for recordlength in ZTPOPD.FOR)
             ZABOR2.C  ZCREA2.C  ZDCHIC.C  ZTPWAD.FOR  ZXASX2.C
             ZABORS.C  ZDCHI2.FOR  ZTPOPD.FOR  ZTTOPN.FOR
          INCDEC: (1MW=4MB PSAP)
             DAPC.INC
          SYSDEC: (The usual)
             AIPXAS  CCOPTS.SH  INCS.SH  QMSLAND.HDR  ZLPCL2.QMS
             ASSNLOCAL.CSH  CDVER.CSH  LDOPTS.SH  QMSPORT.HDR
             ASSNLOCAL.SH  FCOPTS.SH  LIBR.DAT  ZLPCL2
          Moved to 15APR91 and 15JAN91 this date.

   6435.  December 5, 1990        VBPLT                   Bill C.
          Improved default values for TIMERANG and UVRANGE which weren't
          very good.  Also removed the correction in component positions
          since this correction is already done by the CLEANing tasks.
          Moved nowhere

   6436.  December 5, 1990        FNDPOL                  Bill C.
          Improved documentation and added a test to see if the data is a
          single source file and if so it assumes that polarization
          calibration has already been done.  This should suppress many of
          the bad warning messages.
          Moved nowhere

  6437.   December 5, 1990          CGASET                 Bill C.
          Now sets LCALTM to the curent time if only doing BL calibration;
          this avoids many unnecessary calls to CGASET.  Also fixed logic
          for calling BLSET.  These bugs were causing time variable BL
          calibration to fail.
          Moved nowhere.

   6438.  December 5, 1990          BLSET                  Bill C.
          Now resets IBLP1 if not applying BL cal.  This aviods many
          unnecessary calls to BLSET.
          Moved nowhere.

   6439.  December 5, 1990           BLCAL                 Bill C.
          BLCAL could write many blanked solutions if using an averging
          time less that the whole data set.  These blanked solutions
          corresponded to times when there was no data.  Now, if a gap is
          found no invalid solutions are written for it.
          Moved nowhere

   6440.  December 5, 1990         LISTR                       Bill C.
          In 'LIST' mode LISTR now assumes that data with no AN table
          comes from the VLA and has antenna numbers up to 28.  Also
          forced new pages between amplitude and phase GAIN listings
          (DPARM(1)=5) and between sets of baselines in 'LIST' mode.
          Changed the default averaging time for MATX listings of single
          source files to be 10 min. rather that the whole data set.  Also
          change the description in LISTR.HLP
          Moved nowhere.

   6441.  December 5, 1990        PRTTP                       Bill C.
 Fixed heuristic test for VLA Modcomp archive tapes to account to
         translations of old format tapes; format revision numbers
         between 3 and 50 are now accepted.  Also fixed extension file
         routine to know about 'A3DTABLE' and '3DTABLE' types.
         Moved nowhere.

  6442.  December 6, 1990        CLCAL,SN2CL             Bill C.
         Added option INTERPOL='SELF' for "self" calibration.  In this
         mode there is no smoothing of the SN table and only solutions
         from the same source is used to calibrate CL table entries.  If
         the two SN table entries surrounding each CL table entry are
         both from the same source then the closest one is used.  This is
         implemented in APLNOT:SN2CL.FOR.  Also changed CLCAL.HLP.
         Moved nowhere.

  6443.  December 7, 1990    APLNOT:GCALC1.FOR          Bill C.
         A typo in the phase
         only solution portion caused the soluton to become unstable and
         sometimes give bad solutions.  It's pretty amazing that it ever
         worked at all.  This was the L1 solution routine for CALIB.
         Moved to 15JAN91 this date.

  6444.  December 7, 1990      QPGNOT:CALIB.FOR              Bill C.
         In it's computation of the mean gain modulus for the gain
         stabilization CALIB was only checking that the weight of a
         solution was positive.  Routine CLSNOU was changing the weights
         of flagged reference antenna data to positive values so the
         blanking value was added to the sum.  This caused a very large
         mean gain modulus and thus very small amplitudes of data
         corrected using this mean gain modulus.  Also added messages
         about which solution type.
         Moved to 15JAN91 this date.

  6445.  December 7, 1990      DOC:VMSNOTES.90D             Bill C.
         Added information about TVFLM and IMFLM problems and the need to
         use SETPAR to set the character size for TK devices.
         Moved nowhere.

  6446.  December 7, 1990       AN, SU tables            Phil
         There was a problem which had bitten some users caused by
         the introduction of FQ identifiers. It was possible for users
         to a) determine fluxes of sources for one freqid, write them
         in the SU table and apply them to data with another freqid,
         without being aware of it; b) determine antenna polarziation
         characteristics with PCAL for one freqid and, again, apply
         them to data with another freqid.
         The solution to this problem was to add another keyword to
         the SU and AN tables. When FREQID dependent values are
         changed in these tables a FREQID keyword is written with
         the value of the FQID for which the values were changed.
         When applying these values to data this keyword is checked
         against the FREQID of the data itself and will not allow
         the user to apply the values if they are not the same keyword.
         If the values have not been changed the FREQID keyword in the
         tables will have the value -1.
         This change neccesitated the following changes:
         (1) Includes DANT.INC, DSOU.INC, DANS.INC had a new variable
             added to define the FQID in the SU and AN tables.
         (2) SOUINI and ANTINI were changed to read/write the new
             keywords and to ensure that old data with no keyword
             in the tables could still be read with no problem.
         (3) POLSET was changed so that it would check the compatibility
             of the table FREQID's with the data before applying the
             antenna polzn corrections.
         (4) DGHEAD, FNDSOU, GETSOU, SOUFIL, SOUFND, SOURNU, SUSEL,
             GETANT, GETNAN, ANTDAT, DATPOL were all subroutines
             which called either ANTINI or SOUINI and were changed
             to deal with the new call sequences.
         (5) SETJY was modified to write a keyword value in the SU
             tables if necessary.
         (6) PCAL was modified to write keyword values in both the
             SU and AN tables if necessary and also to check the
             compatibility of application of any previous corrections.
         (7) CLCOR, DBCON and GETJY were modified to check the
             compatibility of FREQID keywords for their applications.
         (8) The following tasks called SOUINI or ANTINI and had to
             have their call sequences changed: AVER, AVSPC, BLCAL,
             BLFIT, BPASS, CALIB, CVEL, FILLM, FILLR, FITTP, FRING,
             GAPLT, HORUS, IBLED, IM2UV, LISTR, MK3IN, MULTI, POSSM,
             PRTAN, PRTGA, PRTUV, SDTUV, SETAN, SPLIT, TVFLG, UVAVG,
             UVCOP, UVFIL, UVFIX, UVLOD, UVSIM, VBMRG, VBPLT, VLBIN,
             WSLOD.
         (9) All tasks that load data from an external format were
             changed to write the default value of the keyword in
             the SU and/or AN tables.
         Moved nowhere, Eric to change TVFLG.

  6447.  December 7, 1990       APGNOT:MK3IN.FOR            Athol
         MK3IN now deals with the case where the correlation
         functions are determined over a lag range that is not
         symmetric about zero lag. The maximum symmetric lag
         range is extracted in this case.  Also updated for
         new keyword FREQID in AN and SU tables.

  6448.  December 7, 1990       IPC Routines               Chris
         The following routines form the minimal set of interprocess
         communications routines for AIPS.  The current routines only
         support TCP stream sockets under BSD Unix.
         In APLGEN:
         - ZROPEN --- open a connection to a server
         - ZRCLOS --- close a connection
         - ZRREAD --- read a message
         - ZRWRIT --- write a message
         - ZROPN2 --- low level open (stubbed)
         - ZRCLS2 --- low level close (stubbed)
         - ZRRD2  --- low level read (stubbed)
         - ZRWR2  --- low level write (stubbed)
         In APLBERK:
         - ZROPN2 --- open a TCP socket
         - ZRCLS2 --- close a socket
         - ZRRD2 --- read a message from a socket
         - ZRWR2 --- write a message to a socket
         In APLCVEX:
         - ZROPN2 --- open a TCP socket (requires special version)
         Moved nowhere.

 6449.  December 7, 1990         DBCON               Athol
        There existed a problem with VLBI data that the AN
        tables in the two files may be inconsistent, other checks
        (listed below) were also implemented.
        1) The AN tables are merged if they have compatible AN table
           headers and the data are to be written as one subarray.
           The antennas are not renumbered although a warning will
           be given if their numbering is incompatible. Antennas
           which appear in both tables are checked for consistency.
           Entries with coordinates equal to DBLANK or with a
           station vector of < 2m length are assumed to be null.
           These changes are contained in a new subroutine DBANT
           (some AN table code was moved from HISANT to DBANT).
           If the AN tables are not compatible then the AN tables
           are dealt with as before. The algorithm for separate
           subarrays should be unchanged.
        2) In compiling the source number translation table I
           also included a check on the consistency of the
           coordinates of sources found in both input tables.
           A warning is printed if they disagree but no other
           action is taken.
        3) For data containing multiple FQ ID's we need to
           check that the FQ tables were in agreement. I added
           a subroutine DBIF to give a warning if any
           existing input FQ tables disagree (does not deal with
           CH tables).
        There is one difference between this version and the existing
        DBCON. At present DBCON will force the AN header ref date to
        agree with the catalog ref date, irrespective of the subarray
        parameter epoch. This version writes the input AN header that
        is closest to the cat ref date.
        Moved nowhere.

 6450.  December 7, 1990         UVAVG                    Athol
        Updated accumulation buffer indexing to handle files
        containing both XC and AC data.
        Data for different FQ ID's are now accumulated separately.
        This is useful when averaging AC function over long
        periods in a data file with FQ switching. This will
        work with TB or BT sorted data as before. The limitations
        on averaging are:
        TB data:
          NANT * (NANT+1) * NFQID * (NIF * NCHAN * NSTOKES * 3) / 2
            <~ 10**5.
        BT data:
          NFQID * (NIF * NCHAN * NSTOKES * 3) / 2 <~ 10**5
        Moved nowhere.

 6451.  December 8, 1990               IBLED                Phil
        IBLED, like other tasks, was not correctly dealing with LL
        only data when reading the FC table. It now does. ALso
        when a user asked for all data to one antenna to be flagged
        that information was written correctly into the FC/FG table
        but internally the program was unaware of it and so it
        appeared as if the editing had not been done when a subsequent
        baseline was displayed.
        Moved to 15JAN91 along with the whole TST version.

 6452.  December 10, 1990           DBCON                   Phil
        The previous changes to DBCON (entry 6449) were a little too
        severe in that warning messages were printed out if there was
        the slightest discrepency in source or antenna positions
        between the files. The first user to try this had antenna
        positions differing by a few mm and was confused as to the
        messages. Changed it so that the warnings are only printed
        if source positions differ by > 10mas, or antenna positions
        differ by > 1cm. Also changed the MXANT parameter from 27
        to 45 to fix another minor bug.
        Moved nowhere.

 6453.  December 10, 1990        AIPSPUBL:COOKZ.TEX        Brian
        Describe the IBM RS/6000 (Lemur) that now sits in CV.

 6454.  December 10, 1990        HELPFIL:ISCOMP.HLP        Bill J.
        List of tasks that can handle  compressed (= packed) data.
        In response to Gripe 4492 and local whinges.
        Moved nowhere.

 6455.  December 10, 1990        HLPFIL:UVAVG.HLP           Bill J.
        Help file was rather uncertain whether 'TB' and 'BT' data
        could be handled.  In response to Gripe 4531.
        Moved 15JAN91 today.

 6456.  December 10, 1990    Expedited data             Chris
        Added new routines to handle expedited data (also known as
        out of band data.
        In APLGEN:
           ZRXDWR.FOR -- write expedited data
           ZRXDW2.FOR -- low-level write (stubbed)
        In APLBERK:
           ZRXDW2.C -- low-level write (socket)
        Moved nowhere.

 6457.  December 10, 1990       ZLOCK in APLBERK            Chris
        Removed debugging statements.
        Moved to 15JAN91 this date.

 6458.  December 11, 1990       COOK11, COOK6 -.TEXs         Bill J.
        Added information on existence and use of IBLED.  Removed
        references to CALIB for global fringe-fitting and inserted
        FRING instead.
        Moved nowhere.

 6459.  December 11, 1990       $YPGNOT/RMCUB.FOR + HLP      Bill J.
        Added Greg Taylor's Faraday rotation curve fitting and
        plotting program to the system.
        Moved nowhere.

 6460.  December 12, 1990       $APGNOT/DBCON.FOR            Athol
        Small change to ensure that AN tables with incompatible
        FREQID's are not merged.
        Moved nowhere.

 6461.  December 12, 1990      CALIB                         Bill J.
        Add solution summary to HI file.  In answer to Gripe 4573.
        Moved nowhere.

 6462.  December 12, 1990     UV2TB                          Bill C.
        New task.  Converts autocorrelation spectra to a table of type
        AS (Autocorrelation Spectra).  Full calibration system included.
        This allows POPS procedures to read and write autocorrelation
        spectra.
        Moved nowhere.

 6463.  December 14, 1990       COOK4.TEX                    Bill J.
        Added 'P' and 'X' band calibration information.
        Moved nowhere.

 6464.  December 14, 1990               FILLM           Gareth
        1. Changed the method of determining whether antennas are
        present or not.  The previous method was not valid for copies of
        old (pre-1988) tapes.
        2. Two fixes to correct bugs in FQ table handling.  One was a
        "mad bomber" - four arrays whose dimensions were too small.  The
        second was the use of control information from VLA IFs A and B
        for IFs C and D.  This had been necessary in the past.  Since C
        and D are now, in general, independent of A and B, this
        assumption is not longer valid.  It was causing incorrect
        frequencies, bandwidths, channel separations, etc. for
        experiments where independent tuning is used.
        3. The velocity and reference frequency are now written into the
        SU table for channel 0 as well as the line data.
        4. Changed FLMBC, which determines the VLA band code, to use the
        most up-to-date frequency limits.  Other code to determine the
        band code has been replaced by a call to this subroutine.
        5. Fix to ignore shadowing for raster scan (holography) data.
        6. Problems with the VLA multiple-IF spectral line modes.  The
        previous fix (November 30, 1990) went too far - now corrected.
        Fixes made in 15JAN91 and 15APR91 yesterday

 6465.  December 14, 1990            ANTINI, DANT.INC              Phil
        Under certain subtle conditions an exisiting AN table could
        be opened for WRITE and all the header keywords could be
        zeroed. This would happen when the ANFQID on entry was set to
        zero, normally an illegal value for it but one I didn't trap.
        It now checks for this. Also changed the declerations of various
        arrays to use the MAXANC parameter in PUVD.INC, changed DANT.INC
        in same way.
        Moved nowhere.

 6466.  December 14, 1990          APLNOT:SOUINI.FOR, INC:PUVD.INC  Bill J.
        Some arrays in SOUINI.FOR were explicitly dimensioned as 19 rather
        than MAXSUC.  MAXSUC in PUVD.INC had been changed to 21 in the
        course of Phil's table revisions.  This led to failures on spectra
        --- AOC Sparcstation 1 only.  Changed SOUINI to use PUVD.INC
        and changed MAXSUC in PUVD.INC from 21 to 19.
        Revised in TST only since AIPS on most other systems seems to work
        and quarterly update takes place next week.
        Moved nowhere.

 6467.  December 17, 1990          INC:PUVD.INC                 Bill C.
        Changed MAXCHA  (number of channels) to 2050.
        Moved to 15JAN91.

 6468.  December 17, 1990                CVEL                      Phil
        Mark Claussen discovered that CVEL did not work for data whose
        velocity type was heliocentric. That is not strictly true, the
        first data point was fine, after which the logical specifying
        if the data were heliocentric was reset to .false.. Fixed this.
        Moved to 15JAN91 today.

 ***********************************************************************

        Changes while 15APR91  was TST:

 ***********************************************************************
 ***********************************************************************

 6469.  January 13, 1991              APLNOT:DATGET.FOR           Brian
        A "double equivalence" of the form EQIVALENCE(RECORD,RECI,RECI)
        caused the 3090 compiler to go into an infinite loop.
        Moved to 15APR91 this date.

 6470.  January 14, 1991           FITTP                        Brian
        The IBM 3090 complained about having -2**31 in Data statements.
        Changed to an assignment statement of the form:
        MAGIC4 = -2147483647 - 1.
        Moved to 15APR91 this date.

 6471.  January 14, 1991     AIPSUB:CHGRIP.FOR            Bill C.
        Modified to blank fill the output buffer after writing.  This
        keeps from writing junk in the last record of the file that was
        confusing the gripes processing software.
        Moved from 15JUL91 this date.

 6472.  January 14, 1990     APGNOT:ANCAL.FOR            Bill C.
        Fixed logic error which caused LCP corrections for dual
        polarization data to be applied to the RCP portion of the CL
        table.
        Moved from 15JUL91 this date.

 6473.  January 14, 1991        TABINI                  Gareth
        The volume ID was not updated on write.  This led to a fatal
        error when appending to a table on a disk whose number was
        different from the one on which it was created.  This was only a
        problem when a disk was writable from two (or more) CPUs and had
        different volume IDs on the two (or more) systems.
        Moved to 15APR91 and 15JUL91 this date

 6474.  January 14, 1991        FILLM                   Gareth
        The decoding of the antenna status information was incorrect.
        The "reference antenna" status for raster scans (holography) was
        also incorrect.  Both fixed.
        Moved to 15APR91 and 15JUL91 this date

 6475.  January 14, 1991        PRTTP                   Gareth
        Changes to the printing procedure for VLA archive tapes to
        handle pre-1988 data correctly.  The "time at end of
        integration" is now used for all tapes instead of "time of
        geometry calculation," since the latter was does not exist on
        the old tapes.
        Moved to 15APR91 and 15JUL91 this date

 6476.  January 14, 1991        UVSEN                   Gareth
        The first call to OUTPRT had too many arguments.
        Moved to 15APR91 and 15JUL91 this date

 6477.  January 14, 1991        USERNO.LIS              Gareth
        The latest list of AIPS users.
        Moved to 15APR91 and 15JUL91 this date

 6478.  January 17, 1991        TVFLM, IMFLM            Gareth
        TVFLM and IMFLM are causing sufficient problems with their
        non-standard nature that I have removed them from YPGNOT and
        their corresponding HLP files from HLPFIL.  I have put them
        into the contributed code area.
        Moved to 15APR91 and 15JUL91 this date

 6479.  January 17, 1991        RMCUB                   Gareth
        RMCUB has been removed from the system entirely because it
        contains proprietary code.

 6480.  January 17, 1991       SYSAIPS:AREAS.DAT        Brian
        YXAS should be under YDEV so that the search scripts find it
        in the right place. Also removed an error in the contrib area
        for Gareth. Manually moved YXAS to the right place in the RCS
        directory, NRAO1 and lemur by hand. Other sites that use the
        midnight job should follow suit.
        Moved from 15JUL91 this date.

 6481.  January 22, 1991       APGNOT:SETJY             Bill J.
        Formatting error bollixed output to terminal of calculated
        fluxes of primary calibrators.
        Moved from 15JUL91 today.

 6482.  January 23, 1991       QPGNOT/FRING             Bill J.
        Inappropriate call arguments for subroutine DNRM2 caused
        FRING to bomb when PRTLEV=2 was selected.
        Moved from 15JUL91 today.

 6483.  January 24, 1991      CVEL                      Phil
        Minor modification to deal with MkIII VLBI data. The
        reference and remote station are defined in the opposite
        sense to MkII data.
        Moved nowhere.

 6484.  January 25, 1991    SYSUNIX:AREAS.*SH               Brian
        AREAS.DAT had changed, but not the corresponding *SH files.
        Moved from 15JUL91 this date.

 6485.  January 28, 1991       FITLD                        Phil
        If the user asked for more files to be loaded than actually
        existed the task did not recognize the end of tape and died
        deleting the last file written. Fixed.
        Moved from 15JUL91 today.

 6486.  January 28, 1991          ANTINI                    Phil
        It appears that AIPS antenna tables thought they were ANNENNA
        tables, and have done so for a long time. Fixed spelling.
        Moved from 15JUL91 today.

 6496.  January 28, 1991     SYSIBM:AIPS,aips,AIPXAS        Brian
        Changed AIPS script to not source AIPXAS when the user has
        asked for a remote TV. Also modified AIPXAS to start up XAS
	as a grandchild to see if this will fix up the strange AIPS
        hanging until the TV is killed problem.
        SYSDEC:AIPS was modified similarly.
        Moved from 15JUL91 this date.

 6488. January 28, 1991          TVFLG                    Phil
       The new call sequence for ANTINI had not yet propoagted to
       TVFLG.
       Moved from 15JUL91 this date.

 6489. January 30, 1991		FITTP.FOR FITTP.HLP      Brian
       Changed FITTP to default to IEEE format, since for most
       machines that will be the fastest format, and also with
       scaled integers you can have problems if wildly wrong data
       is also in the dataset. Also changed the documentation.
       Moved from 15JUL91.

 6490. January 30, 1991		SYSSUN/LIBR.DAT		 Pat
       Changed $YSSS to $YSS; this was screwing up the Sun
       Installation and causing lots of confusion.
       Moved to 15APR91 only.

 6491.  February 4, 1991           FUDGE                    Eric
        Added an example to the DIDDLE subroutine and a comment about
        it in the help file.  Users need the guidance of code that
        at least copies VIS(*) to RESULT(*).  The also makes FUDGE do
        something which can be tested via UVDIF.
        Moved from Oz to 15JUL91 and 15APR91.

 6492.  February 4, 1991         QHEADER                    Eric
        Changed KWIKHD to compute correctly offset coordinates to
        pixel 1 for UV data.  It was displaying the reference value
        and claiming pixel 1 before.
        Moved from Oz to 15JUL91 and 15APR91.

 6493.  February 4, 1991            MATHS                      Eric
        For some bizarre and undocumented reason this task went to a
        lot of trouble to (incorrectly) restrict itself to one output
        plane.  When fed a cube it died because of treating BLC and TRC
        as arrays of size 2.  Fixed it to handle cubes correctly.
        Moved from Oz to 15JUL91 and 15APR91.

 6494.  February 4, 1991            UVLOD, R3DTAB               Eric
        Changed all buffer sizes, doubling them.  Also changed the
        pointer array in UVFDAT.  It was dimensioned 512 and was
        supposed to hold pointers to all polarizations, IFs, channels,
        etc.; of course, it failed miserably.
        Also changed a data array in R3DTAB from 512 to very big.  It
        was supposed to hold the largest table row in FITS form prior
        to conversion.  The output array was big, not the input!
        Moved from Oz to 15JUL91 and 15APR91.

 6495.  February 4, 1991       POSSM                   Eric
        Corrected a bunch of stuff in the Fortran and help files:
        (1) Cleaned up the handling of logical input parms and their
            descriptions in the help file.
        (2) Changed fixed-scaling to allow self-scaling on one of the
            parameters.
        (3) Corrected the frequency dependent phase shift for SHIFT.
            Whoever coded this mess does not understand how the
            coordinates work.  Instead of
            1 + CATR(KRCIC+JLOCF) * (IC-1 + BCHAN - CATR(KRCRP+JLOCF))
                   / CATD(KDCRV+JLOCF)
            this person coded
            1 + CATR(KRCIC+JLOCF) * (CATR(KRCRP+JLOCF)*IC - 1)
                   / CATD(KDCRV+JLOCF)
            which has no relationship to reality.
        (4) Corrected a parameter which was set only in an uncommon
            IF clause, but then always used to zero a summing array.
        (5) Changed it to plot multiple IFs from its basic buffers
            rather than requiring multiple buffers of length
            MAXCHA * MAXIF.
        (6) Changed it to plot vertical lines between IFs in the
            multi-IF mode.
        (7) Corrected bug which caused plots of the BP table to stop at the
        first blanked channel.
        (8) Changed to omit spectra from the plot if the channel 0 value
        is less than BPARM(4) when dividing by channel 0.  Cleaned up
        the messages some.
        (9) Added option to control the plot type - amp and phase, real
        and imag, or any one of the above.  Changed help and AU8A
        accordingly.
        Moved from Oz to 15JUL91 and 15APR91.

 6496.  February 4, 1991            EXTLIST                  Eric
        Brought the EXTLIST code (in AU8A) up to date for POSSM and
        added some displays of SHIFT, CODETYPE (new), and the divide
        by zero option.
        Moved from Oz to 15JUL91 and 15APR91.

 6497.  February 4, 1991               AVER         Eric
        Raised the buffer sizes to handle multi-channel data.
        Moved from Oz to 15JUL91 and 15APR91.

 6498.  12 December, 1990    TVFLG, SPFLG       Eric
        (1) Corrected one misleading format in SPFLG and one bad format in
            both SPFLG and TVFLG in the flag by form area.
        (2) Added IN2DISK to SPFLG, changing DSPF.INC, SPFLG.HLP, SPFLG.
            Picked up that addition from CV to DTVF.INC and TVFLG, and
            put a correct explanation of its effect in TVFLG's help file.
        (3) Changed display of status lines at the bottom of the menu to
            write all possible characters in each line.  Otherwise,
            non-blank characters changed to blank did not get erased.
        (4) Doubled buffer sizes in TVFLG, SPFLG, GRIDTC, GRIDTB, TVFOAD,
            SPFOAD,a nd GTBWRT.  Added a test to make sure that the
            gridding buffers are big enough in GRIDTB.  They could handle
            only 4 subarrays before.
        (5) Also added remarks to TVFLG help file recommending using one
            subarray at a time and corrected the SPFLG help file to
            document its limitation to one subarray at a time.
        (6) Also increased number of baselines from 2000 to 5000
            in TVFLG and DTVF.INC.
        (7) Changed SPFLG to correct interactive windows to all channels
            only when the set window is very close to the edge.  Changed
            TVFLG similarly.
        (8) Corrected y position of CURVALU-like display in some modes
            in both tasks.
        (9) Corrected both tasks to flag all channels/baselines in TIME
            and TIMERANG modes even if only a subimage is currently
        (8) Corrected y position of CURVALU-like display in some modes
            in both tasks.
        (9) Corrected both tasks to flag all channels/baselines in TIME
            and TIMERANG modes even if only a subimage is currently
            loaded.  Previously, it flagged only within the subimage in
            the work file but flagged the full range in the UV data set.
        (10) Corrected both tasks to handle compressed data in
            single-source UV data files.  Before they would simply have
            messed them up.
        (11) Corrected GTBWRT, TVFLG, SPFLG, SPFOAD, TVFOAD to set the
             source number of empty rows to -1, rather than zero.  This
             allowed a correction to the averaging for TV display so
             that averages only go over one source and the requested
             time interval.  Single source files would average n
             times without regard for how much time passed between them.
        Moved from Oz to 15JUL91 and 15APR91.

 6500.  February 5, 1991           VLBIN                  Phil
        Modified to add data selection parameters based on bandwidth
        and observing frequency. Also changed VLBIN.HLP.
        Moved from 15JUL91 today.

 6501.  February 5, 1991           BPASS                  Phil
        Neil found a bug I had introduced in the recent overhaul of
        BPASS. A GO TO had been commented out. While checked out
        I added a mode to force the normalization of a bandpass
        function when requested, this is very useful for VLBI data
        where normalization by channel 0 is often not possible.
        Also updated BPASS.HLP.
        Moved from 15JUL91 today.

 6502.  February 7, 1991       AIPPGM:AIPMAN.FOR,AIPLAS.FOR Glen
        Removing AIPMAN.FOR and AIPLAS.FOR from $AIPPGM.  These
        programs no longer work, but are placed in $AIPSCONTR
        Already done in 15JUL91.

 6503.  February 7, 1991      AIPPGM to AIPNOT              Glen
        Moving all programs which do NOT use the TV in AIPPGM to
        AIPNOT.  Currently these programs are linked several times
        and placed in the $LOAD/ALT* directories.  Programs are
        AIPSC, AJAX, BATER1, DELSG, FIXCAT, FIXUSR, GR2TEX, GRIPR,
        GRITP, POPSGN, GMNGR, RDFITS, RECAT, SETPAR, SHOPA, SHOPB,
        and UPDAT.
        Already done in 15JUL91.

 6504.  February 7, 1991       $RUNSYS/MAPIT.001               Glen
        Added numerous comments and error checks.
        Moved from 15JUL91 this date.

 6505.  February 8, 1991        TVFLG        Eric
        Corrected TVFOAD.  In fixing the handling of sources and
        averaging, I left out an initialization statement, causing a
        loss of the correct source name in the TV displays.
        Only the first source name was displayed.
        Moved from Oz to 15APR91 and 15JUL91.

 6506.  February 8, 1991         AVSPC                            Phil
        The Australians needed an option in which AVSPC could apply an
        FG table while averaging. It now does this, the aim being that
        bad spectral channels can be flagged before a new channel 0
        is created. Also updated the .HLP file.
        Added Neil's recent minor changes.
        Moved from 15JUL91 today.

 6507.  February 10, 1991                CVEL                Phil
        Found and fixed the indexing error that was the cause of a long-
        standing bug: CVEL never worked properly for dual polzn data.
        That didn't really matter because none had ever been thrown at
        it in earnest until now. Added the change made recently in TST
        to correct MkIII data with the correct reference station. Also
        updated CVEL.HLP
        Moved from 15JUL91 TODAY.

 6508.  February 10, 1991             FRING                  Phil
        In the delay-rate determination subroutine if data containing
        only one baseline was passed and its SNR was below the threshold
        the matrix order for the LSQ routines was set to 0, this caused
        a divide by 0. Set a trap to catch this condition and just flag
        the entry in the SN table.
        Moved from 15JUL91 today.

 6509.  February 13, 1991              IBLED               Phil
        LL only reared its ugly head again. When flagging single-source
        LL only data IBLED merrily passed all data through without
        flagging it because of the Stokes indexing error we fixed for
        most other tasks.
        Moved from 15JUL91 today.

 6510.  February 14, 1991             $INCIBM/DAPC.INC     Glen
        Made the IBM version of the Pseudo array processor code consistent
        with the QPSAP version, except that the array size is 1.25 Mega-
        words=5 Mega bytes.
        Moved from 15JUL91 today.

 6511.  February 15, 1991 SYSAIPS:AREAS.DAT SYSUNIX:AREAS.CSH,SH    Brian
        Updated these to have the IBM 3090 areas, APL3090, INC3090,
        Q3090, SYS3090.
        Moved from 15JUL91 this date.

 6512.  February 15, 1991 APL3090 INC3090 Q3090 SYS3090             Brian
        These areas were populated with the 3090 port done in Kingston and
        at Cornell. APL3090 doesn't yet contain the Double to IEEE and back
        conversion routines since IBM hasn't given them to us (an oversight
        probably). The INC3090 area just contains a 1MW DAPC.INC. The Q3090
        routines are essentially the PSAP routines with vectorization
        directives as well as a library FFT. The SYS3090 area holds the
        appropriate LIBR.DAT etc. for the 3090.
        Moved from 15JUL91 this date.

 6513.  February 18, 1991  INSUNIX:INSTEP3 SYS3090:LIBR.DAT       Brian
        Although some programs formerly in AIPPGM have migrated to
        AIPNOT, the changes hadn't migrated to the INSTEP3 scripts.
        A similar affliction affected LIBR.DAT.
        Moved from 15JUL91 this date.

 6514.  February 18, 1991     APL3090:ZR32RL                      Brian
        This made reference to S2VIBM rather than S2IBM. These are both
        IEEE to IBM local format routines in assembler and fortran
        respectively. IBM only donated the fortran version.
        Moved from 15JUL91 this date.

 6515.  February 19, 1991      INC3090                             Brian
        Bumped up the "AP" size to be 1.25MW to be consistent with other
        AP's for DDT purposes.
        Moved from 15JUL91 this date.

 6516.  February 25, 1991                BPASS                  Phil
        When I redid the indexing for multiple IF's I forgot to do
        one loop that dealt with autocorrelation data. Athol's
        MKIII data uncovered the problem and its now fixed.
        Moved from 15JUL91 today.

 6517.  February 26, 1991               ACFIT                 Phil
        When confronted with dual polarization data, ACFIT fell flat
        on its face due to an indexing error in determining the number
        of channels.
        Another problem was uncovered which was due to the nature of
        MkIII data - it is possible to have a polzn or IF at a
        particular time which is all zeroes, ACFIT could not deal
        with that.
        The routine which read in the template file was only removing
        a zeroth order baseline from the template rather than the same
        order polynomial as was removed from the data, fixed that.
        Changed the philosophy of the program so that the user cannot
        select STOKES or IF's to be solved for, the program will now
        do all that exist in the file. May change this again later, but
        its a pain to sort out all the indexing at the moment.
        Added REFANT to the adverb list, so the template file can
        contain data from many antennas and the user just selects which
        is to be the reference antenna.
        Also changed the .HLP file.
        Moved from 15JUL91 today.

 6518.  February 27, 1991               CVEL               Phil
        More indexing troubles, basically caused by the fact that CVEL
        reads and writes a multi-source file. Its very difficult
        keeping track of the correct JLOCx indices in the catalogue
        header when DGHEAD has changed the order in the output catblk.
        Hope I have it all sorted out this time.
        Moved from 15JUL91 today.

 6519.  February 27, 1991              FITLD               Phil
        FITLD was not printing the important message that the file it
        was attempting to read was not a FITS file. It just died of
        unnatural causes. Added a call to MSGWRT.
        Moved from 15JUL91 today.

 6520.  February 27, 1991             SETJY                 Phil
        SETJY was obtaining the channel bandwidth from the SU table
        which does not cover the cases in which ch. bandwidth differs
        from IF to IF, or from FREQID to FREQID. Modified to use the
        FQ table if it exists, if not to use the catblk freq. increment.
        Moved from 15JUL91 today.

 6521.  February 28, 1991               CVEL                Phil
        CVEL was suffering from the same afflication as SETJY (see
        entry 6520). Fixed this up. Also if no CL tables are present
        changed the code so it doesn't enter the routine designed to
        read them.
        Moved from 15JUL91 today.

 6522.  2 March 1991           UVCOP               Neil/Eric
        Commented out a seemingly useless and obstructive test for too
        many SELECTED channels (i.e. when the full band is not
        selected).  I must be missing something or this is just wrong.
        Corrected another error : the task tested for FQ number even
        when there was none in the data set.
        Moved to 15APR91 and 15JUL91 from Oz.

 6523.  2 March 1991             FUDGE                          Eric
        Raised buffer sizes.
        Move from Oz to 15APR91 and 15JUL91.

 6524.  2 March 1991               PRTHI                      Eric
        Changed AU7 to display history-file line numbers when the
        printer or terminal is 80 or more characters across.  Also
        brought the correction to RENAME done in CV to check for
        duplicate file names regardless of type.
        Moved from Oz to 15APR91 and 15JUL91.

 6525.  2 March 1991            BLANK                      Eric
        Changed it to remember the zoom factor and center from frame to
        frame.  Corrected argument to TVFIDL to use the correct number
        of TV levels (LUTOUT + 1).
        Moved from Oz to 15APR91 and 15JUL91.

 6526.  2 March 1991             HISEQ                     Eric
        New task - converts image intensities to a histogram-equalized
        form.  This is very good for display, but the intensities are
        then non-physical.
        Moved from Oz to 15APR91 and 15JUL91.

 6527.  2 March 1991            Plot labels               Eric
        Changed DLOC.INC, SETLOC, CLAB1, CLAB2, and IAXIS1 to display the
        epoch (B1950 or J2000) after the words Declination and Right
        ascension on plots.  SETLOC puts the actual epoch from the
        header in to the DLOC.INC common where it is used by CLAB1 and
        CLAB2.  IAXIS1 gets it straight from the TV image header.
        Changed PROFL as well.
        Moved from Oz to 15APR91 and 15JUL91.

 6528.  2 March 1991              CHLORU                      Eric
        Simple subroutine to convert a string to all upper-case letters
        or to all lower-case letters.
        Moved from Oz to 15APR91 and 15JUL91.

 6529.  2 March, 1991         TVMOVIE, SSS                   Eric
        Changed TVMOVI.FOR to correct the Y zoom position and, for
        FACTOR = 1, the Y scroll position and the X scroll (by 1 only).
        Changed $YSERV/SSS.SHR section CURSOR.C to restore the old
        cursor location computation and corrected the setting of the
        window parameters to include the translation from AIPS TV
        coordinates to those of SUNView (0,0 at top left).  Changed
        section HEADER.H to increase the border by two pixels,
        decreasing the area to 1140 by 875.
        Moved to CV, without the Y size (they use a smaller one).

 6530.  March 6, 1991         CVEL                         Phil
        The fix I made on Feb 28 finally got compiled on kong, and
        I found out that I had not declared a loop counter. Bloody
        Convex compiler. Fixed.
        Moved from 15JUL91 today.

 6531.  March 7, 1991     FRING                        Bill C.
        Added an option invoked by APARM(5)=2 to fit for both multi- and
        single-band delays in the least squares solution.  In this case
        the coarse search still fits a multiband delay.  The SN table
        entries include the multiband delays in the IF dependent phase
        and the single band delays as the "delay". Also changed
        FRING.HLP.
           Fixed bug which alowed reference times for two polarizations
        to be different.  This caused a phase error for the first
        polarization in the calibrated data of the fringe rate times the
        difference in reference times of the two polarizations.
           Enhanced diagonostic messages.  Corrected the normalization
        of the weights that was allowing solutions well outside of the
        specified window.  Improved the handling of baseline weights in
        FRNSRC.  Bad data in one IF could cause all data for a given
        antenna to be discarded.
        Moved from 15JUL91 this date.

 6532.  March 7, 1991           CVEL                          Phil
        Dusted off a subroutine (whose call sequence had been commented
        out) which interpolated across flagged channels. Needed to do
        this because with MkIII data flagged channels are a reasonably
        common occurence. When MK3IN flags a channel zeroes are written
        into it, this causes a serious problem when shifting AC data
        after bandpass correction because the BP correction results
        in the value -1 being written into the flagged channel's value.
        When this occurs and the data are FFT'd and shifted the
        resultant spectrum is contaminated by ringing. Now interpolate
        across flagged channels before shifting and also shift the
        weights in a more correct manner. After shifting the channels
        that shift from one end of the spectrum to the other are now
        flagged.
        Moved from 15JUL91 today.

 6533.  March 8, 1991               $APGNOT/TBOUT.FOR      Bill J.
        Prior to writing a table row to the output file, a test was
        made for FBLANKed values.  The checks the value of the
        equivalenced REAL array for FBLANK. However, the equivalenced
        INTEGER array RESI may contain a valid record of -1 which has a
        REAL representation of -NaN and this causes problems.  Added
        a trap for this situation.
        Moved from 15JUL91 today.

 6534.  March 11, 1991       APL3090: D2IBM D2IEEE                  Brian
        IBM finally got around to giving us the double precision IEEE to
        IBM and reverse routines (an oversight).
        Moved from 15JUL91 this date.

 6535.  March 13, 1991       $YSERV/XAS.SHR, AIPSSHAR           Pat
        XAS.SHR didn't have a Makefile.  Harry Payne kindly contributed
        one that I hacked on a bit and tested (mostly).  Noticed some
        misleading comments and usage notice in AIPSSHAR while doing
        this, so fixed those too.
        Moved from 15JUL91 this date.

 6536.  14 March, 1991         TVFLG, SPFLG               Eric
        Changed SPFOAD, TVFOAD, DSPF.INC, DTVF.INC, SPFLG, TVFLG, and
        their help files to implement 3 new display modes.  These are
        based on computing a running average of the data over a period
        of time arbitrarily called a "scan".  The first new display is
        of the amplitude of the difference of the current sample with
        the vector scan average.  The second new display is of the
        difference of the amplitude of the current sample and the scalar
        average amplitude in the scan.  The third new display is of the
        difference of the phase of the current sample and the phase of
        the vector averaged scan.  These --- especially the first ---
        provide powerful new ways to find discordant data without having
        to delete a full averaging interval as with methods using the
        rms and rms/mean.
        Corrected an error in the routine that finds the highest flag
        number in the flag control file.  I had added a column of data
        (the scan time of the flag) and had not changed the pointer
        value.  Fixed the code to get the pointer symbolically and hence
        to avoid this bug in future.  Also fixed a minor addressing
        error in SSS --- routines CURSOR.C and SCRWRT.C.
        Moved from Oz to 15APR91 (so that they will be released) and
        15JUL91.

 6537.  March 15, 1991      $SYSUNIX/FC                     Gareth
	Correct a couple of minor bugs in handling of options.  NOOPT
        now removes all compile options including OPT1.  Specifying a
        given option (e.g. OPT3) now removes all other options before
        adding the option correctly (it used to add the string "OPT3"
        instead of interpreting it).
        Moved from 15JUL91 this date.

 6538.  March 19, 1990         DECOR                    Bill C.
        Corrected call sequence to decorrelation routine.  The
        visibility data were not being passed correctly.
        Moved from 15JUL91 this date.

 6539.  March 19, 1991             $APGNOT/DBCON.FOR    Bill J.
        Check for compatibility of two files to be glued together
        made unwarranted assumption that the frequency axis
        increment was positive.  This isn't the case for some WSRT
        data, in particular.
        Moved from 15JUL91 today.

 6540.  March 20, 1991         UVAVG                            Phil
        Added an option whereby cross and autocorrelation data can be
        merged seperately if their averaging times inside the data file
        are different. Also update the HLP file.
        Increased buffer size to 5 Mwords so that any VLA dataset can
        be averaged without sorting to BT.
        These changes are to bring the NEW version in line with the TST.
        Moved from 15JUL91 today.

 6541.  March 20, 1991            BPASS                Phil
        Added another new mode to BPASS. For VLBI experiments one
        may often want to apply delay and rate calibration and then
        divide by channel 0. However for normal use we preclude this
        because users were often calibrating their data with the
        complex gains and then dividing by channel 0 which caused
        all sorts of problems. So now, if BPASSPRM(11) > 0 then
        the user can calibrate and divide by channel 0, however the
        input file tells the user not to do this if he/she does not
        understand what they are doing. Also changed BPASS.HLP, and
        then NEWPARMS.001 and POPSDAT.HLP because BPASSPRM grew.
        These changes are to bring the NEW version in line with the TST.
        Moved from 15JUL91 today.

 6542.  March 20, 1991      $QNOT/UVUNIF and UVTBUN        Glen
        UVUNIF and UVTBUN now use the frequency defined by FREQG(CHUV1)
        for scaling the input uvdata before gridding.  This was done
        so that UVUNIF and UVTBUN will use the save scaling factors
        as are used by UVGRID and UVGRTB.
        Moved from 15JUL91 this date.

 6543.  March 20, 1991      $INC/DAPC.INC                   Glen
        Another change to the comments.  Now has values for the usual
        AP sizes.  The work array RWORK has been moved to QCFFT.
        Moved from 15JUL91 this date.

 6544.  March 20, 1991     $APLNOT/UVZRWT.FOR               Glen
        New subroutine that is used by UVGRID and UVGRTB.FOR.
        Moved from 15JUL91 this date.

 6545.  March 20, 1991    $QVEX/QXFOUR and QXFOR2           Glen
        Added two subroutines to QVEX, the old single precision QXFOUR
        and QXFOR2.  These routines are faster on the convex than the
        four times more accurate double precision ones in $QPSAP.
        Moved from 15JUL91 this date.

 6546.  March 21, 1991            SNSMO                    Bill C.
        New task to filter SN tables.  Much of the smoothing
        functionality of CLCAL is reproduced but this task included two
        useful model for smoothing FRING VLBI solutions.  Coupled
        smoothings of delay (single and multiband), rate, amplitude and
        phase.  The methods attempt to maintain coherence amoung the IFs
        of a given Stokes' parameter (but not between Stokes').  This
        task should be very useful for MkIII VLBI and VLBA data.
        Moved from 15JUL91 this date.

 6548.  March 22, 1991           TVFLG                   Phil
        The call sequence to ANTINI was missing a variable again!
        This is the second time I have fixed this (see entry 6488).
        This is one problem caused by testing things under a system
        that is not fully up to date.
        Moved from 15JUL91 today.

 6549.  March 22, 1991             CLCOR                   Phil
        LL only again, CLCOR will never have worked on LL only data.
        Added one extra line in the input parameter subroutine fixed
        it.
        Moved from 15JUL91 today.

 6550.  March 21, 1991            SNSMO                    Bill C.
        Fixed bug for some smoothing types in which a flagged gain was
        interpolated but the weight was left non positive effectively
        flagging it.
        Moved from 15JUL91 this date.

 6551.  March 26, 1991          IBLED                Phil
        There was a problem when IQUV data were edited in IBLED.
        This occurred when the user restarted a session and IBLED
        read the FC table from the scratch file, it did not know
        how to deal with the 'IQUV' string in the polzn column.
        Fixed.
        Moved from 15JUL91 today.

 6552.  March 26, 1991           FRING               Phil
        HAd an annoying little bug, when the user specified a
        SOLINT and FRING adjusted this downwards due to memory
        limitations it told the user but then went and wrote the
        solutions at the original interval. Changed 2 things:
        (1) Changed XASIZE from 100,000 -> 300,000 to lessen the
        possibility of this happening, should cope with most
        MkIII cases, but not all.
        (2) Set a trap in FRNGIN to check the solution interval
        (if non-zero) to see if it is viable, if not resets it
        at the very top level.
        Moved from 15JUL91 today.

 6553.  March 27, 1991            CSCOR                    Bill C.
        Fixed a sign error of the antenna longitude in calculating
        zenith angle and now converts longitude to sidereal units.
        Moved from 15JUL91 this date.

 6554.  March 27, 1990        SNCOR                        Bill C.
        Added new options:
          'CLPA'  Flag gains with amplitudes outside a given range.
          'CLPP'  Flag gains with phases outside a given range.
          'ZPHS'  Set gain phases to zero (useful for amplitude only
                  calibration).
        Also fixed a bug in the handling of data with LCP only (yes
        another one.)  Changed SNCOR.HLP.
        Moved from 15JUL91 this date.

 6555.  March 28, 1991              BPASS               Phil/Neil
        Neil found a bug in the spectral interpolation routine which
        caused it not to work in all cases. Fixed.
        Moved from 15JUL91 this date.

 6556.  March 28, 1991              CVEL               Phil
        Modified to determine the reference station from the baseline
        number as described in entry 6586. This removes the necessity
        of the user informing CVEL whether the data is MkIII or not,
        so changed the .HLP file to reflect this.
        Moved from 15JUL91 today.

 6557.  March 28, 1991             VLBIN                   Phil
        Added some extra adverbs to govern data selection. The user
        can now specify a bandwidth and frequency range to load into
        AIPS. Also the user can specify the reference frequency to
        be inserted in the catalogue header, this will override the
        first value found in the data - is useful when concatanating
        spectral line files. Modified .HLP to reflect these changes.
        To facilitate CVEL shifting of the data down the line, I now
        encode the reference station used in the correlator as the
        1/1000th part of the baseline number (a la subarrays), this
        will work if there are no more than 20 antennas (not likely
        for MkII spectral line experiments).
        Moved from 15JUL91 today.

 6558.  April 1, 1991         TVFLG, SPFLG         Eric
        Changed the scalar amplitude and phase difference displays to
        show the absolute value of the difference.  The sign of the
        difference is of little import compared to the magnitude.
        Moved from Oz to 15APR91 and 15JUL91.

 6559.  April 1, 1991        XMOM        Eric
        Corrected an error that had the image header for the 1st moment
        correct, but the image itself too low by the reference pixel
        value.  This was an overhaul bug - the reference pixel value was
        hidden in the image scaling to avoid loss of precision which we
        now can no longer avoid.
        Moved from Oz to 15APR91 and 15JUL91.

 6560.  April 5, 1991         $APLSUB/SETLOC            Pat
        Corrected a minor bug that only affected Aitoff projections
        when the reference pixel was non-zero.
        Moved from 15JUL91 this date.

 6561.  April 8, 1991        CLCOR.FOR, CLCOR.HLP        Gareth
        Added a new OPTION, which I have called SSLO, to cope with the
        case of two VLA IFs which are normally locked together but
        observing at the same center frequency with different
        bandwidths.  In this case, the frequencies are not locked
        together and the Signed Sum of the LOs used for phase tracking
        is wrong for one of the IFs.  This mode should only used by
        experienced VLA spectral line users.  For further confusion,
        see the help file.
        Moved from 15JUL91 this date.

 6562.  April 8, 1991          $APGNOT/UVPRM.FOR      Glen
        Added a few new measurements. UVPRM returns the Observing Time,
        Min and Max Baseline length, Source Flux and Error, and
        reference antenna.
        Moved from 15JUL91 this date.

 6563.  April 8, 1991       $RUNSYS/MAPIT.001   Glen
        Improved use of ADVERB SOLINT, which is defined as the
        longest reasonable PHASE Only self-calibration interval.
        During the first 2 iterations, SOLINT is used in CALIB.
        In latter iterations SOLINT/2, SOLINT/3, SOLINT/4 ...
        are used.  For Amp and Phase selfcal, the solution interval
        is 4 times SOLINT. Also Fixed help file MAPIT_MX, a list of MX
        adverbs which can also be used with MAPIT, but are not
        normally changed.  Many Small improvements.
        Moved from 15JUL91 this date.

 6564.  April 8, 1991       $HLPFIL/MAPIT,MX,ZEROSP      Glen
        Describe MAPIT in three sections, MAPIT_NA, MAPIT_UV and
        MAPIT_MX.  Describe new MX zerospacing and uvweighting
        capabilities.
        Moved from 15JUL91 this date.

 6565.  April 8, 1991           Plotting                          Eric
        Corrected the Y position of vertical axis labels in CLAB1,
        CLAB2, TKLAB, PROFL, and GNPLT.  Added the epoch to TKLAB
        coordinates.  Corrected the positioning of the vertical label in
        LWPLA.
        Moved from Oz to 15JUL91 and 15APR91.

 6566.  April 8, 1991               POSSM                      Eric
        Corrected output to text file to label the columns (now
        including the IF) correctly.
        Moved from Oz to 15JUL91 and 15APR91.

 6567.  April 11, 1991              $QYPGNOT/MX.FOR            Glen
        Added a collection of Multi-IF scaling tests.  Also clean
        now stops at first negative CC if requested.  Zerospacing
        flux now allows a source size parameter.  Beam shape is
        fit by a gaussian, even if no components are restored.
        Moved from 15JUL91 this date.

 6568.  April 11, 1991              $QNOT/UVGRID,UVGRTB        Glen
        Changes for multi-if data scaling.
        Moved from 15JUL91 this date.

 6569.  April 11, 1991              BSMAP                      Gareth
        An illegal Fortran statement (comparison between a COMPLEX
        and a REAL in an IF clause) caused the Sun compiler to fail
        when trying to optimize.  Fixed.
        Moved to 15APR91 and 15JUL91 this date.

 6570.  April 12, 1991           SGINDEX                       Eric
        Corrected SG version number in AU2A to match that in SGLOCA
        - it's now 11 in NEW and 12 (for TVLINE) in TST.
        Moved from Oz to 15JUL91 and 15APR91.

 6571.  April 12, 1991           TVBLINK                      Eric
        AU6A did not reset the selected channel properly when the
        TV has no split screen (i.e., SUNs).  Added an OFFF for the
        other channel to go with on ONNN for the desired one.
        Moved from Oz to 15APR91 and 15JUL91.

 6572.  April 12, 1991          $APLNOT/TABFRM         Glen
        Modified TABFRM to allow "F" Format (i.e F5.2).  Don Wells
        said we should be more generous on read than on writing FITS.
        Old IMLOD used to give IMLOD: TABFRM: BAD FITS TABLE FORMAT F5.2
        But now "F" Format is interpreted as "E" Format.
        Moved from 15JUL91 this date.

 6573.  April 15, 1991          $APLSUN/ZABORS.C        Gareth
        Added "#ifndef sparc" to make this module usable on both Sun 3s
        and Sun 4s/Sparcs.  Tested on 4.1.1 on Sun Sparcs and on Sun 3s.
        Moved to 15APR91 and 15JUL91 this date.

 6574.  April 15, 1991          FILLM.FOR, FILLM.HLP    Gareth
        1. Fixed formatting bug in HI entry writing.  This caused some
        input parameters not to appear in the HI file.
        2. Minor fix in VLA band determination for the high end of L
        band.
        3. Changed the definition of CPARM(7) (FQ tolerance) for
        continuum only.  A value of <= 0 now forces a limit of 100 kHz.
        Added a message to tell user when all frequencies are being
        forced into the same FQ.  This is wrong in several cases, e.g.
        when IF #2 changes but not IF #1.  I would like to change the
        default, but I could not get a consensus from the spectral line
        users.
        4. Changed the help file to reflect these changes.
        Moved to 15JUL91 and 15APR91 this date.

 6575.  April 15, 1991          $AIPSPUBL/COOK4.TEX     Gareth
        Minor change to document change in FILLM.
        Moved to 15JUL91 and 15APR91 this date.

 6576.  April 15, 1991          POSSM                       Eric
        Corrected several axis labeling errors.  The only significant
        one caused frequency and velocity axes to be offset by one
        channel.  The F or v shown was for one channel higher than
        correct.
        Moved from Oz to 15JUL91 and 15APR91.

 6577.  April 17, 1991            POSSM                        Eric
        Corrected the code to plot (and print to OUTFILE) the correct
        velocities.  Previously it was treating optical velocities as a
        linear axis.  Further, it was putting "velocities" in the
        OUTFILE using the axis parameters (in part) even when they were
        in units of channels or MHz!  The general belief is that this
        should not matter for small velocities.  However, the
        differences amount to rather more than a channel when one has
        1024 channels over 8 Mhz at 1420.
        Moved from Oz to 15APR91 and 15JUL91.

 6578.  April 18, 1991        $QYPGNOT/MX.FOR                Glen
        Still trying to get the last few points in Bill J's data base
        rejected in MX for 4096**2, Two IF data base, when they fall
        outside the UV grid.
        Moved from 15JUL91 this date.

 6579.  April 22, 1991        $APGNOT/QUACK.FOR            Bill J.
        Initialisation of antennas, channels and IFs for FG table was
        not being performed correctly using DATA statement on SUNs.
        Spurious values were introduced into the FG table --- usually
        very large numbers --- and LISTR et al. were trying to use this
        information and consequently being exceedingly slow.
        Moved from 15JUL91 today.

 6580.  April 22, 1991         $APGNOT/PRTUV.FOR            Bill J.
        RA for output listing was being calculated incorrectly.
        Moved from 15JUL91 today.

 6581.  April 23, 1991         $APLPGM/PRTAN.FOR          Bill J.
        Indexing in subroutine PRTLVA was incorrect with the result
        that pad N1 was being lost.  This caused confusion for
        users.
        Moved from 15JUL91 today.

 6582.  April 18, 1991        $QYPGNOT/MX.FOR                Glen
        Found reason for long lasting problems with MX data selection.
        UV grid for images is larger than for beams.  (Clean beam is
        no bigger than 512 pixels).  Because UV data can not be gridded
        near edge of grid the max UVrange is smaller for the beam than
        for images.  Added a factor to reject a few more points near the
        edge of the grid.
        Moved from 15JUL91 this date.

 6583.  April 23, 1991      $SYSUNIX+$SYSSUN/LIBR.DAT     Glen
        Adding $AIPNOT to LIBR.DAT files.
        Moved from 15JUL91 this date.

 6584.  April 23, 1991         $YPGNOT/IRING.FOR           Bill J.
        Arguments in call to GINIT were incorrect.  This caused IRING to
        fail if plot creation was required.
        Moved from 15JUL91 today.

 6585.  April 28, 1991          $SYSIBM/LINK            Gareth
        There is a naming conflict in the C and Fortran libraries.
        With the newer versions of RS/6000 AIX (3003 and later - or
        whatever IBM numbers these releases now) the lbsd library and
        the lc libraries must be scanned before the lxlf (Fortran)
        library.
        Moved to 15APR91 and 15JUL91 today.

 6586.  29 April, 1991                SYSUNIX:PP                  Brian
        In response to a complaint from Eric, I learned that PP has not
        been removing *.[fcs] files before preprocessing. This will
        cause preprocessing to fail if an existing file is not
        writable even if the directory is.
        Moved from 15JUL91

 6587.  May 5, 1991      $APLNOT/UVZRWT                  Glen
        Scaled zerospacing flux angular size for FWHM to sigma.  Corrected
        logic error causing Zerospacing flux to be given a slightly too
        large weight.
        Moved from 15JUL91.

 6588.  May 6, 1991              TVFLG, SPFLG                 Eric
        FOUND a bug - TBTIME left the NX file open under LUN 30 whenever
        the user specified a single scan in his TIMERANG.  Then it could
        not open the existing FG table as LUN 30 and so acted as if
        there were none.  Corrected in both.
        Moved from Oz to 15APR91 and 15JUL91.

 6589.  May 8, 1991              $APLGEN/ZUVPAK                Eric
        Corrected a stupidity --- the gain was set based on all data
        including flagged visibilities.  Thus, much accuracy was lost to
        excessively high visibilities even when they were flagged.  This
        might make sense if ZUVPAK had retained the vis values, but it
        set them to magic values in the very next loop.
        Moved from Oz to 15APR91 and 15JUL91.

 6590.  May 10, 1991            $APGNOT/FILLM           Gareth
        There was a tape buffer resonance problem.  When a correlator
        record ended precisely at the end of a physical tape record,
        all subsequent baselines for the current IF were offset by one
        word.  This has been a problem since the program was first
        written.  The problem occurs in 2-4% of all possible VLA
        permutations of spectral line modes and number of active
        antennas.  It did not fail in continuum.  Now fixed in the
        cases I could test - I hope I haven't broken other modes.
        Moved from 15JUL91 this date.

 6591.  May 12, 1991            $APLSUN/ZACTV9.C        Gareth/Chris
        With revision 4.1.1 of Sun Unix, it was impossible to run AIPS
        tasks under the debugger.  This was true on Sparcs, not on Sun
        3s.  It appears that the "wait" system call, used to wait for
        tasks in ZACTV9, is now obsolete.  This has now been replaced
        by the "waitpid" system call, which works fine for both
        architectures.  This Posix system call is not available on any
        version of Sun OS prior to 4.1.  The generic version in $SYSUNIX
        will continue to work fine.  If remote sites have these old
        revisions, they must remove $APLSUN/ZACTV9.C before running
        INSTEP2.
        Added to 15APR91 and 15JUL91 this date.

 6592.  May 14, 1991                    TVFLG                  Phil
        For some inexplicable reason, 2 lines of code which used to
        exist in routine TVFMRK, and were essential to the flagging
        of single source files had been deleted. Put them back.
        Moved from 15JUL91 today.

 6593.  May 15, 1991                   BPGET                  Phil
        There was an amazing screwup inside BPGET, someone (God knows
        who) had commented out an IF...END IF statement. This caused the
        routine to go and open and close the master scratch file for
        every visibility point, when normally this need only be done
        once. When fixed Junor and I got a speed up of a factor of 9!
        on a test data set run through HORUS.
        Moved from 15JUL91 immediately.

 6594.  May 15, 1991                   DATBND            Neil/Phil
        Neil fixed up the correction of IQUV and RL/LR data. Also the
        comments in the subroutine header were misleading.
        Moved from 15JUL91 today.

 6595.  May 16, 1991          $QNOT/MAKMAP.FOR            Glen
        Too cautious, MAKMAP, error fixed in TST a month ago, but
        was afraid to move it to new.  Scratch file was not being
        intialized after the first of 8 channels.
        Moved form 15JUL91 this date.

 6596.  May 16, 1991          $QPGNOT/CALIB.FOR            Glen
        Added limits on the number of calibration sources printed
        and made the default CC table the highest.  Improved
        History File text.  Shortened HITIME.FOR  printout.
        Moved form 15JUL91 this date.

 6597.  May 16, 1991          $YPGNOT/SNPLT.FOR            Glen
        Allowed VLBI L or R only data with optyp= 'SUM', summary.
        Moved form 15JUL91 this date.

 6598.  May 16, 1991          $APGNOT/MOMFT.FOR            Glen
        Moment Fit now checks for blanked pixels and excludes
        below a minimum input brightness.  Moments are calcuated
        as the first, second and third power of the source brightness
        which gives a more reliable measure of compact source
        structure.  Also changed MOMFT.HLP
        Moved form 15JUL91 this date.

 6599.  May 18, 1991            Workstation tape handling       Gareth
        This is a fairly extensive change to tape handling mainly for
        workstations.

        First, since Unix workstations do not have facilities for tape
        device allocation, the usual mode of operation is "INTAPE n; GO
        xxxxx" with no "MOUNT" command.  The mount command on
        workstations has previously made device assignments, but this is
        not necessary.  It is easier to do and easier to control if the
        assignments for MT0n are required to be done in ASSNLOCAL.SH.
        So
        $APLIBM/ZMOUN2.C                is removed completely.
        $APLUNIX/ZMOUN2.FOR             is new.  It always returns a
                                        successful mount/dismount
                                        condition.

        Second, remote tapes.  I have packaged a public domain remote
        tape handling utility for use in AIPS.  This allows a Unix
        machine to use a tape drive on another one if the basic tape I/O
        commands are identical.  The remote tape capability is selected
        by defining the option REMOTE_TAPES in CCOPTS.SH.  If it is
        selected, then I/O calls for drive functions are intercepted by
        the routines in ZRMTAP.  The device name for the open is of the
        form:
           [<system>:]/dev/<device>
        If the system name is absent, then all subsequent commands to
        the device are performed on the local system.  If the system
        name is given, then a pipe is opened to that system, and all
        subsequent operations on that device are passed to the remote
        system.
        $APLBERK/ZRMTAP.C               Public domain package with
                                        wrappers for AIPS.
        $APLBERK/ZTAPIO.C               All of these routines will
        $APLBERK/ZTPCL2.C               use the entries in the ZRMTAP
        $APLBERK/ZTPMI2.C               modules instead of the native
        $APLBERK/ZTPOP2.C               system calls if REMOTE_TAPES
        $APLBERK/ZTPWA2.C               is defined.  If not, they
                                        produce the same code as the
                                        versions in $APLUNIX.
        $APLSUN/ZTAP2.C                 These routines use the ZRMTAP
        $APLCVEX/ZTAP2.C                entries if REMOTE_TAPES is
        $APLCVEX/ZTPOP2.C               defined.  Otherwise they
        $APLCVEX/ZTPWA2.C               produce the same code
                                        as they did previously.
        This has been tested on Sun 3, Sun sparc, Solbourne, and Convex.
        It is likely that these are interoperable with DECstations,
        since the basic tape operations seem to be compatible.  Alliants
        may also be compatible with the above; IBMs are not.  However,
        it is likely that this will work between IBMs.
        Moved to 15APR91 and 15JUL91 this date.

 6600.  May 18, 1991              $APLNOT/UVZRWT.FOR          Glen
        Modified zero spacing flux subroutine for MX.  Now does not
        assume exact Int to Real Conversion and limits model for
        extended sources.  Gaussian Model for extended sources
        is limited to only 1/100 of the peak (zerospacing) flux.
        Moved from 15JUL91 this date.

 6601.  May 19, 1991     $RUNSYS/DDTHLOAD.001                Glen
        Assorted fixes to speed execution and improve map.  Changed
        CellSize for clean and fixed Test outdisk error.
        Moved from 15JUL91 this date.

 6602.  May 20, 1991         $QNOT/ALGSUB,ALGSTB      Glen/Bill J.
        Found another large field multi-IF bug in MX.  Added more
        logic to scale the Max U by the frequency.
        Fixed in 15JUL91 on April 1, 1990, but did not move it to NEW.
        Moved from 15JUL91 this date.


 6603.  May 19, 1991          SSS TV Server                  Eric
        Cleaned up the typing some more.  Corrected the drawing of
        pixels when the image is zoomed to allow for partial pixels on
        the sides of the visible window.  Changed the pixel addressing
        by one as well to get the hot spot of the cursor to be the
        actual pixel at its tip.  It seemed to be one left and one above
        before.
        Moved from Oz to 15JUL91 and 15APR91.

 6604.  May 9, 1991              $APGNOT/ACFIT.FOR            Athol/Glen
        Incorrect averaging of the last record in some scans. This
        record was sometimes corrupted. This effect was more
        noticeable for shorter solution intervals.
        Moved from 15JUL91.

 6605.  May 21, 1991             DATBND                    Phil
        After some discussion Neil convinced me that I was needlessly
        conjugating the imaginiary portion of the bandpass correction
        for cross-hands.
        Moved from 15JUL91 tpday.

 6606.  May
