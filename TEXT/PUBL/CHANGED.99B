-----------------------------------------------------------------------
;  Copyright (C) 1998-1999
;  Associated Universities, Inc. Washington DC, USA.
;
;  This program is free software; you can redistribute it and/or
;  modify it under the terms of the GNU General Public License as
;  published by the Free Software Foundation; either version 2 of
;  the License, or (at your option) any later version.
;
;  This program is distributed in the hope that it will be useful,
;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;  GNU General Public License for more details.
;
;  You should have received a copy of the GNU General Public
;  License along with this program; if not, write to the Free
;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
;  MA 02139, USA.
;
;  Correspondence concerning AIPS should be addressed as follows:
;         Internet email: aipsmail@nrao.edu.
;         Postal address: AIPS Project Office
;                         National Radio Astronomy Observatory
;                         520 Edgemont Road
;                         Charlottesville, VA 22903-2475 USA
-----------------------------------------------------------------------
     This file must be used to record any changes made to the Master
version of AIPS kept in Charlottesville.  An entry is:

   line 1:   Date Program name Your name
   line 2:   What was done (may span multiple lines)
   line n-1: Where has this change been moved (e.g. 15JUL94, nowhere)
   line n:   Blank

 The details of line 1 are important since programs are used to find
 specified strings and do conversions on them.  It MUST be typed as
 follows: 1 blank, 4 digits, a period, two blanks, then the Month,
 day, comma, year, some space, a title, some more space, your name.


                    Changes to 15APR99


***********************************************************************
***********************************************************************

                 Changes while 15APR99 is TST

***********************************************************************
***********************************************************************

10026.  September 20, 1998        $QPGOOP/OMFIT             Ketan
        Indexing error caused SN table time-tags to be off by one
        solution interval when self-calibrating data.
        Moved to NEW tomorrow.

10027.  September 21, 1998        $QPGOOP/OMFIT and HLP     Ketan
        Indexing error caused covariances between self-calibration
        parameters to be ignored - slowing convergence when
        self-calibrating data.  Also loosened convergence criteria
        until self-calibration error-bars are properly sorted out.  The
        weights reported in the SN table may not yet be correct.
        Moved to NEW this date.

10028.  September 21, 1998          SPLIT                      Eric
        Changed
        INDXIN   To return -1 when there is no error except that no
                 matching index record is found
        UVGET    To handle the -1 return from INDXIN
        SPLIT    To handle -1 returns from UVGET better (keep going if
                 looping over subarray, else go on to next source).
                 Also to not send subarray 0 into UVGET at all.  Changed
                 default for NPOINTS to all channels.  Fixed count of
                 channels averaged to apply to FQ table values.
        SPLIT    Fixed help for new NPOINTS default.
        DATCAL   Changed logic counting samples so that those either
                 previously flagged or flagged by gain would be known as
                 dead.
        Moved to 15OCT98 this date.

10029.  September 21, 1998          TVFLG                      Eric
        There were several arrays of 5000 meant to handle #subarrays *
        #baselines.  Changed these to 15000 for Frazer.
        Moved to AOC today in SUL and to 15OCT98 this date.

10030.  September 22, 1998        $QPGOOP/OMFIT              Ketan
        Strange typo introduced yesterday is now fixed.  Also, found an
        array out-of-bounds condition that was only triggered for large
        self-calibration problems.
        Moved to NEW this date.

10031.  September 22, 1998          FITLD                       Eric
        Added comments in DOCONCAT section about setting OUTSEQ=0 for
        concatenating.
        Moved to 15OCT98 this date.

10032.  September 22, 1998          UVCOP                       ERic
        Selecting by source in the CL copying can cause problems with CL
        tables that are not set up well wrt the sources being copied.
        Changed it to call CLSEL with 0 for the number of selected
        source (which means no selection applied).
        Moved to 15OCT98 this date.

10033.  September 23, 1998      $QPGNOT/CVEL.FOR              Leonia
        Several bugs have been found in the routine ACSHFT.
        The hanning smoothing-convolution has been added to the
        routine XCSHFT, which shift cross spectra. Originnally the
        smoothing of the shifted spectrum was provided only for VLBA(?)
        and only for auto spectra. Now the hanning smoothing-convolution
        is carried out under control of APARM(9). The hanning smoothing-
        convolution help to exclude(minimize) the faken phase jumps,
        which appear in the case of the strong narrow feature in the
        spectrum. The HELP file is updated.
        Moved nowhere

10034.  September 23, 1998     $APLNOT/ACSHFT.FOR         Leonia
        I fixed several bugs in this routine which have brought
        errors in the shifted spectra.
        Moved nowhere

10035.  September 23, 1998     $QNOT/XCSHFT.FOR           Leonia
        I added the smoothing option to the process of the cross
        spectrum shift. So the new input parameter ISMTH is added.
        Moved nowhere

10036.  September 23, 1998     $QPGNOT/SDVEL.FOR         Leonia
        It is comlnked with the new version of ACSHFT.FOR
        Moved nowhere

10037.  September 23, 1998     $QPGNOT/BPASS.FOR         Leonia
        It is comlnked with the new version of XCSHFT.FOR.
        The new input parameter ISMTH put zero.
        Moved nowhere

10038.  September 28, 1998     $APGNOT/UVFLG.FOR         Leonia
        If APARM(6)>0 but APARM(5)<1 the task flagged the data
        following input parameters but not intervals near small
        fringe rate as it should be. But it is reasonable in this case
        not flagging at all but provide the user information
        about the locations of the small fringe rate in accordance
        of APARM(6)>0. I changed the logic to do it.
        Flagging of intervals near zero fringe rate can not be
        carried out for single source data with FLAGVER=-1.
        The relevant warning is added.
        Moved nowhere

10038.  September 30, 1998     $QPGNOT/KRING.FOR         Ketan
        Fixed a typo that prevented multi-band delay solutions from
        being transferred to all IFs in the solution table.  This
        only affected the 'SMBD' and 'MBD' OPTYPES.
        Moved to 15OCT98 this date.

10039.  September 30, 1998     $HLPFIL/SAD.HLP           Ketan
        At user request, added missing description of DPARM(6) to
        inputs section of help file.
        Moved to 15OCT98 this date.

10040.  September 30, 1998     $QPGOOP/OMFIT.FOR         Ketan
        Squashed some bugs, added some new ones.  Fixed SN table
        writing routine.  I was writing out each solution twice with
        different times.  Also, fixed the writing of GAINS model info
        to the SN table so that GAINS model solutions can be used with
        other AIPS tasks via the SN table.  At user request, I added a
        new model, the BLOB model.  This model allows for a Gaussian
        component with variable position.  Currently, the only linear
        variability with time is implemented.  This could easily be
        generalized to non-linear variations with time, frequency,
        channel, IF, etc. [any requests?]
        Moved to 15OCT98 this date.

10041.  October 8, 1998       $APLAXLIN/various         Pat
        Placed the APLLINUX versions of ZGRLHI, ZGRLTC, and ZPRMPT in
        APLAXLIN to test them with the new readline v2.2 library.
        Readline now works under this architecture too.
        Moved to 15OCT98 this date.

10042.  October 8, 1998      $AIPSPUBL/AIPSMEM101.TEX    Ketan
                              $AIPSFIG/AM101[A,B].EPS
        Fringe-fitting memo is now checked in.

10043.  October 8, 1998       $QPGNOT/KRING.FOR           Ketan
                              $HLPFIL/KRING.HLP
        New SNR calculation has been moved into place in KRING.  The
        HLP file now reflects the new calculation, proper references
        to the Schwab and Cotton paper, AIPS MEMO 101, and
        fringe-fitting now in explain section of HLP file.
        Moved to 15OCT98 this date.

10044.  October 15, 1998      $APGNOT/PCCOR.FOR           Leonia
        PCCOR has not worked in the case of LSB/USB, if the Pcal tones
        are not located symmetrically near the edges of IFs. Previously
        the tones were located on equal distance from the left and right
        edges of IFs. After recentely change in  SCHED it is not right.
        PCCOR calculated phase difference of the given IF relatively the
        first IF using distance between the IFs beginning but it should
        be done for distance between the first tones.  I fixed it.  The
        minor change has been done with more correct using of the
        reference pixel.
        Moved nowhere.

10045.  October 15, 1998             FITLD                Chris
        Added code to add the appropriate number of days to the
        TIMERANG entries in FITS interferometric data interchange
        FLAG tables.
        Moved nowhere yet. Needs to be added to the 15OCT98 patch
        area when it becomes available.

10046.  October 16, 1998      $QPGNOT/CVEL.FOR            Leonia
        CVEL has not worked in 15OCT98 and 15APR99 if SUBARRAY=0 is
        used. SUBARRAY has not been recalculated to 1 as it is written
        in HELP. I added this recalculation.
        Moved nowhere.

10047.  October 19, 1998      $QPGNOT/CALIB.FOR           Leonia
        The new option has been added to CALIB.
        If CPARM(2)>0, CALIB provided normalization of mean gain
        to one over all antennas, polarizations, and IFs. Rick Perley
        requested to print the value of the global normalized factor.
        It has been  done. Additionnaly the gain, averaged over all
        antennas for each IF and polarization is printed also.
        Moved nowhere.

10048.  October 21, 1998      $APGNOT/SPLAT.FOR           Leonia
        SPLAT has been died if ASSEMBL option aplied to single source
        file. I changed it. Now SPLAT transforms the single source file
        to another single source file giving a relevant warning.  The
        HELP file is changed a little bit to cut short the title into
        one line.
        Moved nowhere.

10049.  October 21, 1998      GETSIP in APLNOT            Chris
        New subroutine to calculate the geometry associated with
        a line of sight through the ionosphere; taken from GPSDL
        and generalized to allow the altitude of the ionosphere
        as a parameter.
        Moved nowhere.

10050.  October 21, 1998           TECOR                  Chris
        New task to perform ionospheric Faraday rotation and
        dispersive delay corrections using maps of the free
        electron content of the ionosphere in standard IONEX
        format.
        Moved nowhere.

10051.  October 22, 1998              Calibration              Eric
        CSLGET had a nasty feature added to it in 1992 when gain
        normalization was added.  If a solution was flagged in the SN or
        CL table, then the previous solution was left in the arrays used
        for the interpolation although the time was updated.  Changed it
        to put the new solution into the interpolation arrays even if
        it is flagged --- which was intended but one wanted to avoid
        multiplying a magic blank by something which would make it not a
        magic blank anymore.  This error/feature caused data that should
        have been flagged to be calibrated with good solutions from
        (potentially much) earlier times.
        Moved nowhere - this needs testing before going to the patch
        area.

10052.  October 26, 1998       CSLGET in APLNOT          Chris
        Fixed an error in initializing the IFR table in which the
        ionospheric Faraday rotation was read into the first entry
        in the table for each antenna while the second entry was
        never initialized. This would lead to the Faraday rotation
        being interpolated incorrectly in CGASET. CSLGET, CGASET
        and DATPOL all assume that the IFR is valid at all times;
        the assumption is invalid and more work is required to
        deal with this.
        Moved nowhere.

10053.  October 26, 1998        DATCAL in APLNOT         Chris
        The logical return value DROP was set from ALLBAD which
        was never assigned a value. It is now set from ALLDED
        which indicates that all channels were either previously
        flagged or have been flagged due to bad gain solutions.
        Moved nowhere.

10054.  October 27, 1998           Calibration                Eric
        CSLGET/CGASET had a "feature" that was designed to reduce excess
        computation but which, beginning August 12, caused problems when
        a CL/SN table had large gaps for some of the antennas but not
        all.  The calibration for the good antennas was not updated
        often enough because the update interval was made large by the
        gaps in the "bad" antennas.  Changed the meaning of CALTIM(1,2)
        to be the max lower time and the min upper time over all
        antennas rather than the average IN CSLGET.  Changed CGASET to
        do the computation more often even with this new
        interpretation.
        Needs to go to NEW!

10055.  October 28, 1998          $APGNOT/CLCOR.FOR        Leonia
        When correcting the source position RA correction was given in
        CLCORPRM(5) in arcsec as the RA correction itself without
        recalculation by COS(DECL) to the picture plane. The people
        who took the the desired correction in RA from an image
        shoud devide it by COS(DECL) to convert into actual RA
        correction. It has been found not comfortable. So I implemented
        this division in the codes. The relevant changes are made
        to the HELP file. So now CLCORPRM(5) means correction in
        the RA direction in the picture plane.
        Moved nowhere.

10056.  October 30, 1998          $APGNOT/SPLAT.FOR       Leonia
        For some reason (I do not remember it) SPLAT has not copied
        SU table if there is only one source in the table.
        I removed this limitation.
        Moved nowhere.

10057.  November 3, 1998          $YPGNOT/CONFI.FOR, HLP  Leonia
        The minimum spacing requirement has not worked in the case
        of fixed elements at the outer circle. I fixed it and
        add relevant explanation in HELP file.
        Moved nowhere.

10058.  November 8, 1998         $QPGNOT/FRING             Phil
        Occasionally FRING will fail to converge in a fit. This is not
        a problem unless the user is performing a rate-only fit (usually
        spectral line observers). In this case FRING aborts with a
        floating point overflow because various values of the Hessian
        have not been filled correctly. Modified the code slightly so
        that the matrices are accessed in different ways for different
        types of fitting.
        Moved nowhere.

10059.  November 9, 1998            LISTR                 Chris
        Added code to deal with missing antenna table on the assumption
        that the data comes from the VLA to GANSET (cloned from COLSET).
        Revised the message issued under these circumstances so that it
        doesn't wrap over more than one line.
        Moved nowhere.

10060.  November 9, 1998               XMOM                  Eric
        Instead of destroying the first axis, XMOM now moves it to the
        last axis with 1 point and appropriately changed reference pixel
        and increment.  This allows coordinate pairs and center
        frequencies to be retained.
        Moved nowhere.

10061.  November 9, 1998             GREYS et al             Eric
        Changed GINITG to return an error for grey scale plots that are
        too big for the TV.  Previously it complained but did not quit.
        Moved nowhere.

10062.  November 9, 1998            UVSUB                   Chris
        Inserted a trap for multisource input files in UVSUB.
        Moved nowhere.

10063.  November 9, 1998       MERGECAL procedure           Chris
        Added a procedure (available trhough run file MERGECAL) to
        merge redundant calibration information that has been created
        by concatenating calibration transfer data in FITLD. Changed
        the FITLD help file to refer to this procedure.
        Moved to 15APR98 patch area on March 9, 1999.

10064.  November 10, 1998             FLGIT                   Eric
        Changed:
        1. APARM(4 and 5) now control the multiplication factor of the
        rms for flagging.  They default to 6 and 5, the previous fixed
        values.  The previous use for these APARMs seemed to generate no
        additional flagging.
        2. Added display of the fraction of channels flagged on each
        baseline and improved the computation of when a full spectrum is
        flagged.  The display of the fraction of fully flagged is now
        done only when there are any.
        3. Changed meaning of FLAGVER = 0 from none to highest which is
        the standard default in cal application tasks.
        Moved nowhere.

10065.  November 10, 1998          Tucson references         Eric
        Tucson no longer stores its compilers in non0standard places.
        Changed $SYSUNIX/FDEFAULT,sh, $SYSSUL/CCOPTS.SH, and
        $SYSSUL/LDOPTS.SH.
        Moved nowhere.

10066.  November 10, 1998        DFTPL       Michael Bietenholz / Eric
        The weight was applied wrongly in computing the rms.  Also the
        sum of the weights was used to adjust the rms to the expected
        error rather than the count-1 of samples in the average.
        Moved nowhere.

10067.  November 10, 1998       SPLIT                        Eric
        Changed the number of channels written when frequency smoothing
        to write as many as possible even if the last one does not get
        as many averaged into it.  If DOUVC=-1, as it should with
        channel-dependent weighting, then the weights will take care of
        this partial averaging.  Changed AVGSMO to watch for the upper
        limit.  Previously it averaged one too many output channels,
        reading and writing data potentially outside of arrays.
        Moved nowhere.

10068.  November 11, 1998           BLCAL                    Eric
        Added CMETHOD option to fortran and help file.
        Moved nowhere.

10069.  November 11, 1998        ABOUT files                Eric
        Updated the following about files before putting all in
        LaCook13.tex.
        ZZADVERB.HLP    ZZANALYSIS.HLP    ZZCALIBRAT.HLP
        ZZEDITING.HLP   ZZINTERACT.HLP    ZZOOP.HLP
        ZZPLOT.HLP      ZZPOPS.HLP        ZZPROCEDUR.HLP
        ZZSPECTRAL.HLP  ZZTABLE.HLP       ZZTASK.HLP
        ZZTV-APPL.HLP   ZZUV.HLP          ZZVERB.HLP
        ZZVLA.HLP       ZZVLBI.HLP
        Moved nowhere.

10070.  November 11, 1998      Help files                     Eric
        Deleted some of the obsolete (and now empty) list files from
        many years ago.  Fixed up precursor remarks and categories for
        LPCAL, HISTART, HIEND, FITTP, IMLOD, UVLOD, DOPOL.  Updated the
        affected ZZ files again.
        Moved nowhere.

10071.  November 13, 1998           ZWINC2                     Eric
        It turns out that we have working ZWINC2.* routines only for
        DEC, SOL, and LINUX architectures.  For IBM and HP, the $APLGEN
        version was called and that returned 0 lines.  Changed it to
        return 24, which is a workable number.
        Moved nowhere.

10072.  November 18, 1998       $APGOOP/DTSUM.FOR           Leonia
        DTSUM has not payd attention on subarray. So in the case of the
        overlapping scans with different subarrays DTSUM has included
        numbers tothe both scans without selection of the different
        subarrays. I fixed it. Additionaly I found DTSIM has not worked
        properly if the source IDs do not look like 1, 2,3.. in NX
        table.  I fixed it also.
        Moved nowhere.

10073.  November 19, 1998      $APGNOT/LISTR.FOR            Leonia
        In the "SCAN" option, LISTR has labeled the number of
        visibilities for each scan in the wrong form if the scans have
        different subarrays and were overlapped. I changed it to print
        the start and the end visibility number instead of their
        difference.
        Moved nowhere.

10074.  November 23, 1998           UVINIT                Eric
        The computation of record and word offsets to reach vis = VISOFF
        did not take the > 2 Gigabyte issue into account.  Changed these
        to DOUBLE PRECISION since I do not see a way to do them in
        blocks.
        Moved nowhere.

10075.  November 23, 1998          QCLEAN                Eric
        Restored the testing on clean limit (NITER) to allow the DO3D
        with OVERLAP 0 or 1 to exceed NITER letting each field get a
        full major cycle.  It was not closing things right when it did
        some but not all of the fields in the last round and this is
        better than finding that bug.
        Moved nowhere

10076.  November 23, 1998       $APGNOT/PRTUV.FOR(HLP)     Leonia
        PRTUV carries out additional pass of the data for scaling to
        find the relevant format of print. If the data are large,
        the time for this additional pass can be rather big. (sometimes
        minutes). I implemented the new parameters DPARM which allows
        excluding the automatic scaling forcing the ranges of U, V, W,
        AMP, and WEIGHT. The default is the automatic scaling. On the
        request of C. Walker I added printing subbarray and fqid.
        Moved nowhere

10077.  November 23, 1998            Source selection        Eric
        It is not a good idea to select on sources when copying the CL
        table.  Changed FLGIT and FLGIT to stop doing this.  I guess we
        should leave it in CLSEL in case there is ever a real need for
        it.
        Moved nowhere.

10078.  November 23, 1998            $INC/DTPM.INC          Ketan
        Increased MAXFQD, the number of FQIDs allowed in a simulation
        from 5 to 8.  Also, increased the implicit number of allowed
        antennas from 10 to the value of MAXANT in $INC/PUVD.INC.
        Need to COMRPL DTBAND, DTCALS, DTINDX, DTMATC, DTRC, DTPARM
        and to COMLNK DTSIM and DTCHK.
        Moved nowhere.

10079.  November 23, 1998            $APLNOT/DTPARM         Ketan
                                     $HLPFIL/DTSIM.HLP
        Added easier methods of specifying antenna information in the
        INFILE.  These include methods for easily specifying information
        for individual VLBA and VLA antennas as well as specifying the
        entire VLBA and various VLA arrays at a time using a single line
        in the ANTENNA section of the INFILE. For example,
        STATION='ALL_VLBA' now specifies all 10 VLBA antennas.  See the
        DTSIM.HLP file for more details.
        Moved nowhere.

10080.  November 23, 1998            $QPGOOP/OMFIT          Ketan
        Compilation on a DEC alpha revealed several gotchas.  Some
        floating point constants introduced to prevent division by zero
        were too small and have been adjusted upwards.  An undeclared
        variable was found that affected only the HAL modeltype.
        Another undeclared variable was found that probably slowed
        convergence for the limb-darkening coefficient in the DISK
        model.  Finally, the interpretation of the a priori thermal
        noise [APARM(1)] was fixed up to match the description in the
        HLP file.
        Moved nowhere.

10081.  November 23, 1998            $QPGNOT/KRING           Ketan
        Finally, a simulation to test the multi-band modes of KRING has
        been built using DTSIM.  The numbers entered in the SN table
        were correct but the results reported to the user were not
        properly labelled for SOLMOD='SMBD' [corresponding to
        APARM(5)=2]; in this case, KRING was printing the multi-band
        delay followed by the (single band delay - multi band delay).
        Now, KRING prints the single band delay followed by the multi
        band delay.  The simulation tested the ability of KRING to
        recover the correct solution using a standard frequency setup
        from RDV09, a geodesy experiment spanning frequencies from
        2.22099 to 8895.99 MHz.  Tests of KRING vs FRING confirm
        previous results: KRING runs faster in many cases, uses less
        memory, is able to handle larger problems then FRING.  This
        simulation was also used to test MBDLY to confirm the
        correctness of the multi-band solutions.  KRING got the right
        answer in 14 cases while MBDLY got the right answer in 2 cases
        and either failed outright or produced incorrect answers in the
        other 12 instances.  The results of the simulation are available
        by email to kdesai@nrao.edu.  [An AIPS memo may follow at a
        later date.]
        Moved nowhere.

10082.  November 23, 1998       Calibration routines        Chris
        Introduced support for dispersive delay corrections into the
        calibration routines. Dispersive delay corrections are
        automatically enabled when the values in the DISP 1 column of
        the CL table are not zero. Also revised code handling Faraday
        rotation to cope with blanked entries in the IFR column of the
        CL table and fused three loops at the end of DATCAL to improve
        array access. Note that DSEL.INC now carries wavelegths for each
        channel rather than squared wavelengths as before (squaring a
        number is more efficient than taking its square root). The
        following files were changed.
          DSEL.INC in INC
          CGASET.FOR in APLNOT
          CSLGET.FOR in APLNOT
          DATCAL.FOR in APLNOT
          DATPOL.FOR in APLNOT
          GAININ.FOR in APLNOT
          ORIPOL.FOR in APLNOT
          VLBPOL.FOR in APLNOT
          PCAL.FOR in QPGNOT
          FRMAP.FOR in YPGNOT (to fix a name clash)
        Note that LPCAL and SPCAL ignore Faraday rotation (and probably
        should not).
        Moved nowhere.

10083.  November 23, 1998           PRTUV                       Eric
        The change listed above had several errors - the headers for
        types that did not display subarray and FQid indicated that they
        did, there was no test for the existence of an FQid, and the
        lines were too long.  Cleaned up the format handling and these
        matters.
        Moved nowhere.

10084.  November 24, 1998       R*8 keywords in tables     Eric
        Change all R*4 keywords to R*8 keywords in table headers.
        Fixed:
        GAINI   On write a new table had all the interpolation nodes
                writing messed up.  Probably this is used only on read.
        MCINI   On write a new table had many keyword values in the
                wrong place.  Probably this is used only on read.
        Changed to force R*8 internally even if not externally:
        TABKEY   ANTINI   BPINI    CALINI   GPINI    SNINI
        AGIO     ATIO     BAIO     BCIO     CAIO     CMIO
        FRIO     IMIO     SOIO     CLCAL    IMLOD    UVLOD
        UNCAL    FITLD
        Moved nowhere.

10085.  November 24, 1998         APGPS                 Chris
        Renamed GPSDL to APGPS (APply GPS). Added antenna selection
        adverbs and an option to calculate dispersive delay.
        Moved nowhere.

10086.  November 25, 1998        SOUFIL, SOUFND           Eric
        Both of these had the logic that QUAL and CALCODE modify the
        list of sources selected or deselected.  Changed this so that
        QUAL and CALCODE select a subset of sources and then these are
        selected or deselected on source name.  This means that if
        source names are deselected (SOURCE = '-xxxx'), that a list of
        sources INCLUDED is made of CALCOD or QUAL are non null and a
        list of sources EXCLUDED is made if they are both null.  The
        list is 2500 long which should be adequate.
        Moved nowhere.

10087.  November 27, 1998              FITLD                    Eric
        Messed up TABKEY when it re-wrote a keyword the type code was
        re-used as a loop counter and then stuck into the data record.
        Got is a new loop counter.  FITLD did not die on this error (or
        numerous other ones), so I have added a bunch of IF (IERR.NE.0)
        thingees.
        Moved nowhere.

10088.  November 30, 1998          BPASS                 Chris
        Set DOWTCL true after the call to SELINI so that weights will
        be calibrated when calibration is requested. This should reduce
        the influence of weaker antennae in the least-squares fit and
        improve the quality of bandpasses derived from cross-correlation
        spectra for arrays with large ranges of sensitivity (eg. VLBA
        plus HALCA).
        Moved nowhere.

10089.  November 30, 1998           SNCOR               Chris
        Added an operation to clip by weights (suggested by George
        Moellenbrock).
        Moved nowhere.

10090.  December 1, 1998             ACFIT                      Eric
        This task did not put the correct REFANTs (1 per pol per IF) in
        the SN table.  Fixed it also to use dynamic memory so that it
        can support whatever size averaging problem is thrown at it.
        Previously it blithely ignored the possibilities of having more
        than 4 IFs and 1024 channels.  It also messed up the number of
        samples when copying to the output buffer.
        Moved nowhere.

10091.  December 1, 1998             FITLD                      Eric
        In attempting to have FITLD actually pay attention to error
        returns I messed up the sign of the comparison and so failed to
        reopen the AN file for writing.  This then caused AT2AN to fail
        and the job to die.
        Moved nowhere.

10092.  December 1, 1998               POSSM                     Eric
        Changed error message on IERR=-1 from UVGET (INIT...)
        Moved nowhere.

10093.  December 2, 1998             CVEL                      Chris
        Removed an unused leap-second function (IAT) from CVEL.
        Moved nowhere.

10094.  December 4, 1998             BP cal                      Eric
        removed the subtraction of 1.0 for parallel hand
        autocorrelations in the bP application code.  This assumes that
        the AC data are around 1 (usually the case but not exactly) and
        this causes apparent non-circularities in the various cal
        apoplications.
        Moved nowhere.

10095.  December 4, 1998      Map size parameterize              Eric
        Created PMAD.INC to parameterize the maximum image size and the
        correspnding buffer sizes.  MAXIMG is set to 16384, MABFSS is
        set to this also and MABFSL to 4 times this.
        Changed:
        DBUF.INC    Include PMAD, set buffer accordingly, drop RMAX and
                    RMIN (never used)
        MAPIO       Drop RMAX, RMIN never otherwise referenced
        DTCIO.INC   Include PMAD and use to set buffers.
        MAKMAP      Drop equivalence to polarization array, raise buffer
                    size to 4*MABFSS and use a 2nd buffer size indicator
                    to get the most out of our buffers.
        OLDMAP      Drop equivalence and raise buffer size.  The
                    routines used by OLDMAP all require 3 buffers so the
                    last trick above does not work.
        Changed to use PMAD to set limits & buffers:
        AU1A     AU2      AU5A     AU5D     AU6D     AU7      IOSET
        WRBLNK   WRPLAN   ARRAY    CXIMAGE  CXUTIL   INTERPLATE
        QCLEAN   QIMAGE
        Changed formats
        AU5
        Moved nowhere.

10096.  December 4, 1998          size bugs                 Eric
        In researching the image size business, fixed:
        AFILE   Used 8192 for a 256-word buffer
        DECOR   Used 8192 for 3*MAXCIF uv data buffer.
        LISTR   Used 3,8192 for 3,MAXCIF uv data buffer.
        MSORT   Used 8192 for 512 word buffer
        OTFUV   Used 8192 rather than MAXCHA to set default upper limit.
        TBIN    Used 8192 buffer where only dummy needed; used MAXCHA
                where MAXCIF would be more correct.
        TBOUT   Used 8192 buffer where 2 words would have been enough
                and used XBPRSZ where MAXCIF would do.
        TFILE   Used 8192 buffer where 256 words would do.
        UV2TB   Had unused JBUFSZ, used 8192 where 3*MAXCIF was needed,
                and used 8192 where 3+MAXCIF was needed.
        UVFLG   Used 8192 for max source where XSTBSZ would do.
        UVLOD   Used 8192 in testing for data too large although the
                buffers will now hold UVFBSS and added test of NCOR <
                MAXCIF.
        Moved nowhere.

10097.  December 4, 1998       PMAD.INC                  Eric
        Changed to use PMAD to set buffer size
        DPLT.INC
        CCNTR   CNTR    GREYS   IMEAN   IMVIM   ISPEC   PCNTR
        PROFL   SERCH   TVHUI   TVRGB   IRING   KNTR    PFPL1
        PFPL2   PFPL3   PLCUB   PLROW
        Changed image I/O and:
        BLANK    Rearranged declaration of buffers as well.
        BLSUM    Rearranged declaration of buffers as well.
        GAL      Raised buffer from 1024 for row length.
        IMLHS    Raised buffer from 512 for displayed row length.
        No image I/O change, but changed:
        IBLED    Removed MINIT from a comment.
        SPFLG    Removed some 16384's from comments
        TVFLG    Removed some 16384's from comments
        Moved nowhere.

10098.  December 4, 1998         FRING                 Eric
        FRING set up a priority array for antennas in the initialization
        routine.  Then it used it in the fitting routine to set baseline
        pointers and then re-arranged the list for another purpose.
        But, the main routine can loop over subarray, so this
        rearrangement cost dearly.  Added a save and restore for this
        priority array so that the looping will work.  Also added
        controls so that a subarray in the loop with no data will not
        cause it to die abruptly.
        Moved nowhere.

10099.  December 7, 1998      More PMAD.INC               Eric
        Added PMAD.INC to control buffer and image sizes in
        AHIST   COMB    CPYRT   HISEQ   PBCOR   PRTIM   REMAG   SAD
        SDMOD   SQASH   STFND   SUBIM   SUMIM   TAFFY   WTSUM   XSUM
        APGS    APVC    STEER
        Made further changes as well in:
        MCUBE  Routine PLNWRT for very small output images could not
               have worked since it treated inputs as if they were
               integer images (!)
        TRANS  Made things all explicitly floats and parameterized the
               very large buffers in this task.
        XBASL  Made all buffers floating, dropped equivalence
        XGAUS  Ditto
        XPLOT  Ditto
        XSMTH  Corrected limit to 2048 hidden in code and removed silly
               equivalences.
        APCLN  Changed to use POWER2 and parameter MAXIMG to test for
               legal powers of 2.
        RSTOR  As APCLN.
        MX     Replaced non-standard definition of UVBFSS and made
               change to POWER2 as well.
        SDCLN  As APCLN.
        UVMAP  As APCLN.
        IMAGR  Changed only the upper limit to be MAXIMG.
        WFCLN  Changed only the upper limit to be MAXIMG.
        Made only cosmetic changes:
        UTESS   VTESS
        Moved nowhere.

10100.  December 7, 1998            AIPS                   Eric
        Changed AU1A and AU2 so that more adverbs will get tested with
        system limits rather than with the limits in the inputs files.
        Things like IMSIZE, CLBOX, ECHAN, etc were added to the lists.
        Moved nowhere.

10101.  December 7, 1998        COMB, SUBIM                    Eric
        Changed them to save fully blanked images as well as other
        constant ones.
        Moved nowhere.

10102.  December 8, 1998            FLATN                   Eric
        Added the adverb EDGSKP to have FLATN skip pixels around the
        edge of each field (BLC/TRC do not work since the fields can be
        different sizes).  Also parameterize image size in FLATN.
        Changed POPSDAT.HLP and DDTLOAD.001 to make EDGSKP a regular
        adverb rather than a special DDT one.  Upgraded the EDGSKP help
        file.
        Moved nowhere.

10103.  December 8, 1998         Image size param           Eric
        Inserted PMAD.INC into:
        IMTXT   PASTE   CONVL   DSDG.INC   SDIMG   IM2UV   DCONV
        GLENS   IMLOD   IMMOD
        Inserted PMAD and cleaned up buffering:
        BLWUP   CANDY   FETCH   IMFIT   IMFLT   IMLIN   JMFIT
        Minor typing changes:
        BSMAP   FITLD
        CONVL   Fixed buffer size and 2 limits to 4096.
        FFT     Fixed buffer sizes and changed NX, NY tests to use
                POWER2 and parameters
        GRIDR   Clean up buffer management which was a mess of small
                buffers and equivalences.
        HORUS   Fixed image size tests to user POWER2, fixed buffers
                from 4096, clarified buffer assignment.
        LPCAL   Remove unused references to MINIT and MDISK.
        Moved nowhere.

10104.  December 8, 1998            FITLD                   Eric
        I missed the critical place where various parameters were
        from the keywords BEFORE they are put into the aips
        tables.  It did not show up in grep's.  This caused scaling,
        refpix, etc to be off.
        Moved to the AOC and MPI today.

10105.  December 9, 1998             FITLD                  Eric
        I did not get yesterday's fix correct.  I think it is right
        now.
        Moved to aoc and mpi today.

10106.  December 9, 1998             POSSM                  Eric
        Found a hard-coded bug in computing the bandpass from CPASS
        coefficients causing it to write at addresses just before the
        bandpass array.  This then caused the start channel to go nuts
        etc.
        Moved nowhere.

10107.  December 9, 1998       FFT Q routines               Eric
        Fixed array declarations in QCFFT, QRFFT, QXFOUR to be large
        enough for the new image max size.
        Moved nowhere.

10108.  December 9, 1998             TAPES                  Pat
        New verb that shows the printer definitions.  It queries the
        value of NAIPST to see how many tapes there are, then parses
        fields in the TPDEVS.LIST file and produces a list similar to
        what you see on AIPS startup.  It will be possible to enhance
        this verb to accept the REMHOST adverb in the future, and try to
        list the tapes for a remote host (assuming said remote host is
        listed in TPDEVS.LIST).
        Moved nowhere.

10109.  December 10, 1998             PMAD more                 Eric
        Simply added pMAD.INC to set row and buffer sizes to:
        MANDL   MATHS   PADIM   POLCO   REGRD   RGBMP   RM      SHADW
        SKYVE   SLICE   SMOTH   SUMSQ   UVIMG   WARP
        Also changed:
        MODVF   Parameterize not only the buffer, but also the output
                image size and the number of rings it can handle.  Aded
                correct tests for overflowing these.
        MOMNT   Parameterize row length out and allow up to 1024
                channels (it was limited to 256 with no meaningful
                message to say why it quit).
        Rearrange buffers and equivalences as well as parameterize:
        MWFLT   NINER   NNLSQ   PATGN
        Moved nowhere.

10110.  December 11, 1998           PBUTIL                  Eric
        The component subtraction routine squirreled away all the image
        names for safekeeping and should have done so for all fields.
        Unfortunately, it did it for only 1 field in the 1 at a time
        mode and so caused nasty things to happen.
        Moved nowhere.

10111.  December 11, 1998          UVGET                    Eric
        Changed it to check for a FG table before getting mad about
        DOFLAG with a non-time sort order.
        Moved nowhere.

10112.  December 14, 1998          AXREF limits              Eric
        Fixed the limits on AXREF for ALTDEF, AXDEFINE, and MCUBE.  The
        1st two have no absolute limits, the last has 16384 or so.
        Moved nowhere.

10113.  December 14, 1998           TABED                   Eric
        Converted the KEYVALUE to integer without examining the data
        type.  Then, when the the value was 10**10 (a frequency) it
        overflowed computing a value it did not need.  Added tests.
        Moved nowhere.

10114.  December 14, 1998           AIPSC                   Eric
        The CU2 version of AU2 was way behind in the list of system
        adverbs and had a bug causing GO tests to fail if there was > 1
        GO in the job.
        Moved nowhere.

10115.  December 15, 1998           EPOSWTCH                 Eric
        The pointing position was not done, only the reference position.
        Added code to fix this oversight.
        Moved nowhere.

10116.  December 15, 1998          FLATN                    Eric
        Changed INTERPLATE to add a method INTWIN to determine the
        window in the output image influence by the input (smaller)
        image.  Changed call seq of IMGHGE in INTERPLATE to give the
        x-axis limits for computing since the whole row must be written
        (and blank filled).  Changed FLATN to init the output and weight
        files and then to use INTWIN in the loop of fields.  It also
        checks for full 0 or blanked images and skips them.  This makes
        things faster.  Changed OHGEO for change to IMGHGE.
        Moved nowhere.

10117.  December 16, 1998             PADIM                Eric
        It ignored the presence of > 1 plane!  Changed it  to loop over
        planes.
        Moved nowhere.

10118.  December 16, 1998            TRANS                 Eric
        A logic error in setting the depth in the x-y transpose routine
        was exposed (after > 10 years I suppose) by a cube that started
        as an N x M x 1 x 1 x K x 1 going to K x N x M x 1...  It worked
        fine in the usual cases even though it was in principal wrong.
        Moved nowhere.

10119.  December 16, 1998     UVCON.FOR, .HLP                Leonia
        This new task generates a u-v database for an interferometric
        array whose configuration is specified by the user. Visibilities
        corresponding to a specified model, and gaussian noise
        appropriate for the specified antenna characteristics are
        calculated for each visibility.  The output is a standard AIPS
        u-v data file. This task replaces the old procedure which
        required use of the AIPS tasks UVSIM, UVSUM, UVMOD and verb
        PUTHEAD. The array geometry can be specified in three different
        coordinate systems: equatorial, local horizon, and
        geodetic. There is an option of using set of different
        frequencies to improve UV coverage.
        Moved nowhere.

10120.  December 17, 1998       LIBR script in SYSUNIX      Chris
        Prevented LIBR from calling lorder on SGI machines, where it
        does not exist. This appears to have lead to some unreported
        problems with the midnight job.
        Moved nowhere.

10121.  December 17, 1998            BPINI                  Chris
        The KEYVAL/KEYVAR array was declared too small for its contents
        causing the keyword types array to be overwritten on SGIs.
        Moved nowhere.

10122.  December 18, 1998             OHGEO                  Eric
        I made changes for the changed call seq to IMGHGE in INTERPLATE.
        Unfortunately, I messed up the order of these simple changes
        making it abort on take off.
        Moved nowhere.

10123.  December 18, 1998            FITLD                    Eric
        Corrected the task to check the requested BIF, EIF, BCHAN, and
        ECHAN and to use them only if they are reasonable.  It happily
        used BIF 5; EIF 12 on a 2-IF input data set finding its data,
        table values, etc somewhere!  Also fixed it to adjust the REFPIX
        for BCHAN and to put the new NOCHAN and NOBAND and REFPIX in the
        tables.  It went to some real effort to put the old values in
        the tables while some really clever code managed to build the
        tables correctly for the selected IFs.
        Moved nowhere.

10124.  December 21, 1998           $APGOOP/MBDLY             Ketan
        As part of my exhaustive check-out of KRING in its various
        modes, I discovered that MBDLY was hard-wired to only use
        FREQID=1 and SUBARRAY=1.  I have now introduced FREQID and
        SUBARRAY to MBDLY.
        Moved nowhere.

10125.  December 22, 1998           $QOOP/QEDIUTIL            Ketan
        In the expert mode of EDITR, introduced a default action to be
        taken when the user enters return without pressing any other
        keys.  Now, the default action is to repeat the last action - on
        initial entry to the expert mode, the default action is to exit
        immediately.

10126.  December 22, 1998          $QPGOOP/OMFIT              Ketan
        Fixed many minor bugs revealed during recent testing and usage.
        The processing of multiple source models was falling down when
        one source was explicitly chosen [revealed by OMFIT test suite].
        A bug in the processing of the GAIN adverb, introduced in the
        last change, has been discovered and is now fixed [revealed by
        the OMFIT test suite].  The map noise estimate formula was coded
        incorrectly [missing square root] - it still seems a bit fishy
        though...].  Data from the ATCA revealed deficiencies with the
        processing of FQ-less files.  APARM(8) was broken and was just
        sending the input visibilities to the output file.  A new
        component, a 'CORE' model-type has been introduced; this is a
        point source with a flux spectral index.  This model-type was
        introduced so that results from 'mfclean' in miriad could be
        tested in AIPS.  'YCORE' is implemented as well.  Both seem to
        have worked when used with real data from the ATCA.
        Moved nowhere.

10127.  December 22, 1998           INCS.SH                Eric
        The SYSSUL version of INCS.SH referenced INCSOL rather than
        INCSUL as it should.
        Moved nowhere.

10128.  December 22, 1998           APCLN                  Eric
        There was an equivalence at buffer(4097) that escaped greps.
        This was fine so log as buffer was small enough, but when I made
        it bigger the RA's overran the Decs in component restoration or
        removal.  Also did SDCLN and RSTOR.
        Moved nowhere.

10129.  December 22, 1998           UVPLT                  Eric
        Fixed an unfortunate choice of LUN.  Using any LUN 31-39 in now
        illegal on some machines.
        Moved nowhere.

10130.  December 22, 1998          INTEGER*2              Eric
        Compilers are messing up again on I*2.  Changed the declaration
        in $APLGEN/ZADDR.FOR and $APLUNIX/ZADDR.C to drop the *2 from
        the INTEGER and call them char *'s in the C.
        Changed:
        ZADDR     $APLGEN - alter declaration to INTEGER
        ZADDR     $APLUNIX - alter declaration from short int to char
        ZBFLIP    $APLGEN - new routine to call ZBFLI2 with the flip
                  parameter from the Fortran common
        ZBFLI2    $APLUNIX - new C routine does all 4 values of BYTFLP
                  from a simple copy to all the word swaps and does it
                  for buffers of 2-, 4-, and 8-byte values
        ZR32RL    $APLGEN - drop I*2s, call ZBFLIP.
        ZI32IL    $APLGEN - drop I*2s, call ZBFLIP.
        ZR64RL    $APLGEN - drop I*2s, call ZBFLIP.
        ZRLR32    $APLGEN - drop I*2s, call ZBFLIP.
        ZILI32    $APLGEN - drop I*2s, call ZBFLIP.
        ZRLR64    $APLGEN - drop I*2s, call ZBFLIP.
        Moved nowhere.

10131.  December 28, 1998             GRBOXS                    Eric
        Split slice setting into a separate subroutine GRSLIC, dropping
        it from GRBOXS and DRBOXS.  Changed DRBOXS to plot boxes that
        fit only partially on the TV image and to return IERR=-1 for
        these and IERR=-2 for ones that don't fit at all.  It uses
        INTEDG to compute all this.  Changed GRBOXS to allow resetting
        only of the boxes that are fully on the displayed image while
        keeping the other 2 categories fixed.  Changed AU5C to use
        GRSLIC for TVSLICE and to send in all boxes on FILEBOX.  This
        keeps them in the same numerical order which may be useful for
        memory and record keeping.  Fixed limits and comments in the
        help files for TVBOX, REBOX and FILEBOX.
        Moved nowhere.

10132.  December 28, 1998          IMAGR                          Eric
        Changed:
        INTEDG     to fix bug when all 4 coordinates are outside the
                   BLC-TRC area.
        TVDEVICE   1. to call GRSLIC where appropriate rather than
                      GRBOXS and to issue better messages after it
                      finishes.
                   2. to reset the status when the window size is
                      made to or is found to have changed
        QCLEAN     1. to allow OVERLAP 2 without requiring DO3DIM
                   2. to compute the average absolute value in the
                      windows  and to have OVERLAP=2 use 0.9*max+0.1*avg
                      to select the next field to clean.  This prefers
                      larger structures to single high points.
        IMAGR      $HLPFIL: to allow OVERLAP 2 without requiring the 3D
                   imaging option.
        Moved nowhere.

10133.  December 28, 1998              SNPLT                     Eric
        Changed the meaning of CUTOFF.  Weights <= CUTOFF are not
        plotted when CUTOFF >= 0.  Thus CUTOFF=0 plotsd only good data.
        Plotting bad data with Xs rather than +s was not good enough
        apparently.
        Moved nowhere.

10134.  December 28, 1998              ACFIT                     Eric
        Found a hard-coded 0 divide if the template file has no data for
        the specified REFANT.  Added test and message.
        Moved nowhere.

10135.  December 30, 1998       VPLOT.FOR                     Leonia
        The reference frequency has been used for U,V,W in the case
        of positive NMAPS (U,V,W are taken from the data). It has
        brought an error in the model calculation which is visible
        in the case of multifield model with large distance between
        field.  The scaling of the U,V,W being foreseen has not worked
        actually.  The scaling is done for the mean (of selected)
        channel and the first selected IF. The relevant warnings are
        added.
        Moved nowhere.

10136.  December 29, 1998            ZIPAC2                 Eric
        I thought I had tested this extensively!  But it failed on in
        place ZI16IL's, blowing the TV code out of the water.  Changed
        it to use a temp variable.
        Moved nowhere.

10137.  December 29, 1998           YCREAD                 Eric
        This $YSS routine did not set IERR if it worked!  So in loops
        where it failed to find anything on the 1st plane, it failed to
        report its success on the 2nd plane!
        Moved nowhere.

10138.  December 30, 1998          XAS                     Eric
        Found a bug that was bothering me: in shared 8-bit mode the
        image memories were not fully cleared by init and clear
        operations.  This turns out to be from bytes_per_line not being
        SCREEN_WIDTH in this case.  Changed the init code to use the
        same method of finding bytes_per_line as the image access
        code.
        Moved nowhere.

10139.  January 1, 1999    $YPGNOT/IRING.FOR, .HLP       Leonia
        The collumn of sigma is added to the printing table on
        request Rick Perley. The default for the ellipces center
        is changed from the map bottom left corner to the map
        center.
        Moved nowhere.

10140.  January 1, 1999         UVCOP                     Eric
        It was ignoring channel/IF selection when testing data weights
        and flagging.  If an IF that was not to be copied was good, then
        the fully flagged IFs were copied.  Also made it test for
        flagging or high enough weights in compressed data.
        Moved nowhere.

10141.  January 2, 1999        CLCAL                      Leonia
        The setting of CUTOFF has been added to the History file.
        Moved nowhere.

10142.  January 2, 1999     $APGNOT/OTFUV                 Leonia
        The was a misprint in printing BCOUNT, ECOUNT in the History
        file.  It's fixed.
        Moved nowhere.

10143.  January 3, 1999                  IMAGR                  Eric
        Fixed:
        QCLEAN   The recent fix caused it to ignore the request to
                 re-make all images on OVERLAP 2.
        Moved nowhere.

10144.  January 3, 1999           SPLIT                  Eric
        Added code to keep track of the time order and to mark the
        header as unsoretd only if it is.  Before, any appending of
        subarrays caused it to be marked as unsorted.

10145.  January 3, 1999           SETGDS                 Eric
        SETGDS marks the Clean images as being in the READ status and no
        one comes along to undo that!  In programs that loop over IF,
        subarray, or whatever with a significant number of fields, the
        128 limit on NCFILE is easily blown.  Changed:
        SETGDS   Fix message and make it test NCFILE properly.
        UVGET    Fix message (referred to SDGET)
        UNSETG   New routine to unset the read status and reduce NCFILE
                 if possible.
        Changed to call UNSETG: CALIB  PCAL  LPCAL  KRING  CPASS  BPASS
        UVSUB  UVADC  BLCAL  FRING  UVCON  IBLED  VPLOT  CLPLT.
        Moved nowhere.

10146.  January 3, 1999        Gridded subtraction          Eric
        The Q routine that does the interpolation and subtraction
        expects the W term of the filed position to be scaled to the
        first channel.  It even says this in its precursor comments.
        Unfortunately, it appears that ALGSUB and ALGSTB have never
        honored this request.  Therefore, the W term was done
        incorrectly if the first channel was not at the reference
        frequency.  If the first channel was at the reference frequency,
        then multi-channel subtractions were done correctly.
        Fortunately, this is at some level a second order affect since
        it is in the W correction and in the (delta freq) / freq0, but
        it was enough to make my test case diverge.  That case had a
        model object 3450 arcsec from the field center with cells of 2.9
        arc sec and a beam around 10-13 arc sec which was based on a
        real case presented by Bill.
        Moved nowhere.  This must be a patch and an announcement.

10147.  January 4, 1999           PBUTIL                   Eric
        Changed POSITION to add a method to convert an arc-sec offset to
        an angle from the pointing position.  The method is public and
        call PSNANG.  Changed PBUTIL to use this method - previously it
        was doing a more linear computation that ignored the fact that
        the reference pixel and the pointing position may not be the
        same (esp in DO3D imaging).
        Moved nowhere.

10148.  January 6, 1999           K2TEXT                      Eric
        Fixed it to not put close quotes on lines.  With close quotes,
        lower case POPS strings became all upper case on COMPRESS.
        Movedd nowhere.

10149.  January 6-7, 1999            IMAGR, SCMAP                Eric
        Changed:
        AU6        Pull scroll from AU6 to TVSCRL.
        TVSCRL     New - does interactive TV scroll
        TVDEVICE   Add OFFS and SCRO operations to TVDFUN to do off
                   scroll and interactive scroll.
        TVUTIL     Make utility interfaces OTVOFS and OTVSCR to the
                   TVDFUN operations.
        QCLEAN     Call OTVOFS to turn off scroll.  Add code to write
                   OBOXFILE if REBOX or TVBOX and to allow TELL to
                   change the OBOXFILE.
        SCMAP      Call OTVOFS to turn off scroll.  Changed TV loading
                   code in self-cal TV to allow an image window not
                   including all Clean boxes.  Added code to write out
                   the WINDOW if OBOXFILE is set and REBOX or TVBOX are
                   used.  Added the adverb to help and task inputs and
                   its CLEAN object.
        IMAGR      Added OBOXFILE adverb.
        POPSDAT    Add adverb OBOXFILE.
        NEWPARMS   Add adverb OBOXFILE.
        OBOXFILE   New help file
        WINDF      New subroutine pulled from IMAGR
        FIELDF     New subroutine pulled freom IMAGR
        Moved nowhere.

10150.  January 9, 1999            ZIPAC2                      Eric
        Still trying to get this right.  Changed all "char" to "signed
        char" since IBMs treat char as unsigned.  All IBM tasks should
        be relinked but I am not going to relink everything for the
        mnj.
        Moved nowhere.

10151.  January 10, 1999          RUN files                     Eric
        Changed $APLGEN versions of ZTOPEN and ZTXMAT to allow RUN files
        with user number 1 as well as with the user's number in area
        VERSON when VERSON is not one of the standard ones (it uses
        RUNSYS when VERSON is a standard one).  Also modified the quaint
        help file for RUN although I did not try to change the detailed
        description of SOS in editing a RUN file!
        Moved nowhere.

10152.  January 11, 1999           FITLD                       Chris
        Addressed a number of issues that were found while examining
        FITS-IDI data from DRAO.
        - The correct SOURCE_ID column label is now recognized in the
          UV_DATA table. Previously FITLD expected the incorrect
          heading SOURCE ID that was produced by the VLBA correlator.
          This old label is still recognized to support legacy data.
        - Antenna characteristics (ANTENNA) tables are no longer
          required in FITS-IDI file. Antenna polarizations will not
          be labelled if these tables are missing and a warning message
          will be produced. Memo 102 does not require antenna
          characteristics tables to be present and they contain little
          useful data.
        - Data is no longer discarded if it is out of time sequence in
          a UV_DATA table (DRAO data was in BT order). Data out of time
          sequence is now noted and treated in the same way that
          multiple integrations were before. Out of order day numbers
          will still cause problems. Memo 102 does not require T*
          ordering.
        Also fixed some miscellaneous problems.
        - Removed 10 kHz rounding of antenna table reference frequency
          in AG2AN.
        - Ensured ANNCAL is set to zero before it is used to set the
          number of polarization calibration parameters for a new table
          in AG2AN (it could have been used without being initialized).
        - Removed code that used an uninitialized variable to set the
          FREQID keyword in an AN table from AT2AN.
        Moved nowhere. Should go to 15OCT98 patch area after further
        tests.

10153.  January 14, 1999        VPLOT                        Leonia
        Plot the model at each data sample (NMAPS>0) has worked only
        for SOLINT=0. I modified VPLOT to exclude this limitation.
        If SOLINT>0 U,V,W are calculated as average value of the samples
        of the average interval.
        Moved nowhere.

10154.  January 19, 1999        CGASET in APLNOT             Chris
        CGASET does not refresh the interpolated calibration values if
        the time for which calibration is required differs from that for
        which the last interpolated values were calculated is smaller
        than a given fraction of the time span between the values to be
        interpolated. The logic for this test ignored the possibility
        that the values to be interpolated between might have changed
        since the last interpolated value was calculated. This could
        lead to stale calibration values being used at the ends of scans
        (if the gap between scans was sufficiently large the difference
        in time between the last data point in a scan and the previous
        one could be a small fraction of the gap even if it was a
        similar size to the spacing between calibration values within
        the scan. Modified CGASET to force new interpolated calibration
        values to be calculated whenever the values to be interpolated
        between change.
        Moved nowhere.

10155.  January 20, 1999          LDGPS                   Chris
        Expanded longitude range from 0 to 360 to -180 to 360 degrees.
        Added some missing calls to MSGWRT.
        Moved nowhere.

10156.  January 20, 1999             FLGIT                 Eric
        Corrected the call sequences to IMSEL, MCSEL, and PCSEL which
        were changed for UVCOP in August, but forgotten in FLGIT.
        Moved to patch area.


10157.  January 21, 1999         UV table tapes            Eric
        Wrote FITAB.  It does two new and dangerous things.
        1. For images it can apply the integerization based on a least
           bit flux provided by the user
        2. For uv data, it writes tables of uv data rather than random
           groups.  There is the option to write compressed uv data
           (like on disk) and to break the operation into multiple
           output files, each covering a specified time interval.
        Other changes so far:
        NPIECE    New adverb help file.
        QUANTIZE  New adverb help file.
        POPSDAT   Add NPIECE, QUANTIZE
        NEWPARMS  Add NPIECE, QUANTIZE
        DFUV.INC  Added Table keywords as well as random parameter
                  keywords and piecemeal uv parameters.
        VFUV.INC  Added Table keywords as well as random parameter
                  keywords and piecemeal uv parameters.
        FPARSE    Fixed to handle the extra words properly.  The data
                  loading tasks will need these fixes too.  Changed call
                  sequence.
        CHPACK    Like REFRMT except that it removes all blanks from a
                  string.
        PRTTP     Added the option to read disk files and to do ADVF
                  rather than read long tape files on PRTLEV=-4
                  (otherwise like -3).  Fixed it to recognize the new UV
                  format and make an intelligent display.
        ZGDATE    New dummy APLGEN and real APLUNIX routines to return
                  the current date at Greenwich.
        MSGHDR    Fixed the pixel-length descriptions to be more
                  readable, making the same change in PRTTP.
        ZTPOPN    $APLGEN - removed a bunch of blank lines
        ZTPOPD    $APLGEN - had it check MSGSUP and honor 32000 to
                  suppress the naming of the file it is trying to open.
        AU4       Add attempt to open INFILE with a "1" appended if
                  INFILE not found.
        TPHEAD    Add info the HELP file re this INFILE handling.
        FITTP     Changed to call ZGDATE to meet standards and fixed the
                  addresses of the weights for DOSTOKES true UPOL
                  output.  Also changed it to stop putting out magic
                  values when the Stokes conversion fails.  It should
                  put out 0 for the vis as well as the weight.
        UVLOD     Fixed regular data reading section to change magic
                  blanks into 0 with 0 weight.  Added adverb NPIECE and
                  quiet attempt to open INFILE and INFILE with a 1.  Add
                  looping for uv tables and read of uv tables.
        RUVTAB    New - reads uv table data to uv file.
        TABKEY    Fixed to set IERR to 0 at start and to exit quickly if
                  NUMKEY <= 0.
        Moved nowhere.

10158.  January 21, 1999              FITLD                   Chris
        Prevented FITLD from overwriting the saved values of NOBAND
        and NOCHAN that are written to table headers. The unmodified
        values must be written to tables in order that calibration
        transfer and concatenation work with IF selection in effect.
        Moved nowhere.

10159.  January 21, 1999              CCBOX                  Chris
        Removed CCBOX (which is given in arcsec and has no limits)
        from the system adverbs lists in AU1A and AU2. Corrected
        the description of CCBOX in CCBOX.HLP.
        Moved nowhere.

10160.  January 21, 1999         GETSIP in APLNOT            Chris
        Added protection against the sine of the azimuth falling
        out of range near +/- 90 degrees due to finite precision
        arithmetic.
        Moved nowhere.

10161.  January 22, 1999            FITLD                   Eric
        Added the UVLOD uv-table reading changes to FITLD.  The
        resetting of name parameters (when OUTNAME was given) has been
        changed so that only OUTSEQ is set to 0 and the others are reset
        back to the input adverbs.  Also changed:
        IMLOD   To handle the changed error returns from MAKTAB and to
                close tables on error
        TBIN    To handle the changed error return from MAKTAB.
        Moved nowhere.

10162.  January 22, 1999         UVPOL                    Eric
        Changed it to omit all samples which do not have at least one
        good cross-hand observation.  The doubly flagged times were
        affecting the imaging through uniform weighting and sum of
        weights.
        Moved to Japan.

10163.  January 27, 1999           SPLAT                  Eric
        SPLAT also was not updated for the changed call sequence of
        IMSEL and MCSEL.  Added calls to CQSEL and PCSEL and changed it
        to not copy SU tables to output single-source files.
        Moved nowhere.

10164.  January 27, 1999           UVAVG                  Eric
        Fixed it to expand the file if it writes more than expected
        rather than dying.
        Moved nowhere.

10165.  January 27, 1999           PCLOD                  Chris
        Phase cal amplitudes in VLBA log files are percentages. Changed
        PCLOD to divide the amplitudes by 100 to be consistent with
        direct cal transfer.
        Moved nowhere.

10166.  January 27, 1999          FITLD                   Chris
        Protected calls to MAPCQI and CORID with tests on DELCOR.
        Without these tests FITLD would die of unnatural causes when
        appending to an existing file with delay decorrelation
        corrections turned off. FITLD was trying to read a CQ table in
        circumstances where one does not exist.
        Moved nowhere.

10167.  January 27, 1999              USUBA                  Eric
        Changed OPTIMIZE.LIS to avoid optimizing USUBA on HPs.
        It worked more or less but could not tell that time ranges
        overlap...
        Moved nowhere.

10168.  January 29, 1999            CVEL                     Eric
        Changed the smoothing option in CVEL to require APARM(9) > 1 for
        smoothing cross correlation spectra, > 0 for autocorrelations.
        Modified XCSHFT to avoid excess multiplies when not smoothing.
        Corrected ACSHFT to use the average autocorrelation value rather
        than 1 for frequency NFREQ+1.  Use of 0 for spectra that do not
        average 0 introduces ringing from the high frequency end of the
        spectrum.
        Moved nowhere.

10169.  February 2, 1999           FITLD                    Chris
        Modified AT2AN to reset the AT table row number when looping
        over subarrays.
        Moved nowhere.

10170.  February 2, 1999           FITLD                    Leonia
        Changed the action of WTTHRESH (C. Walker request). The old
        scheme was that, if any IF has a weight below the threshold, the
        whole record is flagged.
        Now if weights for all IFs are =< WTTHRESH the visibility record
        is not recorded.
        If a weight of some IFs (not all) =< WTTHRESH such a visibility
        is recorded but the weight of these IFs put to zero.
        Moved nowhere.

10171.  February 2, 1999         FITLD, UVLOD               Eric
        Reading an old INTEGER*2 UV-data FITS tape (!!) a bug in the
        size of the integer buffer appeared.  It is not 720 but 1440 to
        hold all the words after ZI16IL.
        Added more tests on MAKTAB outputs as well to FITLD's image
        part.  IMLOD was already okay.
        Moved nowhere.

10172.  February 2, 1999            PRTTP                  Eric
        Made 2 minor changes affecting PRTLEV=-4: Fixed it to set
        DOCRT=-1 so that a progress message will appear and fixed it to
        avoid duplicating entries in the output text file when it does
        skip a file.
        Moved nowhere.

10173.  February 3, 1999           INSTEP1                 Pat
        Added a section to allow a user to configure a local version of
        the XHELP cgi perl script.  In general doing this from within
        INSTEP1 requires write access to the cgi area, something that is
        probably unlikely.  However, the section should at least alert
        people that the capability is there.  This shell segment needs
        tested (but I always get to test it anyway at each release).
        Moved nowhere.

10174.  February 4, 1999           FITLD                   Pat
        Discovered that when a FITS disk file is too short (not padded
        out to a multiple of 2880 bytes), the message from FITLD is
        rather obtuse.  Added detection of IERR=4 (end-of-file) and a
        more understandable error message.
        Moved nowhere.

10175.  February 5, 1999           ZMOUN2 (Linux)          Pat
        If an error occured during the MOUNT process, this routine did
        not close the tape device, resulting in a lockout until the
        process (AIPS) terminated.  Put in code to close the device on
        all relevant error branches.
        Moved to the AOC this date.

10176.  February 10, 1999               TAPES                  Eric
        Changed:
        AU4      To pick up REMHOST and send it to TAPSHO
        TAPSHO   To remove Fortran errors and infinite loops, to have it
                 search the local tape list for REMHOST (or the local
                 machine by default) and then to call ZRMTAP if none
                 found.  The parsing and listing follows this.
        ZRMTAP   APLGEN: new - opens the remote TPMON as if for a disk
                 file and expects back 2880 bytes of tape info.  It
                 sorts this into an output set of strings and closes the
                 remote.
        TAPES    Added REMHOST.
        TPMON    Trap the file name on ZTPOPN and call ATPSHO rather
                 than ATPOPN and added ATPSHO which is similar to TAPSHO
                 without the remote host and the actual display.
        Moved nowhere.

10177.  February 17, 1999            FITLD                   Chris
        The subroutine GET3DT assumed that the ARRAY column in UVDATA
        tables contained a filter number (presumably a historical
        oddity in VLBA data at some point) with the result that
        subarray numbers were discarded if they were explicitly assigned
        in the incoming data. FITLD now assumes that the ARRAY column
        in a UVDATA table is a real subarray number for arrays other
        than the VLBA and turns off automatic subarray allocation if
        the array number is not zero.
        Moved nowhere.

10178.  February 17, 1999           INDXR                   Chris
        Removed a test on the maximum antenna number since INDXR
        can cope with arbitrarily large antenna numbers as long as
        there are no more than MAXANT antennas in any subarray.
        Also increased the maximum number of subarrays to 20 to cope
        with DRAO galactic plane data (which can have at least 13)
        and to match the limit set in FITLD.
        Moved nowhere.

10179.  February 18, 1999            FITLD                 Chris
        FITLD no longer treats array numbers as filter IDs in VLBA
        data. This oddity was inserted to deal with some early test
        data from the VLBA and should not be required to deal with
        any data in the VLBA archive.
        Moved nowhere.

10180.  February 24, 1999        $APGNOT/CLCOR             Leonia
        The correction of delay and rate (option ANTP) have been
        calculated calculated using only linear terms in the series of
        the corrections. In the extreme case the neglecting of the
        higher terms can lead to the visible errors. To eliminate the
        problem of the high term at all the new version of CLCOR
        calculates the correction of the delay and rate as the
        difference of the delay and rate in the shifted and original
        position.  The hour angle is calculated by SOUELV as REAL. I
        atached the local version of SOUELV(SOUEL) to have the hour
        angle with double precision accuracy.
        CLCOR has died at 'ANTP' if ANTENNA = 0. I modifyed it.
        Now it dies only if antenna position is corrected but continues
        working if only source position is corrected.
        Help file is updated.
        Moved nowhere.

10181.  February 25, 1999      $SYSUNIX/LINK, LIBR         Pat
        These two sometimes conspired to trick COMLNK into thinking that
        everything worked, when it did not.  Tried to close a few holes
        where the status was not necessarily caught correctly.
        Moved nowhere.

10182.  February 25, 1999      $HLPFIL/UVFIX.HLP           Leonia
        Sometimes ago I modified UVFIX including orbiting antennas, the
        effect of the differential abberation (Lorentz contraction) and
        recalculation of the U,V,W to the J2000 in all cases. These
        modifications were not shown in the help file. I added four lines
        to emphasize these modifications.
        Moved nowhere.

10183.  March 1, 1999             FITLD                   Chris
        SO2UV now calculates approximate apparent source positions
        from the mean positions if they appear to be the same in the
        incoming table and if the mean equinox is 2000.0 or later (so
        that there is a good chance that Julian precession is appropriate).
        This calculation does not include GR terms, aberration, or polar
        motion. This is a crude fix for programs that trust the apparent
        coordinates in source tables and are flummoxed by data from the
        VLBA correlator (which writes mean positions in these fields).
        Moved nowhere.

10184.  March 2, 1999          OBOXFILE                 Eric
        Fixed WRIBOX to initialize the scratch file name.  Otherwise, it
        got into trouble when creating a new file in that it failed to
        delete the non-existant scratch file.
        Moved nowhere.

10185.  March 3, 1999            FITLD                    Chris
        FITLD now issues a warning on finding sources with the same
        name and qualifier but different positions. It would be better
        to generate a new source qualifier in these circumstances but
        this would require revising the source-handling logic to keep
        track of the qualifiers that are in use: this will wait for a
        more thorough overhaul of the source table handling in FITLD.
        Moved nowhere.

10186.  March 6, 1999         QEDIUTIL                  Eric
        Several places required there to be more than one sample at a
        time before they would examine that time.  This did not work
        when only one antenna was included for sure and could have
        gotten in trouble occasionally at other times.  Affected SNEDT,
        EDITA and EDITR.
        Moved nowhere.

10187.  March 7, 1999             COMB                          Eric
        COMB assumed that the FREQ  axis was the same axis in both
        images which causes problems on occasion with SPIX amd ROTM.
        Fixed it to be more careful.  Note - > 1 point axes must still
        be the same type by axis number.
        Moved nowhere.

10188.  March 8, 1999           WHATSNEW                      Eric
        Added info re 15APR99 and 15OCT98 to this file.
        Moved to my www page as well.

10189.  March 9, 1999    Calibration transfer documentation   Chris
        Cleaned up references to calibration transfer in the help
        files for ANTAB, APCAL, MERGECAL, PCCOR, and PCLOD.
        Moved to 15OCT98 patch area on this date.

10190.  March 9, 1999               PASTE                       Eric
        Used CRPIX for default PIXXY on non-existing axes, but it is 0
        there and => bad BLC, TRC.  Pick up number real axes and set
        defaults 1 for non-real axes.
        Moved nowhere.

10191.  March 10, 1999          Imaging                         Eric
        Ketan has a lovely data set (small) that brought out the worst
        in things.  When making an 8192x8192 image, it has only small
        swaths in the AP at any 1 time and found itself running out of
        data with the swath from -4 to +10 or so yet to do.  So it
        happily told the weight summing and phase rotating routines to
        include those non-existant rows.  Fixed for this:
        GR3DUV    $QNOT: Failed to know it was out of data and did a bad
                  UVINIT call
        APSUM     $QNOT: Would work on non-existant rows
        APFNSH    $QNOT: Would work on non-existant rows
        There is also a problem about fiting in a small AP:
        QUVUTIL   $QOOP: Did not prepare NCHAVG before call to GRDFIT so
                  first test did not check for bandwidth synthesis
        GRDFIT    $QSUB: which was a good thing since it would have
                  failed the test.  Corrected test to see if bandwidth
                  range will fit around max U rather than full image
                  and weight grid size which should be 2-4 times larger
                  and is not needed.  Fixed error message as well.
        Moved nowhere.

10192.  March 10, 1999            UVLOD, FITLD              Eric
        Fixed RUVTAB.  It did not copy the right number of correlators
        for multi-IF and multi-channel FITAB files.
        Moved nowhere.

10193.  March 11, 1999         Imaging                      Eric
        Changed UVWAIT that demanded too much memory for weighting
        and changed GRDFIT to match better and to use FMAX to scale the
        Max U for the does everything fit test.
        Moved nowhere.

10194.  March 11, 1999                 SCMAP                      Eric
        Changed SCMAP - its reporting of rms levels was messed up
        causing it to leave out one message and to have the others be
        one iteration behind.  Removed a debug message from APSUM as
        well.
        Moved nowhere.

10195.  March 11, 1999              CSLGET                      Eric
        When filling in the earlier non-existant time's data from the
        later time, CSLGET neglected to copy the IFRTAB and DDTAB values
        along with the time and gain values.  This left FBLANK around
        when it did not need to be exposing us to problems which have
        been addressed earlier, but lurk.
        Moved nowhere.

10196.  March 12, 1999            SOURNU                     Eric
        The routine returned #source=0 in two cases: all are selected
        and none of the requested ones were found.  Changed the latter
        to return also IRET=-1.
        Changed calls to SOURNU:
        PCCOR   Changed to test for error!
        QUACK   Changed to test for JERR<0, no call SOURNU when NOSOUR
        UVCOP   Changed to report error and quit rather than copy all.
        UVFLG   Changed to treat a failed match as an error and quit.
        CLPLT   Changed to test error and quit
        SNPLT   Changed to report sources not found - continues an all
                SU table erors incl not found
        VPLOT   Changed to test error and quit
        Moved nowhere.

10197.  March 12, 1999        UVCOP                        Eric
        FGSEL and SUSEL copied records from the old table to the new
        ignoring the fact that they were flagged in the old table.  All
        the other *SEL ones deleted such records, so fixed these to do
        that too.
        Moved nowhere.

10198.  March 17, 1999          Linux BUG                 Eric
        Changed $APLUNIX versions of ZSSSL2.C and ZSSSO2.C to remember
        which TV they opened and thereby avoid certain translations plus
        gethostbyname and getservbyname.  This last leaves a file
        descriptor open under Linux when YP is needed to find the
        service and this can lead to "too many open files" and program
        death.
        Moved nowhere.

10199.  March 18, 1999               ZSSSO2                     Eric
        I messed up Unix sockets with not moving all the arguments to
        the new nomenclature.  Sigh...
        Moved nowhere (e-mail Ralph Gaime).

10200.  March 18, 1999             BATQ                         Eric
        When submitting a job with a delay time, the stored times were
        too large by 1900 years.
        Moved nowhere.

10201.  March 22, 1999                UVPRT                     Eric
        Added OFFSET to offset time intervals for holography
        auto-editing.
        Moved nowhere.

***********************************************************************
***********************************************************************

                 Changes while 15APR99 is NEW

***********************************************************************
***********************************************************************

10202.  March 26, 1999        Object Manager                   Chris
        Fixed the guard for the while loop that establishes the value
        of len in create_llelem (ZOINTD.C in APLGEN). This incorrectly
        used a bitwise and operator instead of a Boolean and operator
        and listed the conjuncts in the wrong order so that there would
        always be a read from beyond the expected length of dim.
        Moved from 15OCT99 on this date.

10203.  March 27, 1999       Freq offset in Source table       Eric
        The source table contains a frequency offset as well as the FQ
        table.  Technically, the CL table has both the source offset
        added to the time-variable Doppler offset so one really ought to
        find every time record and make everything go 10 times slower!
        But the Doppler change is small (0.5 km/s max) while the source
        offsets can be large (100 Mhz possible).  So fix things to at
        least take the source part into account.  Actually, UVGET
        already does this in the INIT call when there is 1 source out so
        DSEL.INC    Add parameter SFREQS(MAXIF)
        SELINI      Init SFERQS = 0.0d0
        DGHEAD      Set SFREQS
        CHNCOP      Change call seq to add SFREQS array to call and to
                    add the SFREQS values to the FOFF(if) written to the
                    output FQ table.
        UVDATA      In OUVOPN, save SFREQS from UVGET (INIT) call as
                    SOURFREQ in UVDATA object
        UVUTIL      Changed UVFRQS and UVREFQ to get SOURFREQ from the
                    UV data set and add it to FOFF.  Changed UVFCOP to
                    get SOURFREQ and pass it to OCHNCO.  Fixed them to
                    use BCHAN and ECHAN - wrong channel frequencies were
                    found when BCHAN and ECHAN were still active i.e.
                    not 1 and N.
        QUVUTIL     Added OUVOPN calls in OUVIMG and OUNFWT.
                    Frequencies are known only after an open.
                    OUVIMG found FREQS and then used FREQG for the list
                    of frequencies.
        TABLEUTIL   Changed call seq of OCHNCO to take source offsets to
                    pass on to CHNCOP.
        UVMDIV      Send 0's for SFREQs to CHNCOP - all single source by
                    this routine.
        UVPDIV      Send 0's for SFREQs to CHNCOP - all single source by
                    this routine.
        CALIB       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        PCAL        Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        LPCAL       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        FRING       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP. NOT
                    DONE - Ketan has it.
        KRING       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        CPASS       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        BPASS       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        BLCAL       Send SFREQS from DSEL and UVGET(INIT) to CHNCOP.
        MX          Send SFREQS=0.0D0 to CHNCOP.
        Moved to 15APR99 March April 8

10204.  March 27, 1999               CLINV                      Eric
        New task to copy an SN or CL table inverting some or all of the
        calibration contained therein.
        Moved to 15APR99 March April 8.

10205.  March 27, 1999               FLGIT                     Eric
        Added option to flag on VPOL, fixing up displays and help file.
        Moved to 15APR99 March April 8.

10206.  March 27, 1999              FITAB                     Eric
        Added more parameters to the main header as HISTORY AIPS since
        that is what UVLOD uses to build its headers.
        Moved to 15APR99 March April 8.

10207.  March 27, 1999               IMAGR                    Eric
        Major gridding bug in 3D disk-based images.  If there is a gap
        in the u coverage so that there are rows beyond the end of one
        swath in which there are no data, GR3DUV was supposed to write
        rows of 0 to the grid file, but it did not.  Instead it wrote
        the next swath to early in the file and did not re-write the
        file at rows near 0.  This should have done very bad things to
        the image - in the case under study where the data weights are
        small (<< 1), the image ended up in the KiloJy range.  With more
        normal weights, horizontal stripes particularly toward the image
        corners were the result.
        Also change IMAGR.FOR to force VERSION to the output channel
        number for line images, so that the correct CC file would be
        created at the beginning.  Restarts failed otherwise even for
        line (although the help says OUTVERS matters only for
        continuum).
        Changed TVMENU to remember the last TV size when it did a menu.
        Then, if that has changed it will redraw all of the menu.  It
        could get confused otherwise.
        Changed QCLEAN to wait 5 minutes for the first TV menu to time
        out and to init the color tables only on the first pass.
        Moved to 15APR99 March April 8.

10209.  March 30, 1999            IMAGR, SCMAP                   Eric
        Changed
        SCMAP    Added tests to control whether the LUTs are initialized
                 by self-cal TV function and added longer TIMLIM for
                 first time around.
        QCLEAN   Fixed TIMLIM setting a bit and CLIINF test on cell size
                 which failed sometimes for large cells.
                 Added test to see if anything is found in OVERLAP 2
                 since the last time all images were remade.  If not, it
                 switches to OVERLAP 1 mode rather than go into its
                 infinite loop.
        Moved to 15APR99 April 8

10210.  March 30, 1999          SPLIT                           Eric
        On error in UVCREA, there was a call to UVGET ('CLOS'...)
        although UVGET ('INIT'...) had not been called since the
        previous close.  This caused a failure because DOCAL was true by
        that point, but had been false in the earlier quick UVGET
        open-close.  CLBUFF had been used for scratch purposes to see if
        an SU table existed and so had whatever was in the SU tables's
        first record but 0's for the data area (CLBUFF(257-512)).
        So the SU table was closed with erroneous data and thereby
        effectively destroyed!  This only happened if it had been used
        with LUN 27 previously and successfully - i.e. by a previous
        SPLIT.  Anyway - put in a logical to keep track of whether we
        should do a UVGET close or not.
        Moved to 15APR99 April 8

10211.  March 30, 1999          CALIB                        Eric
        Missed one of the calls to CHNCOP which needed SFREQS added to
        it.
        Moved to 15APR99 April 8.

10212.  March 30, 1999             XGAUS                     Chris
        Fixed the dimensions of the SCRTCH array which was a factor too
        small. It is hard too see how this was missed since XGAUS blew
        up in a spectacular fashion.
        Moved from 15OCT99 on this date.

10213.  March 31, 1999         LaCook9                  Ketan/Eric
        I've added information on how to process data that has
        calibration transfer from the correlator.  Also, there is now
        some material on phase-referencing.  I took the opportunity to
        place more emphasis on EDITR.  Probably somewhere it should say
        that EDITR is now the recommended task for initial examination
        and for editing of VLBA data.  Upgraded LaCook0, LaCookI and all
        of the PostScript copies and the html TofC.
        Moved to 15APR99 this date.

10214.  April 2, 1999            KNTR                        Eric
        Added NY adveerb to allow user control of number of panes in Y
        direction.  Changed POPSDAT.HLP, NEWPARMS.001, created NX.HLP,
        NY,HLP.
        Moved to 15APR99 this date.

10215.  April 2, 1999           GETDEL in APLNOT             Chris
        The loop that minimized the number of records to be checked
        for for time/source/subarray/frequency matches assumed that
        the sum of reference time and time interval increased
        monotonically with increasing row number and could therefore
        exclude potentially valid IM table records from the validity
        test. It also assumed that delay polynomials are valid before
        the reference time of the record. Rewrote the preselection
        using two simulated while loops to maintain the correct
        invariant conditions and removed a redundant loop.
        Moved from 15OCT99 on this date.

10216.  April 2, 1999           GETMC in APLNOT             Chris
        Fixed a defect that lead to DTIME being calculated relative
        to a record that was either earlier or later than the one
        actually being used.

10217.  April 4, 1999          UVPRT, UVHOL                 Eric
        Removed holography from UVPRT and fixed bug affecting data
        weight scaling.
        Created new task UVHOL which is like UVPRT.  However, it
        squirrels away all records with matching W (a holography code
        for pointing/phasing) and then prints or writes out only the
        last N of them and then only if at least M are in the set.
        Moved to 15APR99 April 8

10218.  April 5, 1999            ZTPOPN                     Eric
        ZTPOPN set the common parameter TPNAME(ivol) before finding out
        if the tape would actually open.  It then left it set when
        things failed.  In AIPS, after this failure, the set name would
        cause the program to try to dismount an uninitialized on exit
        and to fail on a mount as well.
        Moved to 15APR99 April 8.

10219.  April 5, 1999               TABIO                   Eric
        Changed to reset write status in the table header to a no-op on
        CLOS.  Otherwise, a header just read by ZFIO will always appear
        to be in write form and hence confuse a TABIO call.  It was this
        that ultimately caused to destruction of source tables in SPLIT.
        Moved to 15APR99 April 8..

10220.  April 6, 1999             MNJ                      Eric
        The min-mnj did not work properly because UPDCONTROL spelled
        UpdMiniPRG as UpdMiniPrg.  Changed spelling and added TPMON to
        the default list.
        Moved to Kitt Peak and the 15APR99 this date.

10221.  April 7, 1999             LIBR                     Pat
        Added AXLINUX (in fact *LINUX) to the list of systems on which
        "lorder" will not be done for libraries.
        Moved from 15OCT99 this date.

10222.  April 8, 1999             BPASS                    Eric
        There was an addressing error that caused bad bandpasses to be
        computed for the first half of a good polarization for an
        antenna when all channels of the other polarization of that
        antenna were flagged.  The bug has been there since 1996 (in
        CVX) and has therefore affected both 1998 releases.
        Moved to 15APR99 April 8.

10223.  April 8, 1999             FITLD                   Chris
        Added code to pick up the observing date from RDATE keywords
        in FITS-IDI files. Normally this will be the reference date
        for the first ARRAY_GEOMETRY file. Previously FITLD only
        looked for DATE-OBS keywords. This was potentially dangerous
        since DATE-OBS is not required in any FITS-IDI tables and
        usually only occurs in UVDATA tables. Added comments to the
        help file describing circumstances in which the current
        scheme might fail.
        Moved from 15OCT99 on this date.

10224.  April 8, 1999             KRING                   Ketan
        Added new SOLTYPE = 'NOFT' to totally disable FFT stage.  This
        allows KRING to perform only the least squares and behave just
        like CALIB except that KRING can also solve for rates,
        single-band and multi-band delays. When a solution's SNR falls
        below the threshold, the solutions are now blanked.  The
        minimum gridding time is now used to better grid the data in
        time.  This should fix the 'two-times found message'.
        Unfortunately, the user should now take care to actually enter
        the minimum integration time as accurately as possible [For
        the VLBA, the minimum integration time should be enterred as
        the appropriate multiple of 0.131072].  Once the time-gridding
        routines are overhauled, this nuisance will be abated.  The
        test suite for KRING has now been fully automated.  The SNR
        calculations for the FFT stage and the LS stage have been
        overhauled to be on the same scale.  Two SNRs are now
        calculated in each stage.  The first is labelled SNR and is
        used for threshold testing against the user-supplied SNR
        cutoffs.  The second is labelled SNR/vis and should be used
        for comparing SNRs between the FFT stage and the LS stage.
        Further details supplied upon request.  Some refinements for
        these calculations are forthcoming.
        Moved from 15OCT99 on this date.

10225.  April 8, 1999             OMFIT                   Ketan
        OMFIT now supports INFILEs with internal versioning - for
        easier prototyping of models within a single INFILE.  The
        adverb DOFIT has been added to allow the user to supply a
        starting model from POPS.  Any available model-type can be
        specified using DOFIT.  The adverbs have been rearranged.
        Errors in the calculation of machine precision (resulting in a
        lax convergence criterion), the estimation of map noise, and
        construction of a catalogued AIPS file have been fixed.  The
        OMFIT test suite now checks the self-calibration convergence.
        OMFIT now includes the covariance matrix of the parameters in
        the OUTFILE.
        Moved from 15OCT99 on this date.

10226.  April 9, 1999            SPCAL, USUBA               Eric
        Fixed bad declaration in SPCAL (like previous fixes in PCAL et
        al) for HSOLTY - thanks to Jean-Francois Desmurs.
        Fixed the table copying routine in USUBA to keep going on error
        as best it can and to close the files no matter what.  USUBA
        needs work but it is too messy to do now.
        Moved from 15OCT99 this date.

10227.  April 12, 1999               FITLD                  Chris
        Increased the limit in FQIDs to 256 to conform to the rest of
        AIPS and added a test against this limit in MAPFQI.
        Moved from 15OCT99 on this date.

10228.  April 12, 1999     Solaris tape routines            Chris
        Used #ifdef tests to protect reference to MT_ISXY in ZMOUN2,
        ZTAP2, and ZTPWA2 in APLSOL. This symbol appears to have been
        removed in Solaris 7.
        Moved from 15OCT99 on this date.

10229.  April 12, 1999          GRDFIT                 Eric
        UVGRID has a -1 that was not include in GRDFIT so it was
        possible to disagree by 1 row on whether a gridding would fit
        without sorting.  Added 2 rows for safety to GRDFIT.
        Moved to 15APR99 this date.

10231.  April 15, 1999           CLINV.HLP              Leonia
        The help file for CLINV lists OPTYPE as an adverb, but it has not
        appeared in the inputs. The HELP file erroniously has not listed
        OPTYPE in its first part. I fixed it
        Moved to 15APR99 April 16.

10232.  April 18, 1999        LSAPROPO, ABOUT files        Eric
        Ran the update tools and found that LSAPROPO is not updated when
        a remove of a help file is done.  So I putbck a new LSAPROPO
        with the fixes suggested by SHOPH.
        Then updated the follow ZZxxxx files for ABOUT lists:
        ZZADVERB.HLP    ZZANALYSIS.HLP  ZZCALIBRAT.HLP
        ZZFITS.HLP      ZZGENERAL.HLP   ZZHARDCOPY.HLP
        ZZIMAGE-UT.HLP  ZZIMAGING.HLP   ZZPLOT.HLP
        ZZPOPS.HLP      ZZTABLE.HLP     ZZTAPE.HLP
        ZZTASK.HLP      ZZUV.HLP        ZZVERB.HLP
        ZZVLA.HLP
        Moved to 15APR99 this date.

10230.  April 21, 1999           FITLD, IMLOD               Pat
        Minor enhancement of an error message, in the situation where
        the file size is physically shorter than the headers indicate.
        Some non-compliant FITS writers fail to pad the last block.
        Moved from 15OCT99 this date.

10231.  April 25, 1999           UVPRM.FOR                  Leonia
        The routine SETANT and CALL SETANT have had different number
        of parameters:
        CALL SETANT (50, XANT, XBASE, NANT, NBAS, DESEL)  in UVPRM
        SUBROUTINE SETANT (N,XANT,XBAS,NXANT,NXBAS,IANT, IBAS, DESEL)
                                                          in $APLSUB
        As a result the memory confusion occurs. In particular FRQSEL=1
        was zeroed.
        I matched parameters in CALL SETANT with the subroutine in
        $APLSUB.
        Moved from 15OCT99 on April 29 by Pat.

10232.  April 28, 1999            DATCAL                  Chris
        Fixed a typographic error in the application of dispersive
        delay corrections that corrupted the imaginary part of the
        visibilities.
        Moved from 15OCT99 on April 29 by Pat.

 **********************************************************************
