; -----------------------------------------------------------------------
;  Copyright (C) 1996, 1997
;  Associated Universities, Inc. Washington DC, USA.
;
;  This program is free software; you can redistribute it and/or
;  modify it under the terms of the GNU General Public License as
;  published by the Free Software Foundation; either version 2 of
;  the License, or (at your option) any later version.
;
;  This program is distributed in the hope that it will be useful,
;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;  GNU General Public License for more details.
;
;  You should have received a copy of the GNU General Public
;  License along with this program; if not, write to the Free
;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
;  MA 02139, USA.
;
;  Correspondence concerning AIPS should be addressed as follows:
;         Internet email: aipsmail@nrao.edu.
;         Postal address: AIPS Project Office
;                         National Radio Astronomy Observatory
;                         520 Edgemont Road
;                         Charlottesville, VA 22903-2475 USA
-----------------------------------------------------------------------
     This file must be used to record any changes made to the the master
version of AIPS kept in Charlottesville.  An entry is:

   line 1:   Date Program name Your name
   line 2:   What was done (may span multiple lines).  MAX 72 COLUMNS.
   line n-1: Where has this change been moved (e.g. 15APR97, nowhere)
   line n:   Blank

PUT A TAB IN THIS FILE, AND YOU WILL BE WHIPPED WITH A WET BANANA PEEL!

 The details of line 1 are important since programs are used to find
 specified strings and do conversions on them.  It MUST be typed as
 follows: 1 blank, 4 digits, a period, two blanks, then the Month,
 day, comma, year, some space, a title, some more space, your name.
 Likewise, the n'th line should be COMPLETELY blank (no spaces).

                    Changes to 15APR97


***********************************************************************

        Changes while 15APR97 was TST:

***********************************************************************

***********************************************************************

 9167.  October 23, 1996         GPSDL                     Chris
        Added a test to protect against the cosine of azimuth going
        out of range near culmination due to rounding errors. Also
        fixed a formatting error in the .HLP file.
        Moved to 15OCT96 on this date.

 9168.  October 23, 1996         LDGPS                     Chris
        Now requires the user to enter the time offset of the
        GPS receiver (which is variable) rather than using a look-up
        table.  Also corrected the scaling of TEC data and modified
        the Los Alamos table reader to deal with variable amounts of
        spacing between columns.
        Moved to 15OCT96 on this date.

 9169.  October 23, 1996         CLCAL                     Pat
        Replaced old SORT routine with HSORT, a fast, public-domain heap
        sort.  Thanks to Fred Schwab for donating it.
        Moved to 15OCT96 on this date.

 9170.  October 23, 1996         This file                 Pat
        Almost forgot to trim it for the new version.  Note the
        new admonitions above.
        Moved nowhere.

 9171.  October 24, 1996        CLCOR                      Leonia
        Some times ago I unified the concept of left (right) hand
        coordinate system for VLBA and VLA (OPCODE='ANTP').
        The relevant change was done at the help file. But comments
        at fortran codes of the subroutine ANTPOS stayed old and
        wrong. I brought to conformity the comments with the actual
        reality.
        Moved to 15OCT96 on this date.

 9172.  October 24, 1996       $YPGNOT/ELINT.FOR           Leonia
        When there is only one antenna observing the given source,
        there is no opportunity to fit a polinom in the data and
        to determine a correction of the source flux. The task
        has died without an explanation meeting such data. I have
        fixed the problem excluding the flux correction for the case
        of the only antenna observing the given source.
        Moved to 15OCT96 on this date.

 9173.  October 25, 1996       $APLPGM/PRTTP.FOR           Gustaaf
        At some time during the eighties, VLBI data sets had a total
        of 0 antennas in their headers. PRTTP checks for the type of
        tape; part of the test for an archive tape is whether the
        number of antennas is between 1 and 27. Finding 0, PRTTP
        assumed it to be NOT an archive tape, and the listing would go
        horribly wrong. I now modified PRTTP to allow a total of 0
        antennas as well.
        Moved to 15OCT96.

 9174.  October 28, 1996       FILLM.HLP                   Gustaaf
        Added some detailed explanation on the conventions of time
        stamps in FILLM and AIPS uv data in general.
        Moved nowhere.

 9175.  October 28, 1996       $YPGNOT/ELINT.FOR           Leonia
        The task excluded undefined points in the input SN table
        during fitting but not during plotting of the data. It
        happened because the data were multiplied by the gain
        factors before plotting  and as a result the points were
        no longer equal to FBLANK. Corrected this by not scaling
        FBLANK values.
        Moved nowhere.

 9176.  October 29, 1996       $APGNOT/BLOAT.FOR           Athol
        Copy multi-Stokes data, as requested by NRAL. Leave the
        infrastructure for now, which makes some assumptions and
        needs work.
        Moved to 15OCT96 on this date.

 9177.  October 30, 1996       $QPGOOP/OMFIT.FOR           Ketan
        Added dynamic memory allocation to improve execution times.
        Also, finally, added capability of processing polarization
        data as well as fitting multi-channel components.  Still
        lots to do - but not today!
        Moved to 15OCT96 on November 1, 1996

 9178.  October 30, 1996       $HLPFIL/OMFIT.HLP           Ketan
        Much revised help file - thanks to Michael Rupen's efforts.
        Documented new model components.  Made some features
        simpler to understand.
        Moved to 15OCT96 on November 1, 1996.

 9179.  October 30, 1996       $APGNOT/MK3IN.FOR & .HLP    Athol
        Implement new fractional bit shift correction as
        derived and coded by Kari Leppanen (JIVE) in the course
        of high dynamic range imaging tests using the EVN. The
        FBS correction now includes amplitude corrections if
        desired. In addition the band centre for the existing
        phase correction was found to be in error by one
        half of a channel, and has been corrected.
        Moved to 15OCT96 on this date.

 9180.  October 30, 1996          $APGNOT/FITLD         Phil
        Made a minor but vital fix needed for the new correlator code.
        The amplitude scaling change I added on Oct 3 did not work if
        files were skipped on tape since a crucial parameter was reset.
        Also added a much more minor change in correcting the reference
        pixels when IF and channel selection were used.
        Moved to 15OCT96 on this date.

 9181.  October 30, 1996        VLB DDT                 Athol
        Minor change to DTCHK to compare angles in the correct
        quadrant. Also add new file $RUNSYS/DTSIM.FR_1 for the
        VLB DDT.
        Moved to 15OCT96 on this date.

 9182.  November 1, 1996        $DOCTXT/USERNO.LIS      Ketan
        Wrote PERL script to make updating the AIPS user numbers
        list easier.  In the process, reformatted the file and
        made it a bit easier on the eye.  Now, to add new user
        numbers, only the first two columns need be filled in.
        The script automatically figures out what belongs in all
        the rest of the columns.
        Moved to 15OCT96 this date.

 9183.  November 1, 1996       $APGNOT/CLCAL.FOR           Ketan
        Replaced matrix inversion code inside CLCAL with LAPACK
        equivalent code.  Also, cleaned up the subroutine FITSC
        quite a bit to make it more efficient.
        Moved from 15OCT96 this date.

 9184.  November 1, 1996          BLING                   Chris
        Added protection against overflow problems in the SNR
        calculation.  Also removed a lurking PRINT statement
        left over from debugging.
        Moved to 15OCT96 on this date.

 9185.  November 2, 1996          $APGNOT/CLCOR.FOR       Athol
        Correct the amplitude factor used for the opacity
        correction for OPTYPE = 'OPAC'. The amplitude factor
        was the square of what it should have been.
        Moved to 15OCT96 this date.

 9186.  November 3, 1996     $SYSPERL/check_version.pl    Jeff
        Added Perl version 5.003 to "known-good" list of Perl versions,
        eliminating the pesky warning at the AOC.
        Moved nowehere, though should probably be put in 15OCT96.

 9187.  November 4, 1996      PCCOR.FOR, PCCOR.HLP         Leonia
        The new adverb CUTOFF have been added. The adverb allows
        to swich off the cable delay. It is useful for geodesy
        people. Additionnally the task has been simplified
        excluding the referencing to the reference antenna at the
        stage of ambiguaty resolving of the target sources data.
        Moved to 15OCT96 this date.

 9188.  November 5, 1996      $INSUNIX/INSTEP1             Pat
        Fixed some typos (missing quotes) and changed several things.
        Added a new logging facility (what happens now goes in
        INSTEP1.LOG for the most part), always build PRINTENV from the C
        program, use gmake for XAS if we can, remove problematic
        LD_LIBRARY_PATH and LD_RUN_PATH setting, replace with warnings
        if these variables are set for SOL, use UNSHR to unpack XAS
        always, modified the tape device (TPDEVS.LIST) part and added a
        section to take care of setting up the TPHOSTS file.
        Moved to 15OCT96 this date, and to the tape-cut area.

 9189.  November 11, 1996          $APGNOT/FITLD          Phil
        I finally added weight-based flagging due to pleading by some
        VLBA users. The implementation method is not totally general in
        that I do not write an FG table (is complicated if wish to do so
        efficiently). The data are permanently flagged since they are
        not copied from tape to disc if the visibility weight in any IF
        drops below the specified threshold. This was deemed adequate by
        several VLBA users.
        Also updated FITLD.HLP.
        Moved nowhere.

 9190.  November 11, 1996      SSSIN, AIPSMTn                   Pat
        Using network service names in upper case letters exposes bugs
        in operating systems.  In particular, a NIS/YP server running
        SunOS 5.5 was found to reject connects for service names (in
        getservbyname) in uppercase.  Changed $APLUNIX routines
        ZSSSO2.C, ZVTPO2.C, and ZVTPO3.C, $YSERV archive XAS.SHR (though
        SSS.SHR and XVSS.SHR should also be fixed if anyone uses them
        anymore), $APLGEN routines ZMOUNT.FOR, ZTPOPR.FOR ZVTPRO.FOR and
        ZVTPO2.FOR, and $SYSUNIX (and AIPS_ROOT) routine TVDEVS.SH to
        name these services in lower case.  The tekserver and message
        server already used lowercase.
        Moved from CVX this date, and moved to SOL MNJ site in CV.
        Should also be moved to a patch area for 15OCT96 once it exists.

 9191.  November 11, 1996          BLAPP                       Chris
        Inserted code to ensure that the BS table is sorted in time
        order before entering the gridding loop (which assumes that
        times are non-descreasing).
        Moved nowhere.

 9192.  November 12, 1996     $SYSPERL/hlpitgen.pl         Jeff/Pat
        This was in the aipssrc area which is not distributed with AIPS,
        and anyone adding tasks to AIPS will need to generate the
        HLPIT.LIS file in $HLPFIL after adding the new help file.
        Currently needs perl 5 though this can be changed with a little
        work.
        Moved nowhere.

 9193.  November 13, 1996     $YPGNOT/IRING                    Ketan
        IRING only plotted the incremental intensity distribution if
        requested.  I added the option to plot the cumulative intensity
        distribution as well - by user request.  Also, added an old
        modification to IRING that I had lying around. This modification
        allows the user to select a range of azimuthal angles over which
        to compute the intensity distributions.
        Moved nowhere.

 9194.  November 21, 1996          PRTAC                       Pat
        Changed it to regard real times of 0.0 with cpu times <= 1 as
        "good" rather than aborts (by setting real = 1.1*cpu).  The
        really fast things these days get reals of 0 a lot due to the
        integer seconds of ZTIME.
        Moved from CVX this date.

 9195.  November 21, 1996          MAKE.MNJ                 Pat/Shoshana
        This script was not doing anything with the UPDCONFIG file, and
        it should at least make sure it's in $SYSLOCAL and copy it if
        not.  It should not put it in $TST/$ARCH/UPDATE/ as it was
        doing.
        Moved nowhere.

 9196.  November 25, 1996        $YPGNOT/FRMAP            Leonia
        The maximum number of baselines (100) was not enough to use the
        task for the VLA data when all 27 antennas provide the data. The
        relevant parameter was increased to 400. The format of print a
        baseline number was changed from I2 to I3 to print baseline
        numbers more than 99.
        Moved nowhere.

 9197.  November 26, 1996       $INSUNIX/INSTEP1            Pat
        Allow zero disks per host to be legitimate; some sites use the
        .dadevs mechanism exclusively so zero is the right answer for
        these hosts.  Also comment out the host/IP verification code as
        it was not working (regexps in case statements are extremely
        lobotomized).
        Moved nowhere yet, maybe to the patch area if I get complaints..

 9198.  November 28, 1996       VLB DDT data files          Athol
        Add several new VLB DDT data files to $RUNSYS, namely
        DTSIM.BPASS_1, DTSIM.BPASS_2, DTSIM.CALIB_1 and DTSIM.CALIB_2.
        Moved nowhere.

 9199.  December 3, 1996        DOPOL                       Athol
        Implement new polarization correction modes DOPOL=2 and
        DOPOL=3, to allow second order polarization corrections when
        using the linear D-term approximation within AIPS. The mode
        DOPOL=3 applies more rigorous flagging, removing visibility
        points with any missing polarization correlation pairs. The
        mode DOPOL=2 applies the same second-order correction but
        makes several approximations for any missing polarization
        correlation pairs when computing the correction matrix. The
        mode DOPOL=1 makes the same first-order correction as before.
        The new modes are currently implemented only for 'VLBI'
        polarization calibration within AIPS, and have no effect on
        other solution types (eg. VLA or orientation-ellipticity).
        The second-order corrections have recently been shown to
        be important when correcting EVN data which may have
        individual D-term amplitudes as high as ~20% in isolated
        cases (as reported by K. Leppanen/JIVE, who submitted
        private code used to correct this effect). Note that 2nd
        order corrections have always been applied for the
        orientation-ellipticity VLBI polarization model in AIPS.
         Made the following changes:
          $INC/DSEL.INC - changed DOPOL from logical to integer.
         Change DOPOL handling from logical to integer in:
          $APLNOT: DATGET, DGHEAD, FNDPOL, SELINI and UVGET.
          $APLOOP: CALEDIT.
         Further changes in $APLNOT:
          DATPOL - add check for missing cross-hand correlations;
                   use approximations where necessary; If DOPOL=3
                   flag all data with any missing polzn. pairs;
                   polzn. correction matrix was only computed
                   every 0.1 min or when the parallactic angle
                   changed by more than 2 deg - this led to
                   a 2 deg phase sawtooth in the RL,LR data at
                   times; change to update the matrices for
                   any change in time or parallactic angle -
                   the computational overhead seems reasonable.
          VLBPOL - implement the new 2nd order elements of the
                   polzn. correction matrix for DOPOL > 1. Do
                   not assume low linear source polarization.
         Change DOPOL handling from logical to integer in:
          $APGNOT: DECOR, LISTR, SHOUV, SPLIT, UV2TB, UVFIT, UVPRM,
                   UVPRT and SPCAL.
          $APGOOP: MAPBM.
          $QPGNOT: BPASS, HORUS and CPASS.
          $QPGOOP: IMAGR and OMFIT.
          $YPGNOT: POSSM, FRPLT, UVPLT, VBPLT, CLPLT, FRMAP and
                   VPLOT.
        Recompiled/linked all affected tasks/libraries.
        Moved nowhere.

 9200.  December 4, 1996       DOPOL                       Athol
        Update .HLP files affected by #9199. These include:
          DOPOL, DECOR, LISTR, SHOUV, SPLIT, UV2TB, UVFIT,
          UVPRM, UVPRT, SPCAL, MAPBM, BPASS, HORUS, CPASS,
          IMAGR, OMFIT, POSSM, FRPLT, UVPLT, VBPLT, CLPLT,
          FRMAP and VPLOT.
        Moved nowhere.

 9201.  December 5, 1996     $YPGNOT/VPLOT.FOR, CLPLT.FOR  Leonia
        Only four symbols have been allowed to use in IN2CLASS,
        because the other two are reserved for the images number.
        It has not arisen any problem in standard cases, because
        the CLASS of the output images of a CLEAN procedure uses
        usially only four of six symbols (ICLN, RCLN ...).
        But sometimes people desire to rename the CLASS of the image,
        using all six symbols. In this case the last two symbols
        are substituted by an image number and as a result the
        image can not be found by subroutine MAPOPN and plot of
        the model is not being plotted. To overcome the problem
        the tasks provide now the substitution of the last two symbols
        only if more than one image is used for the model.
        Moved nowhere.

 9202.  December 9, 1996     VLB DDT                      Athol
        Revise $APGNOT/DTSIM.FOR and $APGNOT/DTCHK.FOR to support
        several new features: i) instrumental polarization errors;
        ii) multiplicative gain errors; iii) rest frequencies and
        LSR velocities in the SU table and catalog header; and
        iv) baseline-dependent integration times. Also updated
        $HLPFIL/DTSIM.HLP and added new DDT data files DTSIM.DOPOL_1
        and DTSIM.DOPOL_2 to $RUNSYS. Changes to $APLNOT/DTPARM.FOR,
        $APLNOT/DTCALS.FOR and $INC/DTPM.INC as part of this update.
        Moved nowhere.

 9203.  December 10, 1996    $APLOOP/UVUTIL               Ketan
        Fixed IF/channel selection in UV2SCR.  UV2SCR invokes UVGET and
        later, OUVSCR which then invokes OUVSLT.  Both UVGET and OUVSLT
        attempt to check channel/IF selection.  Before calling OUVSCR,
        the channel/IF selection parameters are reinitialized in the
        input UV object - they are restored after return from OUVSCR.
        This seems to fix the problem of channel/IF selection being
        applied twice.
        Moved nowhere.

 9204.  December 10, 1996    $QPGOOP/GPHAS                Ketan
        Added new options for REFANT selection, fixed model division.
        Previously the REFANT was created as a new VIRTUAL antenna.
        Now, the REFANT can be specified explicitly, or taken to be the
        most commonly occuring REFANT in the CL table.  Model division
        would fail if a source name was not specified, even if only one
        source existed in the file.  Now, a source name is required for
        CC model division unless the data file is a single source data
        file.
        Moved nowhere.

 9205.  December 10, 1996    $APGNOT/FRING                Ketan
        FRING now implements the ORIGIN keyword for single source data
        files.  When CALIB and BPASS run on single source files, they
        add the ORIGIN keyword to the output SN table.  Fring has now
        been modified to do this as well.
        Moved nowhere.

 9206.  December 10, 1996    $RUNSYS/VLBDDT.001          Athol
        Preliminary script to check some VLB tasks using simulated data.
        Also added .HLP file.

 9207.  December 12, 1996    $APLNOT/GETDEL.FOR          Athol
        Change GETDEL to deal with IM table access that may not be in
        time sequence. Will backspace IM table records in this case.
        Also, do not compare subarray numbers when searching for IM
        table entries; match source id., freq. id., antenna no. and
        time only.
        Moved nowhere.

 9208.  December 12, 1996    $APGNOT/INDXR.FOR           Athol
        Subroutine WRITCL was not calculating the number of CL
        entries correctly. An extra entry was written, which for
        short scans, may have fallen outside the scan boundary.
        Moved nowhere.

 9209.  December 17, 1996     $QPGNOT/CVEL.FOR           Phil
        Before all the buffer changes were made earlier in the year the
        call to TABSRT for the CL table used KBUFSZ to set the size of
        the scratch buffer. During the changes this was modified to call
        UVBFSZ but no check was made that UVBFSZ was set under all
        circumstances. If there is no FG table (and hence no FG sorting)
        then the call to set UVBFSZ was not made and so the CL sorting
        failed. Fixed so that UVBFSZ is always set, whether an FG table
        is present or not.
        Moved nowhere.

 9210.  December 18, 1996      $APLNOT/DTPARM.FOR        Ketan
        DTPARM did not properly initialize the arrays containing
        the source model information.  This resulted in faulty data
        set generation when using multiple source components in DTSIM.
        Moved nowhere.

 9211.  December 18, 1996      $APGNOT/DTSIM.FOR         Ketan
        The noise calculation in DTSIM was faulty.  The 'uniform
        Gaussian deviate' generated in the DTSIM subroutine ADNOIZ was
        being generated with unit amplitude.  Thus only phase noise was
        being generated, no amplitude noise at all.
        Moved nowhere.

 9212.  December 18, 1996      $APGNOT/UVCOP.FOR         Ketan
        UVCOP was reporting that it had 'written' the Nth visibility
        when in fact it had 'read' the Nth visibility.  1-liner.
        Moved nowhere.

 9213.  December 18, 1996      $YPGNOT/UVPLT.FOR         Ketan
        UVPLT can now be told to generate UVW coverage plots with
        uniform limits in the U,V,W directions.  If BPARM = x,y,2,0 is
        selected, where x and y are chosen from 6,7,8 [U,V,W
        respectively], then the plot is generated with identical limits
        along the X and Y axes.
        Moved nowhere.

 9214.  December 18, 1996      $HLPFIL/UVPLT.HLP         Ketan
        Documented change #9213.  Also, the axis codes for UVPLT are now
        shown when HELP UVPLT is invoked [A minor inconvenience.]
        Moved nowhere.

 9215.  December 19, 1996   $YPGNOT/ELINT.FOR, $HLPFIL/ELINT.HLP Leonia
        Several modification have been made:
         We have implemented an OPTYPE command to additionally fit for
        the opacity (following a law of the form exp(-tau/cos z)) as
        well as the gain polynomial.  This option can be useful in
        situations of high optical depth (such as at the upper end of
        Q-band, or a soaking wet day at K-band. This option is
        experimental and we plan to continue testing it.
         OPCODE = 'SECZ' has been discontinued. The task can also now
        deal with elevation ranges exceeding 90 degrees, when antennas
        observe "over-the-top".
         The fitted polynomial can now take two forms:
        i) three coefficients of the polynomial;
        ii) three coefficients which determine position and value of
         minimum correction (maximum gain).
         The print output format has been improved and the help file
        has been revised.
        Moved nowhere.

 9216.  December 19, 1996     $APLNOT/BPCOEF.FOR           Athol
        Allow autocorrelation data to be corrected by cross-power
        bandpasses for polynomial bandpass solutions. Would
        previously trap this case and halt with an appropriate
        error message.
        Moved nowhere.

 9217.  December 20, 1996     $YPGNOT/FRMAP.FOR            Leonia
        For some reason threshold, detecting the fringe rate maxima,
        was an integer variable. It has provided some inconvinience
        when the threshold is required to be fractional. So the type of
        the variable THRES is changed from INTEGER to REAL.
        Moved nowhere.

 9218.  December 24, 1996     $APGNOT/DTCHK.FOR            Athol
        Clean up an erroneous ATAN2(0,0) that was caught by the Dec
        Alpha.
        Moved nowhere.

 9219.  December 30, 1996     $APLNOT/GETANT.FOR           Athol
        GETANT reasonably assumes that the station numbers in the
        AN records are positive. If the station number is zero
        the array subscripting errors can overwrite file control
        information in some cases, and result in misleading
        error messages concerning unrelated system files. For
        this reason, modify GETANT to check for valid station
        numbers. The ultimate cause of the problem (likely DBCON)
        is being pursued.
        Moved nowhere.

 9220.  January 5, 1997       $APLNOT/TABOTT.FOR          Gustaaf
        The over-the-top routine TABOTT was based on TABNDX. A relic
        from TABNDX, testing for an older version of NX tables, was
        removed. It created problems in TABOTT.
        Moved nowhere

 9221.  January 6, 1997       $APGNOT/LWPLA.FOR           Gustaaf
        LWPLA's default behavior for the font size was not well
        documented. As before, fontsizes =<0 default to 13 point.
        Font sizes exceeding the maximum (17pt) will now default
        to the maximum font, and the user will be informed of this.
        Moved nowhere.

 9222.  January 7, 1997          GPSDL                      Chris
        Fixed a transcription error in GETSIP where the sine of the
        antenna latitude was used in place of its cosine in the
        formula for the azimuth of the source at the ionosphere
        (which lead to errors in the magnetic field projection).
        Moved nowhere.

 9223.  January 8, 1997      LIBR.DAT in many areas         Pat
        Changed $SYSUNIX, $SYSSOL, $SYSSUN, $SYSIBM, $SYSLINUX,
        $SYSALPHA LIBR.DATs to not use directory logical names in
        comments (the OOP tasks did).  Need to do $SYSSOL and $SYSSUN
        versions of LIBR.DAT.SHARED if anyone still uses shared
        libraries.  I think I got them right, may need to watch the next
        few COMLNKS and COMRPLS...
        Moved from CVX this date.

 9224.  January 10, 1997       $YPGNOT/ELINT.FOR           Leonia
        Several minor changes have been made by request of Rick Perley:
        some formats were changed to allow print of the output at the
        larger range;
        the headers of the plots are changed; and so on.
        The codes connected with OPCODE='PWRN' have been simplified.
        Moved nowhere.

 9225.  January 15, 1997      $YSERV/XAS.SHR               Pat
        Removed the peculiar CV-specific (and now obsolete) location for
        the C compiler from the Makefile.  Also inserted a few minor
        comments so that it's obvious what to do on Suns if you don't
        want to use openwin.
        Moved from CVX this date.

 9226.  January 17, 1997      OVLBI simulator          Leonia/Athol
        Add support for new perturbed orbit delay and phase errors.
        New routines written to compute the orbit perturbations are
        $APLNOT/TAUORB.FOR and $APLNOT/ORBERR.FOR. New utility
        routine $APLNOT/DTMATC.FOR used by DTCHK and DTSIM was added
        to match indices in the simulated data common blocks. The
        calling sequence of $APLNOT/DTCALS.FOR was changed with
        supporting modifications in $APGNOT/DTSIM.FOR and
        $APGNOT/DTCALS.FOR.
        Moved nowhere.

 9227.  January 17, 1997      $APGNOT/PCLOD.FOR & . HLP      Athol
        Revise calculation of reference frequency to correctly
        take into account the frequency reference pixel. Task would
        fail without being able to match the pulse-cal frequency
        set to the IF frequencies in the uv-file. Add new adverb
        FQTOL to set the tolerance used in the frequency match.
        Moved nowhere.

 9228.  January 20, 1997           BLING                      Chris
        Reset IRET after calling TABEXI to test for the existence of
        an index table.  The real problem is that ISTAB (which is
        wrapped by TABEXI) sets IRET to an non-zero value if the
        table does not exist although this is a condition that we
        call ISTAB to check; ie. ISTAB doesn't distinguish between
        a table not exising and some error condition preventing us
        from finding out whether a given table exists.  This should
        really be fixed in ISTAB but I'm not sure that sorting this
        out wouldn't have adverse consequences for other tasks that
        use ISTAB.
        Moved nowhere.

 9229.  January 20, 1997    $APGNOT/VLOG.FOR & .HLP           Athol
        New task to segment and re-format the external calibration
        file produced by TSM for each VLBA project. The resulting
        output files can be used directly by ANTAB, APCAL, UVFLG
        and PCLOD and should help to automate a priori calibration
        for a broad range of VLBA projects. This task is VLBA-specific
        and makes some narrow-minded assumptions about the format of
        the input TSM and gain curve files. Nonetheless should be
        useful in a significant number of cases. Trial version
        placed in the system to allow broader testing.
        Moved nowhere.

 9230.  January 21, 1997    $APGNOT/FILLM.FOR                 Gustaaf
        The over-the-top (OT) table that FILLM wrote on request did
        not contain sufficient information for Leonia's task ELINT.
        I have redesigned the OT table format. This is not as serious
        as it seems, since - apart from ELINT - until now only the
        local task BASFT (which does the occasional baseline fitting)
        used this table.

 9231.  January 23, 1997     $APGNOT/JMFIT.FOR               Athol
        JMFIT used a fixed format to print fitted baseline
        parameters. This yielded zero output for sufficiently
        small parameter values and led to some confusion. Corrected
        the appropriate format statements.
        Moved nowhere.

 9232.  January 29, 1997    $SYSUNIX/READLINE.SHR            Pat
        There were some (4) lines in the Makefile.in that state
        "comment-me-out-in-distribution"; these were not commented out
        and were causing problems with Linux builds under Red Hat 4.x
        distributions.  Field reports indicate that commenting them out
        fixes the problem.  Duly commented out.
        Moved nowhere, perhaps should move to patch area?

 9233.  January 29, 1997    $YGEN/YCHRW.FOR                 Pat/Craig
        Changed the multiplier for font size adjustment so that it does
        not override a small font size for 1600 x 1200 monitors.  The
        threshold is now 1800 pixels in X whereas it was 1400.
        Moved nowhere.

 9234.  January 29, 1997   $AIPSPUBL/AIPSMEMO94.TEX & .PS    Athol/Chris
        New AIPS memo. containing results of the recent SGI benchmark
        tests.
        Moved nowhere.

 9235.  January 30, 1997           PCLOD                   Chris
        Made PCLOD friendlier for multifrequency observations.  PCLOD
        no longer aborts if it encounters a frequency group that does
        not match an FQ-ID in the uv file but prints a warning message
        and skips pulse-cal groups until it finds a frequency group
        that does correspond to an FQ-ID in the data file.

 9236.  January 31, 1997          OPTIMIZE.LIS             Jeff
        Turned off optimization for FILL.FOR under Linux.  (Who keeps
        turning this back on?!?)
        Moved nowhere.

 9237.  February 3, 1997      $APLLINUX/ZMOUN2.C           Jeff
        Now checks the block size on SCSI tape drives (Exabytes and
        DAT's) when they are mounted.  If the block size != 0 then I
        explicitly set it to zero, and then restore the old block size
        upon dismounting the tape.  As I recall, we've had similar
        problems on other systems (e.g. AIX) with tapes when the block
        size is non-zero.  Also, ZMOUN2 now reports a bit more about the
        type of tape that is mounted; in addition to reporting it as an
        "ANSI SCSI 1" or "ANSI SCSI 2" device, it will report it as one
        of the following: "DDS", "EXB-8200", "EXB-8500", "DDS-2",
        "EXB-8505 compressed", or "EXB-8205 compressed".
        Moved nowhere, though this should probably be released as a
        patch.

 9238.  February 3, 1997      $INC/AIPSPROTO.H             Jeff
        Added #define of MAXEHEX (value: 36).  Currently only used by
        Linux ZMOUN2 for tracking "original" block sizes on multiple
        tape drives.
        Moved nowhere.

 9239.  February 3, 1997      $APLLINUX/ZMOUN2.C           Jeff
        Corrected an oversight (thanks for the question Pat!): I need to
        keep the original block sizes in a static array since multiple
        tapes can be mounted and unmounted, in arbitrary order, and thus
        each needs to know its original block size separately.  Also, if
        MT_Debug is #define'd as non-zero (i.e. debugging is in
        progress) then the tape will only rewind (*not* rewind + eject)
        at dismount.  This eliminates a really time-consuming annoyance.
        Moved to 15OCT96 patch area this date.

 9240.  February 5, 1997      PRTAB, $APLNOT/TABOTT.FOR    Gustaaf
        Modified PRTAB to accept OT tables as suitable for the DOHMS=1
        option.  Also fixed a type mismatch in TABOTT.
        Moved nowhere.

 9241.  February 5, 1997      $APLNOT/CHEBYD.FOR           Athol
        New subroutine to calculate the first and second derivatives
        of the Chebyshev polynomials. Used in VSOP fringe-fit tests.
        (see $APLNOT/CHEBY.FOR).
        Moved nowhere.

 9242.  February 5, 1997      $APGNOT/DTCALS.FOR           Athol
        Revise this subroutine to calculate rate and acceleration
        calibration errors using CHEBYD.
        Moved nowhere.

 9243.  February 5, 1997      $APGNOT/DTSIM.FOR            Athol
        Revise to use new calling sequence for DTCALS; also
        compute true inverse variance weights if noise specified.
        Moved nowhere.

 9244.  February 5, 1997      $APGNOT/DTCHK.FOR            Athol
        Use new DTCALS calling sequence. Also modify to check BS
        tables produced by BLING, and for rate and acceleration
        errors where possible in BS and SN tables.
        Moved nowhere.

 9245.  February 5, 1997      $QPGNOT/BPASS.FOR           Athol
        Subroutine BPSEL passed a real array to CHNCOP where a
        double precision array was required. This causes
        alignment problems if double load/store is enabled
        (eg. default under IRIX). Declared local DP array to
        avoid this.
        Moved nowhere.

 9246.  February 5, 1997       SEARCH                     Athol
        Add new adverb SEARCH(10) used by FRING to specify
        alternate rerference antennas in initial FFT search.
        Modified POPSDAT.HLP and NEWPARMS.001 accordingly.
        Moved nowhere.

 9247.  February 6, 1997       $APLOOP/UVUTIL.FOR         Ketan
        Added the capability to form scratch files using UV2SCR
        in the OOP system with baseline selection.  This should
        help make scratch files smaller for some tasks.  Although
        some AIPS tasks allow baseline selection through BASELINE
        and ANTENNAS, the underlying AIPS code only allows all
        selection in the sense of all baselines to a list of specified
        antennas. Now, via ABSELECT, ASELECT, and BSELECT, an OOP
        call to UV2SCR can form a scratch data file with only those
        baselines the user desires.  This frees the calling task from
        having to discard unwanted baselines that made it into the
        scratch file.
        Moved nowhere.

 9248.  February 6, 1997       $QPGOOP/GPHAS.FOR          Ketan
        Added flexibility regarding the choosing of the reference
        antenna.  APARM(1)=1 works as before creating a new fictitous
        new antenna.  APARM(1)=0 chooses the most commonly occuring
        reference antenna in the chosen CL table as the new reference
        antenna. APARM(1)=2 lets the user choose via APARM(2) the
        reference antenna number.  APARM(3) also allows the user the
        option to normalize the visibilities before stacking them
        together. [This may be the only right thing to do.]
        Moved nowhere.

  9249. February 9, 1997       $APGNOT/DTSIM.FOR          Athol
        Fix bug introduced in #9243 which caused an error in the
        polarization solutions copied to the AN table.
        Moved nowhere.

  9250. February 10, 1997      $APLOOP/UVUTIL.FOR         Ketan
        Baseline selection as implemented in #9247 gave lots of error
        messages.  Thanks to some friendly advice, these error messages
        have now been suppressed.
        Moved nowhere.

  9251. February 12, 1997      SVANDT in APLNOT           Chris
        New subroutine to solve the transposed Vandermonde system
        of equations used in polynomial interpolation (I'm surprised
        that we didn't have this in a subroutine already).
        Moved nowhere.

  9252. February 12, 1997      FRSRCI in QNOT             Chris
        New subroutine to perform a gridded fringe search with
        interpolation.  This is similar to the QSEARC routine but
        extracts the delay and rate indices from the combined
        1-D index and estimates the fringe position to a fraction
        of a cell by performing simple, quadratic interpolation
        around the peak in each dimension.
        Moved nowhere.

  9253. February 12, 1997        BLING                   Chris
        Now interpolates using quadratic interpolation in delay,
        rate and acceleration.  This has allowed the default
        padding to be greatly reduced so that BLING should be
        much faster than before.  The user still has the option
        of adding extra padding using negative values of APARM(5)
        and APARM(6) but preliminary tests indicate that this
        gives little improvement in precision at a large cost
        in run-time.  Errors quoted in the BS table are now
        wildly pessimistic (by a factor of 10 to 100) in most
        cases.
        Also fixed a sign error in writing out the acceleration
        term.
        Moved nowhere.

  9254. February 13, 1997     FRSRCI in QNOT            Chris
        Fixed faulty logic used to interpolate over the discontinuity
        between cells -1 and 0.
        Moved nowhere.

  9255. February 18, 1997     $APGNOT/VLOG.FOR          Athol
        Corrected a bug affecting INDEX record generation for
        uv-datasets with multiple FQ_ID's. Also added a full history
        section, which was neglected as an oversight in the first
        release.
        Moved nowhere.

 9256.  February 18, 1997      Orbit tables              Athol
        Introduce table access routines for the new spacecraft orbit
        (OB) tables required for OVLB data:
         $INC/POBV.INC - OB table parameters
         $APLNOT/OBINI.FOR - initialize/create an OB table
         $APLNOT/TABOB.FOR - read/write records in an OB table
         $APLNOT/OBREFM.FOR - re-format OB table
        Moved nowhere.

 9257.  February 19, 1997        BLING                 Chris
        Revised the logic for calculating the time spacing in a
        solution interval to reject information from baselines
        that do not contribute to the current solution.  This
        should reduce the chances of the rate window being set
        too wide and including aliased fringes.
        Moved nowhere.

 9258.  February 19, 1997        $QPGNOT/FRING         Ketan
        Added two new features, exhaustive fringe searching and
        subset solve, to FRING.  The FFT stage in FRING
        used to give up too easily when searching for fringes.  Now,
        by setting APARM(9)>0, FRING will exhaustively search all
        baselines, beginning with those baselines to the reference
        antenna specified by REFANT.  Optionally a new control
        adverb called SEARCH can be filled in to specify the order
        in which to use the remaining antennas to search for fringes
        to antennas when REFANT was inadequate.  See the help file.
        The Least Squares Stage now allows you to specify a subset
        of antennas to solve for. I.e. you could specify
        ANTENNAS =1,2,3,4 to include data on all baselines between
        antennas 1-4 but also use DOFIT=1,2 to specify that solutions
        only be computed for antennas 1 and 2 [effectively, baselines
        1-2, 1-3, 1-4, 2-3, 2-4 are used to find solutions for
        antennas 1 and 2].  DOFIT=0 specifies that all antennas are
        solved for, as before.
        Moved nowhere.

 9259.  February 19, 1997        $APLNOT/GCALC2        Ketan
        New routine to be invoked by CALIB instead of GCALC when
        subset solve feature is requested. [ see #9258 and #9261 ]
        Moved nowhere.

 9260.  February 19, 1997        $APLNOT/CLBPA         Ketan
        Added to the call sequence so that GCALC2 is called instead
        of GCALC when the user requests subset solve in CALIB
        [ see #9261 ]
        Moved nowhere.

 9261.  February 19, 1997        $QPGNOT/CALIB         Ketan
        Added the subset solve feature described in #9258 to CALIB.
        As in #9258, the adverb DOFIT can be used to specify a subset
        of antennas to solve for.  DOFIT=0 specifies that all antennas
        are to be solved for, as before.
        Moved nowhere.

 9262.  February 19, 1997        $RUNSYS/*.001         Ketan
        Updated the run files in $RUNSYS to also initialize DOFIT=0 for
        CALIB and FRING and SEARCH=0 for FRING.  The affected files are
        COMAP.001, CROSSPOL.001, CRSFRING.001, DDTHLOAD.001, DDTLOAD.001
        HYB.001, MAPIT.001, VLALLOAD.001, VLACLOAD.001, VLAPROCS.001,
        VLBA.001, MYVLA.001 and TESTVLA.001. [ see #9258 and #9261 ]
        N.B.VLBDDT.001 is also affected but is currently check'ed out.
        Moved nowhere.

 9263.  February 19, 1997        $APGNOT/FILLM         Gustaaf
        PRTAB aborted on encountering NaN values in the TSYS table as
        written by FILLM.  In previous AIPS versions PRTAB would print
        these values anyway, but now PRTAB chokes on them.  There was
        already a check for NaNs in FILLM for solar data only; this
        was now extended to all data.
        Moved nowhere.

 9264.  February 20, 1997        $APLNOT/ORBIT.FOR      Leonia
        The subroutine had a PI error calculating the angle between
        vector of satalite position and its velocity. The error had
        a place only for low half of elliptical trajectory. The error
        did not caused a mistake in the position but caused the mistake
        of velocity for low half of elliptical trajectory.
        Moved nowhere.

 9265.  February 20, 1997          XTRAN                 Chris
        In 1992 the solution code from XTRAN was moved into an APLSUB
        subroutine (XTRFIT) without making any provision to pass back
        the solution vector for the non-linear case.  This resulted
        in XTRAN failing with NPOINTS=6.  Changed XTRFIT to pass back
        the solution vectors as output arguments.  XTRAN could probably
        be made a lot simpler than it is.
        Moved nowhere.

 9266.  February 25, 1997     Argument counts in APLGEN      Chris
        Fixed the number of subroutine arguments for ZV20MC, ZVTPGC
        and ZVTPO3 in APLGEN.  The argument lists for ZVTPGC and
        ZTVPO3 now agree with the UNIX versions of these routines
        and ZV20MC has a dummy FTAB argument to agree with the
        single call made to it (in ZV20XF).
        Moved nowhere.

 9267.  February 26, 1997         EDITA                  Eric/Chris
        New TV task to edit uv data based on calibration tables
        (imprted from the CVX version of AIPS).
        The following files are new from CVX
            EDITA.FOR in QPGOOP
            EDITA.HLP
            FCINI.FOR in APLSUB
            TABFC.FOR in APLSUB
            HLPEDITY.HLP
        The following have been modified
            TABLEUTIL.FOR in APLOOP (added OFCINI and OTABFC)
            QEDIUTIL in QOOP    (aligned with CVX)
            SNEDT.FOR in QPGOOP (aligned with CVX)
            SNEDT.HLP           (aligned with CVX)
            HLPEDISN.HLP        (aligned with CVX)
        Moved nowhere.

 9268.  February 26, 1997          BLING                    Chris
        Fixed faulty stacking logic in DOSOLI that caused the
        intermediate baseline buffer (IBBUFF) not to be cleared when
        baseline stacking was turned off; this lead to phantom
        results for scans without data.
        Moved nowhere.

 9269.  February 27, 1997          COMLNK                   Eric/Pat
        It makes no sense to COMLNK in debug mode only to have the
        sources disappear on you due to PURGE=TRUE being the default.
        Added NOPURGE to the options when DEBUG is found on the command
        line.
        Moved to CVX this date.

 9270.  February 28, 1997         UV_DESC object            Eric/Chris
        Added a TYPEUVD keyword to the UV_DESC object which indicates
        whether the data is true uv data or single-dish data.  Merged
        changes from CVX into
            OBJMNGR.FOR in APLOOP
            UVDESC.FOR  in APLOOP
            UVPHAS.FOR  in APLOOP (checks for TYPEUVD = 'UV')
            QUVUTIL.FOR in QOOP   (checks for TYPEUVD = 'UV')
        Moved nowhere.

 9271.  February 28, 1997           EDITR                  Eric/Chris
        New task (from CVX) that allows interactive editing using a
        display of up to 10 baselines to a single antenna and that
        allows editing based on a secondary dataset (eg. residual
        visibilities).
        Moved nowhere.

 9272.  February 28, 1997           SCMAP                  Eric/Chris
        Enabled the "Edit Data" menu command (from CVX) and added
        APARM(9) to give the averaging time for data editing.
        Moved nowhere.

 9273.  February 28, 1997           FRING                  Ketan
        Change #9258 to FRING left behind two typos in the subroutine
        FRNMSP.  These typos affected only mode APARM(5)=2.  In this
        mode, after finding multi-band delays, the typos made FRING
        less likely to be able to find valid refinements to the
        single-band delays.  Modes using APARM(5)<2 were not affected
        by these typos.
        Moved nowhere.

 9274.  March 3, 1997              BLAPP                   Chris
        Added checks for COLMAP(I) = 0 (indicating no solution expected)
        in code sections that extract results from the least-squares
        solution routines.  This eliminates the phantom solutions that
        were being written to the SN table for missing antennae.
        Moved nowhere.

 9275.  March 5, 1997             $APLNOT/TFILTR.FOR    Leonia/Athol
        New subroutine to calculate rate smearing corrections for
        different types of filtering during time averaging. Includes
        the OVLBI filters implemented in the VLBA correlator.
        Moved nowhere.

 9276.  March 5, 1997             $APLNOT/TABHDR.FOR       Athol
        Modify to recognize the SPACECRAFT_ORBIT table (OB) now
        produced by the VLBA correlator, and containing the
        orbital ephemeris as calculated by SPICE.
        Moved nowhere.

 9277.  March 6, 1997          Correlation id.             Athol
        The VLBA correlator can change correlation modes with
        great flexibility, leading to time-variable rate and
        delay decorrelation corrections which depend on the
        type of frequency and time filtering performed in the
        correlator. The most general solution to this problem is
        to implement a new correlation_id random parameter for
        VLBA datasets which points to the recorded correlation modes
        stored in the existing CQ table. This change required for
        full VSOP support.
        Changed:
         $INC/DUVH.INC: add variable ILOCID.
         $APLSUB/UVPGET.FOR: add support for random param. CORR-ID.
         Moved nowhere.

 9278.  March 6, 1997          CQ table update             Athol
        Add a TABREV keyword to the CQ table and include a check
        for a mismatch between the AIPS version and the table
        version. This does not constitute a format revision.
        Changed:
         $INC/PCQV.INC: add revision level and new keyw. parameters
         $APLNOT/CQINI.FOR: add support as indicated above.
        Moved nowhere.

 9279.  March 6, 1997          Decorrelation corrections   Athol
        Implement new form of decorrelation corrections, using the
        new correlation_id random parameter if it exists. This
        change is backwards compatible with older AIPS versions
        and existing CQ tables. New system allows time variable
        correlation mode changes in general, although only time
        variable OVLB filtering is activated at present. This
        is required for full VSOP support.
        Changed:
         $INC/DSEL.INC: add new decorrelation arrays ITFVBA,
           TVGVBA and ICQVBA. Change the decorrelation array
           indexing from (subarray,IF) to (corr_id,IF).
         $INC/PUVD.INC: add new global parameter MAXCID, equal
           to the maximum expected number of correlation_id.'s
           within a given file.
         $APLNOT/DATGET.FOR: extract the corr_id if it exists
           and pass it to DATCAL.
         $APLNOT/DATCAL.FOR: use new (corr_id,IF) indexing in
           the decorrelation parameter arrays; call new subr.
           TFILTR for rate smearing correction which supports
           the new OVLB filters.
         $APLNOT/SELINI.FOR: initialize ICQVBA; use new DSEL.INC.
         $APLNOT/DSMEAR.FOR: load CQ table using new decorrelation
           parameter arrays.
         $APLNOT/GAININ.FOR: change DSMEAR call to reflect new
           input parameters.
        Moved nowhere.

 9280.  March 6, 1997        $APGNOT/FITLD.FOR        Athol
        New FITLD revision 9.0 to transfer the new spacecraft
        orbit (OB) tables and write output data with the new
        VLBA correlation_id random parameter. The correlation
        id.'s are built up as the data are read, starting from
        an existing CQ table if concatenation is enabled. The
        orbit table is reformatted to comply with AIPS
        requirements through subroutines OBREFM and TABREF.
        FITLD will not concatenate to earlier output files
        lacking a correlation_id random parameter. Also,
        the multiple integration time flag will be set if the
        use of an OVLB filter is detected, and data will be
        accepted out of time order, generalizing the existing
        condition.
        Moved nowhere.

 9281.  March 6, 1997        $APGNOT/DTCHK.FOR & .HLP   Athol
        Add adverb TIMERANG to allow time selection in deriving
        the test compliance statistics.
        Moved nowhere.

 9282.  March 6, 1997        $APGNOT/DTSIM.FOR          Athol
        Fix a bug in subroutine DTANTB which prevented the
        orbital elements from being properly written to the
        AN table.
        Moved nowhere.

 9283.  March 7, 1997        $YPGM/TAPLT.FOR            Athol
        TAPLT has not worked since #9003 due to an insufficient
        buffer size for TABUF. Increased from 256 to 512. Also
        add new feature to exclude blanked table values.
        Moved nowhere.

 9284.  March 7, 1997        $APGNOT/OBTAB.FOR(HLP)     Leonia
        A correlator creates the orbiting table at the case of
        an orbiting antenna at an orbit (in particular VSOP).
        This table includes three coordinates of the orbiting
        antenna and its velocity. The new task fills out the table
        by additional important information such as angle distance
        between the Sun and observing source, condition of the
        Sun eclipse of the antenna by the Earth and position
        angle of the antenna feed. The task reads the line of the
        specified input OB table, calculates the new data and
        records the modified line at the specified output OB table.
        The task provides (optionaly) the estimation of the six orbit
        parameters having used the information about the position and
        velocity of the satalite at the orbit. The found six orbit
        parameters are used to fill out the relevant column at the AN
        table.
        Moved nowhere.

 9285.  March 7, 1997        $APGNOT/MSORT              Ketan
        Introduced new task which reproduces the functionality of
        UVSRT.  MSORT does an in-memory sort of a UV-data file.
        It reproduces all the functionality of UVSRT. At
        best, MSORT should be about 3 times faster than UVSRT [ in
        case when the data is only weakly mis-sorted - as is the
        case for normal VLA and VLBA data].  At worst MSORT should
        take no more than 50% longer.  In either case, MSORT requires
        no ancillary disk space - making this the preferred sorting
        method for large data files.  MSORT does not currently meet
        AIPS coding standards - this will be remedied in the next
        few days.
        Moved nowhere.

 9286.  March 10, 1997       $APGNOT/MSORT              Ketan
        Cleaned up the coding of MSORT.  Removed the BADDISK and ROTATE
        adverbs.  BADDISK is not relevant as MSORT does not use scratch
        files.  ROTATE [see UVSRT.HLP] is no longer supported.  MSORT
        is primiarily needed for VSOP support and proper ROTATE
        implementation may take more time than is currently available.
        [One day _real soon_ ROTATE support will be re-introduced].
        Moved nowhere.

 9287.  March 10, 1997       $APGNOT/OBTAB              Leonia
        A mistake has been discovered at the case of several orbiting
        antennas. It has been fixed.
        Moved nowhere.

 9288.  March 11, 1997  $SYSUNIX/TVDEVS.SH, START_AIPS    Pat
        These scripts, and their possible counterparts in the AIPS_ROOT
        area, were expanding the AIPS_ROOT variable before performing
        any remote shell command.  This is not a good idea in a hetero-
        geneous environment with possibly different AIPS_ROOT values.
        CVX has had this problem corrected for some time; imported this
        here finally today.  NOTE: changes in START_AIPS need to be
        merged with midnight job sites' versions in AIPS_ROOT!!!!
        Moved from CVX and to lemur's /export/laips/AIPS/ today.

 9289.  March 11, 1997       $YPGM/BLANK.FOR             Leonia
        Michael Bietenholz noticed that the task blanks with 0.0 when
        opcode 'TVCU' is used; even though it claims to blank with DPARM(6)
        if DPARM(5) >0. Originally there was no parameter DPARM(6) at all.
        So the task blanked with 0.0 if DPARM(5) >0. Having introduced
        DPARM(6) the relevant changes were made in subroutine DO1BLK,
        leaving subroutine DO1TVB without change. So DPARM(6) has been used
        in all opcodes except opcode = 'TVCU'. I have fixed it correcting
        several comments as well.
        Moved nowhere.

 9290.  March 11, 1997       $APGNOT/FITLD.FOR            Athol
        Fix bug introduced in #9280. FITLD produced unintelligible data
        for an older revision of the correlator output format. Now
        corrected.
        Moved nowhere.

 9291.  March 12, 1997       $YPGNOT/VPLOT.FOR            Leonia
        The selection criteria UVRANGE was introduced for SOLINT > 0.
        It was erroniously missed early.
        Moved nowhere.

 9292.  March 13, 1997       $RUNSYS/VLBDDT.001           Athol
        Add support for new adverbs recently introduced for FRING,
        CALIB and DTCHK.
        Moved nowhere.

 9293.  March 14, 1997       $APGOOP/DTSUM.FOR        Pat/Martin Shepherd
        DTSUM prints a table of visibility counts versus baseline.  When
        this table becomes too wide to show on the printer in one go, the
        table is split into two parts.  The bug caused the second part of
        the table to show repeat values of the first part of the table and
        to label antenna number columns as all zero.  This was actually
        due to two bugs.  The first was that variable II was being used
        for two exclusive purposes within the same loop, and the second
        was that an antenna index was getting reset to zero on the second
        pass instead of taking on the value for the first antenna of that
        pass.
        Moved from Caltech today (finally!  Sorry for the delay - Pat)

 9294.  March 14, 1997       $APGNOT/SPLIT.FOR            Leonia
        SPLIT has sent zeros for RESTFQ and LSRVEL to catalog in the case
        of single source file. It was happenning because these values
        were taken from SU table which is absent for the single source file
        data. At the same time any single source file is a result of
        SPLIT aplication to an original multi source file. At this stage
        the RESTFQ's and LSRVEL's values are recorded at the catalog.
        At the single source file zeros were recorded to the catalog.
        So I left this recording only for multi source data saving
        the original values for single source files.
        Moved nowhere.

 9295.  March 14, 1997         FRSRCI in QNOT             Chris
        Added simple phase interpolation to this fringe search routine
        (used by BLING).
        Moved nowhere.

 9296.  March 14, 1997             BLING                  Chris
        Stopped BLING from writing garbage to the BS table for scans
        where data is missing.
        Moved nowhere.

 9297.  March 17, 1997             $APGNOT/DBCON.FOR      Athol
        Update DBCON to mirror the new common block structure in
        $INC/DUVH.INC resulting from the introduction of the CORR-ID
        random parameter in #9277 above. Modify /CATHDR/, which
        expects to be a copy of /UVHDR/; also update the number
        of words copied in FRMAT used to enforce the equivalence.
        Moved nowhere.

 9298.  March 19, 1997             $APGNOT/MSORT          Ketan
        Noticed that in #9286 I had missed some references to UVSRT,
        the progenitor to MSORT.  Removed them.
        Moved nowhere.

 9299.  March 19, 1997             $APGNOT/RESEQ          Ketan
        SVLBI will require the ability to alias stations together
        at some points in the data reduction stream.  This is the first
        step for that requirement.  RESEQ is a new task which will,
        via the ANTENNAS input, renumber antennas in a UV file.
        RESEQ will renumber all antennas specified in the ANTENNAS
        adverb to ANTENNAS(1).  also placed RESEQ.HLP in $APGNOT.
        Moved nowhere.

 9300.  March 20, 1997             $APGNOT/TBOUT.FOR      Athol
        TBOUT failed with a floating point exception on DEC Alpha
        systems due to an invalid floating point comparison in
        subroutine PUTPAS. Other architectures are not affected.
        Use H2CHR to avoid the FPE.
        Moved nowhere.

 9301.  March 20, 1997             $APGNOT/VBGLU.FOR      Athol
        VBGLU was failing on DEC Alpha systems for certain direct
        Hollerith comparisons in VBGLIN, where the comparison was
        made as floating point values. Replace with CHCOMP calls to
        avoid FP exceptions at times.
        Moved nowhere.

 9302.  March 27, 1997             $APGNOT/RESEQ          Ketan
        RESEQ only allowed remapping of multiple antennas to one
        specific antenna.  Now, via an optional INFILE, RESEQ can
        remap antennas numbers to some desired order.  Also fixed
        up the access routines to UVDISK and UVINIT.
        Also updated RESEQ.HLP to reflect the new options.
        Moved nowhere.

 9303.  March 27, 1997             $APGNOT/MSORT          Ketan
        The computation of buffer size for disk access via UVINIT
        and UVDISK was screwed up so that for very large record length
        data files, this task died just after startup.  Fixed up
        the routines accessing UVINIT and UVDISK.
        Moved nowhere.

 9304.  March 29, 1997             $APGNOT/DTSIM          Ketan
        A typo in the subroutine DTFILL caused file access problems
        via ZEXPND when DTSIM is used to generate _very_ small files.
        Moved nowhere.

 9305.  March 30, 1997             $APLNOT/AVERT.FOR     Leonia/Athol
        New subroutine to find the integration times in a uv dataset
        if the random parameter ILOCIT is defined.
        Moved nowhere.

 9306.  March 30, 1997             $QPGNOT/FRING.FOR     Leonia/Athol
        First pass at supporting baseline stacking for multiple
        integration times, as required by VSOP. Sparse baselines
        are padded with duplicate values before the initial FFT
        step. Weights and the SNR calculation are adjusted accordingly.
        Will search the data using AVERT if DPARM(4)=0. Will be
        refined in the coming weeks. Updated .HLP accordingly.
        Moved nowhere.

 9307.  March 30, 1997             $APLSUB/DSORT.FOR    Athol
        New DP sort routine, cloned from RSORT.
        Moved nowhere.

 9308.  March 30, 1997             $APGNOT/DTCHK.FOR    Athol
        Add antenna selection; also non-parametric pseuodo-variance
        estimation to be less vulnerable to single outliers than
        using only RMS. Needed for VSOP fringe-fit tests. Modify
        DTCHK.HLP accordingly.
        Moved nowhere.

 9309.  March 31, 1997             $HLPFIL/FRING.HLP   Leonia/Athol
        DPARM(4) description has been changed in accordance of last
        change of FRING.FOR (see 9306).
        Moved nowhere.

 9310.  April 2, 1997              $APLNOT/BACOOR.FOR  Leonia
        The misprint at the sign of one formula describing rotation
        of coordinates has been discovered. This misprint affected
        model plot of orbiting VLBI plotted at the VPLOT. It fixed.
        Moved nowhere.

 9311.  April 3, 1997              $YPGNOT/VPLOT.FOR   Leonia
        Compile VPLOT with the new BACOOR (see 9310)
        Moved nowhere.

 9312.  April 3, 1997              $YPGNOT/CLPLT.FOR   Leonia
        Compile CLPLT with the new BACOOR (see 9310)
        Moved nowhere.

 9313.  April 6, 1997              $QPGNOT/FRING.FOR      Ketan
        There was a variable in FRNSRC [IS1] that long ago had been
        discovered to be mis-declared.  Unfortunately, the subroutine
        FRNALL, which implements the new SEARCH mode, was based upon
        an older version of FRNSRC.  Unfortunately, FRNALL still had
        the old value of 2048 - this has now been updated.
        Moved nowhere.

 9314.  April 7, 1997              $YPGNOT/VPLOT.FOR     Leonia
        I have added new information at the header of plots, following
        requests of people. VPLOT has provided information about the CC
        table version of the image ising in the modeling and has not
        informed the image file name itself. I have added the image file
        name at the third line of the header. I have added also information
        about CL table number (if. DOCALIB) and FG table number at the
        second line of the header. The information about CL and FG tables
        is not given at the case AMP. and PHASE plot (BPARM(2) < 0)
        because lack of room at the line at this case.
        Moved nowhere.

 9315.  April 7, 1997              PUVD.INC              Gustaaf
        CALIB failed on data taken with a 84-element Heliograph. This
        was caused by a too low maximum baseline table size XBTBSZ as
        defined in PUVD.INC.  XBTBSZ was increased to 16384, causing
        a massive recompile and link of lots of AIPS routines.

 9316.  April 7, 1997              START_AIPS            Pat
        The secure shell (ssh/slogin) and its daemon (sshd) complicate
        the login sequence somewhat when the X tunneling feature is
        implemented (e.g. you're on foo, slogin bar, DISPLAY will be set
        to bar:1.0 and "tunnelled" in an encrypted form through the
        login back to foo's server and not via the usual X port).
        Fortunately there's a way to detect this (SSH_CLIENT is set in
        the environment).  The part of this script that attempts to
        figure out "where are you" -- which is absolutely NOT
        guaranteed; it's at best an educated guess -- should now work
        correctly in such an environment.  The part that will start the
        TV on the remote host is still a bit flaky, and will only work
        if AIPS_ROOT is defined in a remote shell (rsh or ssh)
        environment.  But that's another problem...
        Moved nowhere yet.

 9317.  April 8, 1997              $APLPGM/PRTAB.FOR      Ketan
        PRTAB did not print out the keyword values to full precision
        even though there is plenty of space since each keyword/value
        pair occurs on a separate line.  motivated by SVLBI considerations.
        Moved nowhere.

 9318.  April 8, 1997              $QPGNOT/FRING.FOR      Ketan
        There was a typo in FRNSRC [and so also in FRNALL] relating to
        the amount by which the FFT padding size was decimated when the
        AP size limititation became an important consideration.
        Moved nowhere.

 9319.  April 15, 1997             $APGNOT/CLCAL.FOR      Ketan
                                   $APLNOT/SN2CL.FOR
        CLCAL now allows pass-through calibration, as well as 'proper'
        FQID and SOURCEID selection.  By choosing 'CALP', CLCAL can
        now be made to pass CL table records for which no SN table
        record is found.  This is dangerous but necessary if SN tables
        are constructed piecemeal as may be necessary for VSOP data.
        SN tables generated by single source data files and by OOP
        tasks may contain FQID=-1 and/or SOURCEID=0.  Such entries
        should match ALL CL table records.  This is perfectly obvious
        for FQIDs but a bit ambiguous for SOURCEIDs.
        Moved nowhere.

 9320.  April 15, 1997             $QPGNOT/FRING.FOR      Ketan
        The format statements in FRING have been revised.  This was
        instigated by the need for more digits to be printed during
        HALCA fringe searches.
        Moved nowhere.

 9321.  April 17, 1997             $APLNOT/ORBIT.FOR     Leonia
        The subroutine returns back the input parameters of the orbit.
        Because the input parameters are changed inside the subroutine
        it could not be used in cycles. I renamed the input parameters
        inside the subroutine.
        Moved nowhere.

 9322.  April 18, 1997 $APGNOT/DTSIM.FOR, $APLNOT/BACOOR, ORBERR Leonia
        I have comlnked (comrpled) $APGNOT/DTSIM.FOR, $APLNOT/BACOOR.FOR,
        $APLNOT/ORBERR.FOR due to change of ORBIT.FOR. (look #9321)
        Moved nowhere.

 9323.  April 18, 1997            dbgwrap utility                Chris
        Added the source for a small program that allows an AIPS user
        to switch debuggers on the fly to SYSUNIX.  If dbgwrap is
        specified as a debugger the user will be prompted for a
        debugger to use every time he types GO with debugging enabled.
        This was motivated by a need to run AIPS tasks under the SGI
        performance monitoring tools which require a number of command-
        line arguments that can not be supplied using the standard
        AIPS debugging interface.
            New files are
                DBGWRAP.C in SYSUNIX     (program source)
                DBGWRAP.DOC in SYSUNIX   (documentation)
            Note that DBGWRAP.C is C++ not C (the Standard Template
        Library reduces the amount of code needed for this utility
        by a significant amount).
            This utility is, of course, not necessary for running AIPS.
        Moved nowhere.

 9324.  April 20, 1997            $QPGOOP/CL2HF.FOR         Ketan
                                  $QPGOOP/HF2SV.FOR
        Dave Gordon of USNO has made extensive[?] modifications to
        CL2HF and HF2SV which was originally written by Ed Fomalont.
        Ed has blessed the upgrade of these two tasks by Dave Gordon's
        replacements.  I have pushed Dave's modifications through the
        SOL compiler and have removed most non-standard FORTRAN stuff.
        Compilation still gives some warnings about I*2 which Ed says
        is necessary to use.  CL2HF.HLP and HF2SV.HLP will be modified
        in the _near_ future to recommend the user to Dave Gordon's
        guide for Geodesy/Astrometry data reduction in AIPS.
        Moved Nowhere.

 9325.  April 20, 1997            $APGNOT/JMFIT.FOR         Ketan
        Although JMFIT is properly driven by using small regions around
        the image features being fitted, sometimes these regions can
        have lots of pixels across them.  I have encapsulated the
        declarations of the max. number of pixels that JMFIT can deal
        with and increased it from 2025 to 10000.
        Moved Nowhere.

 9326.  April 21, 1997                BLING                 Chris
        Inserted a test on AEXIST(A) to the baseline stacking loop
        in DOSOLI so that BLING does not examine baselines for
        which they can be no data.  Not only did the lack of this
        test introduce unneccessary computations into this loop
        but the memory hits on unused areas of the intermediate data
        buffer, IBDATA, lead to cache-line contention on the Origin
        200 (and probably other machines) making baseline stacking
        a severe performance bottleneck.  Run-time has improved from
        107 sec to 17 sec on the Origin for the VLBDDT test case:
        the L2 data cache hit rate has gone from 29.8% to 98.3%.
        Moved nowhere.

 9327.  April 16, 1997            PRINTER                    Pat
        Added the ability to change your AIPS printer on the fly from
        the POPS command line.  This was achieved via a new verb PRINTER
        and some revision of the shell scripts.  New files added :
            $AIPSUB/PRINTR.FOR: show current printer, show a list, or
                                change to a different printer.
            $HLPFIL/PRINTER.HLP: describe how to use it:
               PRINTER 0 or PRINTER to show current printer;
               PRINTER n (n <= max printer) to change printer; and
               PRINTER n (n > max, e.g. 999) to list available printers.
        Changed were:
            $AIPSUB/AU1.FOR: code for new verb added.
            $RUNSYS/NEWPARMS.001: add new verb
            $HLPFIL/POPSDAT.HLP: add new verb
            $SYSUNIX/START_AIPS: new method for defining printer
                                 environment variables, plus faster loop
                                 (in awk) to display the menu; this
                                 significantly speeds up the startup.
                                 NOTE: $AIPS_ROOT version of this needs
                                 to be merged with these changes.
            $SYSUNIX/ZLASCL: use new variables, remove obsolete code
            $SYSUNIX/ZLPCL2: same thing.
        With this new way of addressing printers, the PRDEVS.SH file is
        no longer needed.  INSTEP1 needs to be modified to not bother
        with it, and perhaps $SYSUNIX/PRDEVS.SH itself needs to be
        deleted from the system.
        Note: It may be necessary to remove the older versions of ZLPCL2
        and ZLASCL and replace with symlinks to the newer versions for
        sites that maintain more than one version of AIPS.
        Moved from CVX (#9399), with minor enhancements (null printer).

 9328.  April 24 1997       Printers under UNIX             Chris
        The previous change introduced an environment variable named
        LPTYPE into the AIPS environment: this variable is also
        interpreted by the SVR4 print service resulting in a complete
        failure of AIPS printer support under Solaris 2.x.
        Changed LPTYPE to PRTYPE in START_AIPS, ZLPCL2, ZLASCL (all
        in SYSUNIX), and PRINTR.FOR (in AIPSUB).
        Moved nowhere.

 9329.  April 30 1997      $APGNOT/OBEDT.FOR                Leonia
        The orbiting VLBI provides some additional requirements which do
        not have a place at the case of the classic ground based VLBI
        network. For example the Sun can be eclipsed for the orbiting
        antenna and as a result the battery will not be charged properly
        and the whole orbiting hardware will not work properly. So the
        user can want to flag such data in advance. He can want to flag
        data using another parameter (distance, speed ..) as a criterium.
        The new task OBEDT allow to flag the orbiting antennas data under
        control of OPTYPE (five options) and the lower and upper limit
        of the selected parameter. The data are flagged if the selected
        parameter is between these lower and upper limits. In principle
        the value of the selected parameter could be taken from the OB
        table. But possible big gaps in time at the OB table could
        provide errors at the estimation of the edge times. To circumwent
        this problem the task uses the AN table reading the six
        parameters of the orbits. If the AN table is not filled out by the
        orbits parameters, the task reconstructs the orbits using OB
        table data. If OB table does not exist, an user can use the orbit
        determined by selected six parameters. In the all three cases
        the value of the selected (by OPTYPE) parameter is calculated with
        the selected time step.
        Moved nowhere.

 9330.  April 30 1997   ZMOUN2, ZTAP2 in APLSGI          Chris
        ZMOUN2.C and ZTAP2.C in APLSGI have been revised for IRIX 6.x.
        Non-rewind, variable-blocksize devices should be used (eg. an
        Exabyte 8500 as device 5 on SCSI adaptor 1 should be listed in
        TPDEVS.LIST as /dev/rmt/tps1d5nrv.8500) and mediad should be
        configured to ignore any tape devices used by AIPS (mediad
        makes it impossible to use variable blocksizes).  Exabytes,
        DATs and 9-track tapes are nominally supported.  Exabyte
        compression modes are not supported at this time, however.
        I have verified that FITS files can be exchanged between
        IRIX and Solaris systems on Exabytes at both high and low
        density: other file formats and device types have not yet been
        tested.
        The old ZMOUN2.C and ZTAP2.C, which do not compile under IRIX 6
        have been renamed ZMOUN2.CI5 and ZTAP2.CI5.
        Moved nowhere.

 9331.  April 30, 1997              TABINI                 Chris
        Modified TABINI to use manifest logical constants rather than
        variables initialized to .TRUE. and .FALSE..  On the SGI
        F was being initialized to 00000000 hex if TABINI was not in
        a library and ffffff hex (interpreted as true) if it was in
        a library (at least when called from FITTP).  This is
        clearly an IRIX bug but the code clean-up is probably
        desirable anyway.  Similar problems may be lurking elsewhere.
        Moved nowhere.

 9332.  May 2, 1997              VBGLU                    Chris
        Added some missing terms to the tests that determine which
        file a given IF comes from in the 3-file and 4-file cases.
        The output FQ table should new be correct for 3 and 4 file.
        Moved nowhere.

 9333.  May 5, 1997              $QPGNOT/CPASS.FOR        Athol
        Correct a word alignment error in BPSEL, which passed a
        real array to CHNCOP where a double precision array
        was required (see #9245 above). This failed on the SGI
        system which has double load/store as a default, but had
        no effect on other architectures. Also added check in
        XPSCAL to avoid divide by zero for null spectra, and
        changed erroneous reference to CPASSPRM to the correct
        BPASSPRM.
        Moved nowhere.

 9334.  May 6, 1997               $YSUB/PLINIT.FOR        Ketan
                                  $YSUB/PLAXES.FOR
                                  $YSUB/PLPNT.FOR
                                  $YSUB/PLPGO.FOR
                                  $YSUB/PLLINE.FOR
                                  $YSUB/PLDRW.FOR
                                  $YSUB/PLCLOS.FOR
                                  $INC/DPLD.INC
        Athol has implemented a _small_ subset of 'PGPLOT-like'
        routines within APCAL.  These routines have now been used
        within OBPLT as well.  Therefore, these routines have been
        extracted from within APCAL.FOR and are now going into $YSUB
        and $INC
        Moved nowhere.

 9335.  May 6, 1997               $YPGNOT/OBPLT.FOR      Ketan
                                  $HLPFIL/OBPLT.HLP
        OBPLT is a new task which allows various columns of the
        OB table to be plotted against each other.  By design, the
        inputs are minimal.
        Moved nowhere.

 9336.  May 7, 1997               $YPGNOT/OBPLT.FOR      Ketan
        I tried to pull one over on the compilers, the LINUX
        compiler found me out and complained about calling sequences
        not being aligned.
        Moved nowhere.

 9337.  May 8, 1997               FNDEXT                 Athol
        Space VLBI requires support for more than 20 tables, as
        currently accomodated in the catalog header. This limit is
        already exceeded for some VLBA projects. Start changes to
        increase this limit by encapsulating access to this part
        of the header, and then re-use the existing WCS pointers,
        which are defined but not used, to allow more tables. This
        defers a format change for a few years, and is backwards
        compatible.
         Adopt an incremental approach to this update; as a first
        step replace direct catalog header access with FNDEXT
        calls in the following $APGNOT tasks:
            CANPL      CLCAL      CLSMO      DBCON      GETJY
            SNSMO      LWPLA      SDCAL      SDTUV      SLCOL
            SPLIT      SWPOL      TABED      TXPL       SPCAL
        Moved nowhere.

 9338.  May 8, 1997               $RUNSYS/NEWPARMS.001   Ketan
                                  $HLPFIL/POPSDAT.HLP
                                  $APLSUB/ALIASA.FOR
                                  $APLSUB/ALIAS.FOR
                                  $YPGNOT/VPLOT.FOR
                                  $HLPFIL/VPLOT.HLP
        A new adverb called ALIAS has been introduced for use in
        SVLBI applications.  Together with this adverb, two
        subroutines were added.  The subroutine ALIASA should be
        used to rearrange the ALIAS adverb list into a more
        suitable form.  The subroutine ALIAS should be used to
        determine if any antenna is supposed to be aliased into
        another antenna.  The ALIAS keyword has been implemented
        in VPLOT.  Search VPLOT for instance of ALIAS for an
        example of the implementation of the ALIAS keyword.
        Moved nowhere.

 9339.  May 8th, 1997             $YPGNOT/APCAL.FOR      Ketan
        The plotting routines in #9334 were based upon routines
        in APCAL and in this revised version of APCAL, those
        routines no longer appear internally.
        Moved nowhere.

 9340.  May 13, 1997              FILLM                  Gustaaf
        Decided to put back the version of FILLM with the Van Vleck
        correction as a - hidden - option.  I am pretty sure it
        works, but so far we have been unable to find data that
        would benefit and I could test it on.  Main reason is a
        saturation effect in the online system that clips high
        correlations - which are the ones that benefit from Van
        Vleck correction in the first place.  We need to wait for
        D-array to properly test this; until then the option will
        remain hidden, but the code is all there.
        Moved nowhere.

 9341.  May 13 1997            GPSDL                  Chris
        Added a fiddle-factor to adjust the predicted Faraday
        rotation to agree with that measured in the April
        test run.  Added an option to provide diagnostic
        printout.  Changed the TECMOD subroutine to use the
        LAPACK routine SGELSS and to buffer GP table data.
        Moved nowhere.

 9342.  May 14, 1997              FILLM               Gustaaf
        In # 9340 I left some test code in which I thought was
        innocuous. It wasn't.  Took it out.
        Moved nowhere.

 9343.  May 15, 1997             FITLD               Phil
        Several minor problems had accumulated. Saved the fixes
        until now:
        (1) Users were complaining that FITLD was finding subarrays
            in their data when there weren't any. In fact there are,
            since when changing sources rapidly the log based nature
            of the correlator results in fuzzy scan boundaries since
            some telescopes get to the new source more quickly than
            others. The VLBA on-line group are looking at this problem
            but in order to demonstrate that subarrays exist I print
            the offending information with the subarray message.
        (2) Some old data have the occasional source number of 0 in the
            distribution FITS files. Fixed FITLD to skip such entries.
        (3) The correlator now writes CALCODES. The FITLD code to check
            whether a source in an incoming file matches an existing
            source in the file on disk was changed to compare only the
            first character of the CALCODE string. Previously the
            comparsion was failing and the SU table was bloated with the
            result that SPLIT would run several times on the same
            source.
        (4) Ensured that the IM table is correctly sorted after each
            file is loaded. This was causing problems for rapid source
            switching observations.
        (5) Ensured that the CATBLK is updated after the CQ table is
            created.
        Moved nowhere.

 9344.  May 15, 1997         $YPGNOT/FRMAP.FOR, FRMAP.HLP    Leonia
        The FRMAP.HLP file provided wrong information about used polarisation.
        The label of the plots at the case STOKES = '    ' was wrong.
        The FRMAP can handle two polarization combination; RR or LL.
        If STOKES = '    ' RR is handled. The relevant small change at
        FRMAP.FOR and FRMAP.HLP is provided.
        Moved nowhere.

 9345.  May 16, 1997         FILLM                           Gustaaf
        The data format on the Modcomp tape involves a scale factor
        and its exponent.  Due to saturation of very strong sources
        the VLA online code was recently modified to allow this
        exponent to be of the opposite sign. This caused a logical AND
        in the FILLM code to fail.  This AND (which was there for very
        old formats only and until now worked fine on new format data
        too) has now been removed for data formats after 1988.
        Moved nowhere.

 9346.  May 18, 1997         FITLD                          PHIL
        In change 9343 I forgot to update FITLD's welcoming message.
        Now done.
        Moved nowhere.

 9347.  May 20, 1997              BLING                      Chris
        Added summary reports giving delay, rate and acceleration
        for each solution interval and polarization for which fringes
        were found.
        Moved nowhere.

 9348.  May 20, 1997       $QPGNOT/EDITA, EDITR, SNEDT       Leonia
        The task EDITA has not worked when RATE editing. The problem was units.
        The units of delays are sec and of rates are sec/sec.  The normal
        values for these are then around 1.e-9 and 1.e-12.  In
        $QOOP/QEDIUTIL.FOR, subroutine EDMXMN there was a 1.E-8 test on
        reasonable which was two big for rate. It was changed to 1.e-14.
        The problem was figured out by Eric Greisen. EDITR and SNEDT use
        $QOOP/QEDIUTIL.FOR also so they were comlnked as well.
        Moved nowhere.

 9349.  May 20, 1997       FNDEXT                            Athol
        Continuation of #9337. Add FNDEXT calls in:
        $APLPGM:  PRTPL, QMSPL, TACOP, TKPL.
        $QPGNOT:  BLCAL, BPASS, CALIB.
        Moved nowhere.

 9350.  May 21, 1997       PCLOD                            Leonia
        The default value for FQTOL has confused people. It was exact match.
        For some reason exact match does not have a place in many cases.
        At the same times in major cases there is no requirements to the
        frequency match. That's why I changed the default for FQTOL from
        exact match to ignore match. It was done adding additional condition
        in subroutine MATFID.
        Moved nowhere.

 9351.  May 23, 1997        POSSM                          Phil
        Trivial change to tidy up a format statement.
        Moved nowhere.

 9352.  May 23 1997           PARALLEL verb                Chris
        Added a PARALLEL verb to AIPS which controls the number of
        processors that will be used for AIPS tasks that have been
        compiled with multiprocessor support.
           Changed AU2.FOR in AIPSUB and POPSDAT.HLP in HLPFIL.
           Added ZPARAL.FOR in APLGEN, APLSOL and APLSGI and
        PARALLEL.HLP in HELPFIL.
        Moved nowhere.

 9353.  May 23, 1997       $APLNOT/APLPBI                 Pat/Martin S.
        Implemented a bug fix at Martin Shepherd's request: APLPBI was
        failing to apply the primary beam cutoff to non-VLA
        (i.e. gaussian) primary beam corrections.
        Moved nowhere.

 9354.  May 27 1997        Astrometry Tasks     Chris for David Gordon
        Updated CL2HF, HF2SV and their corresponding help file.  Added
        a HELP ASTROMETRY file giving an overview of astrometry/geodesy
        processing in AIPS.
        Moved nowhere.

 9355.  May 30 1997              PRTAB                Eric/Chris
        Merged in changes to allows column and array-range selection
        from CVX.  Also added BS and GP tables to the list of tables
        recognized as having TIME columns and fixed the long-lived
        character transposition in `ASCII'.
        Moved nowhere.

 9356.  June 4, 1997          g77-inspired fixes       Eric/Jeff
        $AIPSUB/GETFLD.FOR: Fixed call to GETSTR to pass length argument
        of 80 vice 132.  This fixes the problem with POPSGN et
        al. crashing under g77 (and sometimes f2c/gcc).
        $AIPSUB/KWICK.FOR: Increased size of STRING from 80 to 132 to
        handle max string size now allowed in AIPS.
        $APLSUB/GETSTR.FOR: Set full out string blank w/o length
        parameter, use LMAX = min (NMAX, len (outstr)) instead of NMAX.
        (This is where the stack-stomping was taking place under g77,
        thanks to the incorrect argument passed in from GETFLD.)
        Moved from CVX this date.

 9357.  June 5, 1997           $SYSUNIX/CAD               Pat
        Created a perl script to Check an AIPS Data area (CAD).  This
        will, given a usernumber and a directory name, check for minimal
        consistency in the files that represent the user's catalog on
        disk.  All slots represented by the existing files are checked
        to make sure they have a CB file, and either a MA, UV, or SC
        file as well.  Zero-length files and missing files cause it to
        scream.  For each catalog slot in which something is wrong, it
        lists exactly what it found.  When programs get killed
        unexpectedly (e.g. power outage), this can be invaluable in
        seeing if one has to clean up a user's catalog with RUN RECAT.
        Moved to CVX this date (change #9446).

 9358.  June 10, 1997      $AIPSUB/AU3A, $APLSUB/MDESTR     Pat
        Added sanity checking to these routines so that they only check
        for realistic extension numbers and types.
        Logic moved from CVX's FXHDEX today.

 9359.  June 10, 1997      $YPGNOT/IBLED and .HLP           Athol
        Modify IBLED to allow an overlay plot of model amplitude
        as derived from an external CLEAN component table. This
        plot can be selected or de-selected using a new
        "PLOT MODEL" option of the left-hand menu. The model
        plotting supports multi-field data, and is useful for
        editing gravitational lens datasets in particular.
        Moved nowhere.

 9360.  June 12, 1997      $APGNOT/SNSMO.FOR and .HLP      Athol
        Miscellaneous fixes and changes accumulated in local
        versions: i) allow smoothing of tables attached to single
        source files; ii) add new smoothing option 'DELA' for
        smoothing of delays only; iii) add feature to control
        whether existing flagged solution entries are interpolated;
        activated using BPARM(6); iv) make messages more informative;
        no message regarding clipping unless selected; message
        regarding re-referencing now includes percentage of entries
        re-referenced; v) replace SNVER adverb with INVERS and
        OUTVERS to avoid preliminary TACOP step; vi) fix what
        appears to be a bug in SNREF; phase always re-referenced but
        delay and rate were only re-referenced for VLBI and VLMB
        smoothing modes. This allows the possibility of partial
        re-referencing; corrected this.
        Moved nowhere.

 9361.  June 17, 1997     $APGNOT/SNCOR.FOR                Leonia
        When SNCORRPRM(1) > EIF, the parameter SNCORRPRM(1) has been
        forced to one for several opcode where IF's were involved.
        In particular if OPCODE = 'cpsn', the task has coppied the first IF
        to the all determined range of IFs, if SNCORRPRM(1) > EIF.
        If EIF=0 then the condition looks reasonable because EIF is
        recalculated to the maximum available IF at the data. But if
        EIF is fixed and EIF is less than maximum available IF at the data
        the condition provides a mistake copping the first IF instead of
        desiring one which is more than EIF. To fix this bug I have
        change the condition (in subroutine SNCCOR)
        SNCORRPRM(1) > EIF on
        SNCORRPRM(1) > maximum available IF at the data.
        Moved nowhere.

 9362.  June 17, 1997     $APLNOT/POLINO.FOR               Leonia
        The new routine POLINO.FOR fits a polinom up to 19 degree
        by least square method.
        Moved nowhere.

 9363.  June 17, 1997     $APGNOT/ACFIT.FOR                Leonia
        Lincoln Greenhill comlained that algorithm of fitting polinoms
        to find a baseline of spectra (in ACFIT) gives erronios result
        on his data. The algorithm used by ACFIT is very cloudly.
        I decided to write a separate general purpose routine for
        fiting a polinom to data (see #9362) and in particular to use
        it at ACFIT.
        Moved nowhere.

 9364.  June 20, 1997      $APGNOT/FITLD                   Phil
        Some changes for SVLBI and two bug fixes.
        1) The VLBA correlator group would like to ensure that FITS
        tables are no longer than 200 Mbytes and so they split a uv
        output table into several inside a single FITS file. FITLD could
        not handle this due to shortcuts taken in the file handling when
        it was first written. Corrected this.
        2) Ensured that the CQ table is not generated for data from
        correlators other than the VLBA.
        3) Penticton is writing the data weights as a spectrum - a legal
        thing to do. When the code was added for correlation-ids the
        handling of the weights was disrupted slightly. Fixed.
        4) A bug in the concatanation of files with source selection was
        fixed. The symptom was that source selection was ignored. I'm
        surprised this one hadn't bitten before, the circumstances in
        which it was seen were not bizarre.
        5) Ensured that the antennas are renumbered from file to file
        when necessary in the MC table. This is done for all other
        tables but was missed in this case.
        Moved nowhere.

 9365.  June 23, 1997      $YPGNOT/VPLOT                    Leonia
        Long time actually since the beginning VPLOT has printed at
        the header CC table version even if the model is not going
        to be plotted. It is annoyed people. Now CC table version
        together with the related image file name is printed only if
        the model is supposed to plot.
        Moved nowhere.

 9366.  June 23, 1997      $APGNOT/CLCAL.FOR & .HLP         Athol
        Merge some CLCAL changes accumulated in local versions
        into TST. These include: i) add new adverb, CUTOFF, to specify
        a maximum time interval over which interpolation is to
        be performed; ii) do not pass blanked CL entries to the output
        CL table. Modified:
         $APLNOT/SN2CL.FOR - implement (i) and (ii).
         $APGOOP/BLAPP.FOR - modified call sequence to SN2CL.
        Several files in $RUNSYS to include new CLCAL adverb:
         MYVLA.001       TESTVLA.001      VLACLOAD.001
         VLALLOAD.001    CROSSPOL.001     VLBA.001
         VLAPROCS.001
        Moved nowhere.

 9367.  June 24, 1997      FNDEXT                           Athol
        Continuation of #9349. Update table access using FNDEXT in:
        $QPGNOT:  FRING.FOR, PCAL.FOR and LPCAL.FOR.
        $QYPGNOT: MX.FOR
        $YPGM:    GREYS.FOR and TVPL.FOR.
        Moved nowhere.

 9368.  June 24, 1997      $APLSUB/FILEXT.FOR               Athol
        Add new subroutine to initialize the extension file data
        in the catalog header, as part of the continuing effort to
        encapsulate such information so that the table limit can
        be increased to meet the requirements of Space VLBI. Modify
        the following tasks to use FILEXT for now:
         $APGNOT: IMFIT, IMLOD, JMFIT, MULTI and XTRAN.
        Further updates to follow.
        Moved nowhere.

 9369.  June 25, 1997         ZPRMPT.C                      Jeff
        The ongoing g77 port turned up a null-termination related bug in
        GNU readline based prompting; ZPRMPT.C versions fixed under:
        $APLLINUX, $APLHP, $APLSOL, $APLSGI, $APLSUN, $APLDEC, $APLIBM.
        Moved nowhere.

 9370.  June 26, 1997        $APLNOT/IMSORT                 Phil
        Extracted a subroutine from FITLD that sorts IM tables into
        time-antenna order. This is now needed in INDXR also.
        Moved nowhere.

 9371.  June 26, 1997        $APLNOT/GETDEL        Tony Beasley/Phil
        Tony rewrote GETDEL to take advantage of the fact that IM tables
        will now be sorted before entering GETDEL. In addition he
        improved its extrapolation behaviour to avoid the GETDEL error
        messages we see on occasion due to a small number of VLBA
        records being > 2 minutes from an IM entry at the end of
        correlator jobs.
        Moved nowhere.

 9372.  June 26, 1997        $APGNOT/INDXR                  Phil
        Now calls IMSORT before calling GETDEL.
        Moved nowhere.

 9373.  June 26, 1997        $APGNOT/FITLD                  Phil
        Subr. IMSORT extracted and placed in $APLNOT.
        Moved nowhere.


***********************************************************************

        Changes while 15APR97 was NEW:

***********************************************************************

***********************************************************************

 9374.  July 9, 1997         $YPGM/PCNTR                  Phil
        I got fed up never knowing what p.a. rotation had been applied
        to a particular image so I added the ROTATE value used to the
        information in the plot file.
        Moved from 15OCT97 today.

 9375.  July 9, 1997         $YPGNOT/KNTR                 Phil
        While in the mood I decided to remove the irritating message
        concerning the block being plotted in KNTR. This is not really
        necessary.
        Moved from 15OCT97 today.

 9376.  July 9 1997             INDXR                     Chris
        Increased the size of the buffer used to sort the IM table
        and shuffled LUN assignments to avoid clashes with TABSRT.
        Moved from 15OCT97 on this date.

 9377.  July 9 1997             GPSDL                     Chris
        Disabled delay corrections (which are not reliable), leaving
        only the Faraday rotation correction, and made some changes
        to the diagnostic output.
        Moved from 15OCT97 on this date.

 9378.  July 9 1997             $APGNOT/UVMOD             Ketan
        UVMOD now will process compressed data.
        Moved from 15OCT97 on this date.

 9379.  July 10 1997          LPSEC in APLNOT             Chris
        Split LPSEC from UVFIX to make it easier to find out where
        leap seconds should be inserted.  Also made it more compact
        added the leap second for July 1 1997.
        Moved from 15OCT97 on this date.

 9380.  July 11, 1997        $QNOT/GRIDUV              Rick/Eric/Pat
        There was no lower bound check on the chunk of the UV data read
        into the AP in cases where it would not all fit, and the next
        visibility was so far down in the second chunk that the
        conv. fn. did not overlap into the first chunk.  This caused
        negative offsets into an array in such cases with disastrous
        results.  Spotted by Rick, fixed and tested by Eric, implemented
        here by yours truly.
        Moved from CVX and 15OCT97 this date.

 9381.  July 16, 1997         $APLNOT/CALREF                 Ketan
        CALREF accepted the FREQOF parameter as a REAL when it is
        actually sent in as a DOUBLE PRECISION.  This effectively
        rendered some parts of the code in CALREF non-functional.
        The declaration of FREQOF was changed, and the relevant
        code was commented out.
        Moved from 15OCT97 this date.

 9382.  July 16, 1997         $QPGOOP/IMAGR                  Ketan
                              $QPGNOT/CALIB
        When operating on a multi-source file, if a single source
        name was not specified, IMAGR and CALIB did baddd things.
        Now they warn that they will do baddd things.
        Moved from 15OCT97 this date.

 9383.  July 16, 1997         $APGNOT/MSORT                  Ketan
        In the case when there are no records to sort [the file
        _is_ in the proper sort order] MSORT incorrectly left
        an empty file behind. This has been fixed.
        Moved from 15OCT97 this date.

 9386.  July 18 1997            CL2HF       Chris for David Gordon
        Merged in changes allowing CL2HF to read items from the
        interferometer model (IM) table for VLBA data.
        Moved from 15OCT97 this date.

 9389.  July 25 1997            POSSM                    Chris
        Corrected a manifest real constant in a call to BPCOEFF where
        a double-precision value was expected.
        Moved from 15OCT97 on this date.

 9390.  July 25, 1997           $APGNOT/SNSMO.FOR & .HLP    Athol
        Corrected a re-referencing bug affecting multi-IF calibration
        tables for the second secondary reference antenna and above.
        Subroutine REFFAZ was modifying the table column pointers
        directly (RF1KOL etc) thus causing problems when REFFAZ was
        called for secondary reference antennas other than the very
        first one encountered. Use local variables in REFFAZ to
        avoid this. Also corrected a typo. in the ref. antenna
        selection in REFRAT, and the update condition in RFFXFG.
        Added new subroutine RFFIX to clean up after re-referencing,
        but this should not be required in normal processing.
         All the above are long-standing problems. Only the REFFAZ
        error is likely to have been significant, causing outliers
        in the smoothed output table. The effect of the other bugs
        is limited. Also changed BPARM(6), introduced recently to
        DOBLANK.
        Moved from 15OCT97 on this date.

 9391.  July 25, 1997             UVSUB                Chris
        Rearranged a common block to avoid data alignment problems.
        Moved From 15OCT97 on this date.

 9392.  July 29, 1997      New task: CLFIX      Chris for David Gordon
        Added CLFIX to the APLCONTR (contributed) area and updated
        ASTROMET.HLP to refer to it.  CLFIX adds geometric and
        atmospheric delay information and clock offsets from IM and
        MC tables to CL table 1.  This is only needed as a stop-gap
        until INDXR is able to read information from VLBA MC tables.
        Moved from 15OCT97 on this date.

 9393.  August 4, 1997            $QPGOOP/IMAGR        Ketan
        Change #9382 was improperly implemented in that IMAGR
        printed dire warnings even if sources had been selected.
        The warnings are now only printed IF more than one source
        makes it past the OOP data selection system.
        Moved from 15OCT97 on this date.

 9394.  August 6, 1997            $QPGOOP/OMFIT        Ketan
        OMFIT has been rewritten in many ways.  Many new models
        have been included and subjected to user testing.  The
        error-analysis has been considerably improved.  This is
        still development code and problems should be pointed
        directly to me.
        Moved from 15OCT97 on this date.

 9395.  August 6, 1997            $QPGOOP/IMAGR        Ketan
                                  $QPGNOT/CALIB
        Changes 9382 and 9393 [which merely printed out warnings]
        are to be back'ed out of NEW pending further testing
        of the claimed effects.  Ive used the RCS command co to
        revert the NEW versions of NEW and TST to the pre-#9382 state.
        Moved nowhere.

 9396.  August 7, 1997            $QPGOOP/OMFIT.FOR    Ketan
        Fixed incorrect statement involving complex variables spotted
        by the DEC and the IBM [via Pat].
        Moved from 15OCT97 on this date.

 9397.  August 7, 1997            $HLPFIL/OMFIT.HLP    Ketan
        Last minute changes contributed by Michael Rupen.
        Moved from 15OCT97 on this date.


 9398.  August 8 1997            FILLM                 Chris
        Fixed a bad test condition that would turn off solar mode.
        Moved from 15OCT97 on this date.

 9399.  August 7, 1997           $SYSUNIX/OPTIMIZE.LIS  Ketan
        Turned down the optimization for OMFIT on the IBMs to zero.
        This makes OMFIT run like a dog,  it is recommended that anyone
        wishing to run OMFIT on an IBM compile the code in pieces.
        Contact me directly for more info.
        Moved from 15OCT97 on this date.
