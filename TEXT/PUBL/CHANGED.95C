-----------------------------------------------------------------------
;  Copyright (C) 1995, 1997
;  Associated Universities, Inc. Washington DC, USA.
;
;  This program is free software; you can redistribute it and/or
;  modify it under the terms of the GNU General Public License as
;  published by the Free Software Foundation; either version 2 of
;  the License, or (at your option) any later version.
;
;  This program is distributed in the hope that it will be useful,
;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;  GNU General Public License for more details.
;
;  You should have received a copy of the GNU General Public
;  License along with this program; if not, write to the Free
;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
;  MA 02139, USA.
;
;  Correspondence concerning AIPS should be addressed as follows:
;         Internet email: aipsmail@nrao.edu.
;         Postal address: AIPS Project Office
;                         National Radio Astronomy Observatory
;                         520 Edgemont Road
;                         Charlottesville, VA 22903-2475 USA
-----------------------------------------------------------------------
     This file must be used to record any changes made to the the
master version of AIPS kept in Charlottesville.  An entry is:

   line 1:   Date Program name Your name
   line 2:   What was done (may span multiple lines)
   line n-1: Where has this change been moved (e.g. 15JUL94, nowhere)
   line n:   Blank

 The details of line 1 are important since programs are used to find
 specified strings and do conversions on them.  It MUST be typed as
 follows: 1 blank, 4 digits, a period, two blanks, then the Month,
 day, comma, year, some space, a title, some more space, your name.


                    Changes to 15JUL95


***********************************************************************

        Changes while 15JUL95 was TST:

***********************************************************************

***********************************************************************

 8414.  December 23, 1994         TVFLG, SPFLG                Eric
        Changed TVFLG, SPFLG, and GRIDTB to try hard to avoid bad
        beating between the data times and the Master grid cell times.
        The programs all integerize the times on a 0.1 of a Master grid
        cell (DPARM(6)) and look through the first 10000+ times to see
        what regularity there is in those sample times.  Then the Master
        grid cells are set to be centered on that preferred 0.1 of a
        cell.  Also made fixes that will allow data sampled < 1 sec
        apart (i.e. OTF) including raising averaging buffers to hold all
        the data allowed (16384 rows in the master grid).  Changed
        DSMEAR to suppress error messages and clean up its typing.
        Fixed SPFLG and TVFLG to average across blank rows so long as
        the time range and source ID are ok.  A blank row stopped it
        before.  Also fixed a quirk with the menu and help display.
        Changed the smooth and scan times displayed to be the integer
        number of basic intervals rather than try to show seconds.
        Moved to 15JAN95.

 8415.  December 23, 1994          OTFUV                     Eric
        Changed it to make the beam be 257 (i.e. baseline 1-1).  The old
        scheme confused SPFLG etc.  Added code to keep track of data
        ordering and to put SORT = 'T' in the header iff its true.
        Added message at the end about it too.
        Moved to the patch area and 15JAN95.

 8416.  December 28, 1994         ZLASCL                     Pat
        Modified it to shed the ghostview or pageview process instead of
        waiting for it to finish.  It would be nice if there was a way
        to keep track of a running previewer and feed it new text or
        graphics... (maybe there is and I haven't found it yet)
        Moved to 15JAN95 this date.

 8417.  December 28, 1994           APROPO list                Eric
        Changed HLPA.FOR to put out lines with no trailing blanks,
        HLPB.FOR to eliminate all duplicates (it got only 1 of multiple
        occurences).  Updated LSAPROPO.HLP in TST and NEW.
        Otherwise, moved nowhere.

 8418.  December 27-29, 1994          Plotting                 Eric
        (1) Most plotting tasks place their labels too close together,
        separating by 1.0 characters.  Changed this to 1.33 in the
        vertical direction.
        (2) Added additional LTYPE values 7--10, which are like 3--6 but
        omit all labeling except the tick values and X and Y axis
        labels.
        (3) LWPLA has been using a character size larger than the actual
        characters of the font to compensate for the too close spacing.
        This caused strings to be placed incorrectly, which was
        partially compensated for by having blank characters expanded
        some.  Changed it to use correct character sizes and to drop the
        blank expansion.  Also added a little to the border.
        Routines changed:
        $APLSUB: LABINI, SLBINI, TKSLIN, TKLAB, TKTICS
        $YSUB:   COMLAB, CTICS, CLAB1, CLAB2, ITICS, IAXIS1
        $AIPSUB: AU5B, AU5C, AU9B
        $YPGM:   CNTR, CCNTR, PCNTR, GREYS, ISPEC, PROFL, SL2PL
        $YPGNOT: KNTR, PFPL1, PFPL2, PFPL3, PLROW, PLCUB
        $HLPFIL: LTYPE, CNTR, CCNTR, PCNTR, KNTR, TVLABEL, TKGUESS,
                 TKMODEL, TKRESID, TKSLICE, GREYS, ISPEC, PROFL, SL2PL,
                 KNTR, PFPL1, PFPL2, PFPL3, PLROW, PLCUB
        Corrected a bug in TKTICS which caused the tick marks to have 0
        length.  Shortened the TV tick marks as well.  Changed IAT to
        TIME in CLAB1, CLAB2, TKLAB, PROFL
        Moved nowhere.

 8419.  December 29, 1994        many help files            Eric
        Changed the version number limit from 255 to 46655 in a large
        number of help files.  Did the same to 15JAN95 as 15JUL95.
        Moved nowhere.

 8420.  December 29, 1994            UVPRT                Eric
        Changed it to trap HOLG mode and make DOCRT negative even when
        the user left it positive.  This makes the task detach.  Also
        removed the qualifier from W in lography mode (mod by 256).
        Moved to 15JAN95 from 15JUL95.

 8421.  December 29, 1994           HOLGR                 Eric
        Rick Perley has corrected and tested the flat field model
        routines for both kinds of feeds.  Replaced FLATPH and FLATPH2
        routines per his instructions.
        Moved to 15JAN95 from 15JUL95.

 8422.  December 29, 1994           $APLNOT/DATCAL.FOR    Athol
        Corrected ~10% error in delay smearing correction caused by
        using an imperfect model for the spectral averaging.
        Moved to 15JAN95 from 15JUL95.

 8423.  December 30, 1994         SN tables                Phil
        There was a problem in CLCAL when the user had copied an SN
        table from a single source file to a multi-source file and then
        sets the array CALSOU to one or more non-blank values. CLCAL
        looks in the SN table for the source numbers, but they are zero
        (because the file from which it originated was single-source)
        and so decided that there are no valid sources and thus fails to
        write a new CL table. The most general way to fix this was to
        add a new keyword, ORIGIN, to the SN table. If ORIGIN is 0 or
        not there then the CLCAL performs as before and does the correct
        thing for multi-source files. If ORIGIN is 1 then the SN table
        came from a single-source file and the CALSOU array is then
        ignored inside CLCAL.
        Modified: $QPGNOT/CALIB, $APGNOT/ACFIT & APGNOT/UVCRS to write
        the ORIGIN keyword.
        Modified CLCAL to read that keyword only when a single SN table
        is being applied, otherwise if multiple SN tables are being
        merged it acts as it did before.
        Modified SN2CL to act on the ORIGIN keyword in the appropriate
        manner.
        Moved nowhere.

 8424.  December 31, 1994             ACFIT                  Eric
        A statement "IF (IRET) THEN" was placed in the code.  This is
        not legal since IRET is not a logical variable.  Fixed.
        Moved nowhere.

 8425.  December 31, 1994          More plotting             Eric
        Numerous tasks do plots without giving the user any control over
        the axis labeling.  While the pixel and relative types may not
        be meaningful, types 1, 2, 3, 7, and the negatives are.  These
        tasks used, effectively 3 at all times before.  Changed:
        IMEAN   Added LTYPE and added the option to plot the histogram
                with the counts on the Y axis and flux on X.
        LWPLA   Changed to use more correct character sizes for 2 of the
                fonts.  I'll get more later.
        IMVIM   Added LTYPE.
        TAPLT   Added LTYPE.
        EXTLIST checked and okay for IMEAN, IMVIM, TAPLT
        Moved nowhere.

 8426.  January 2, 1995            UVHGM                     Eric
        Changed it to use LTYPE.  Also changed it to read compressed
        data (it did not even check for this!), to do some Stokes
        conversion, to plot both RR and LL or RL and LR on one plot if
        requested, to plot more than one channel and/or more than one IF
        on each plot.  Cleaned up handling of parameters too.
        Changed AU8A (EXTLIST) for changes in help file.
        Moved nowhere.

 8427.  January 6, 1995           DISKU                      Pat
        Redirected egrep output to the bit bucket; some systems (e.g.
        linux) have GNU egrep which still outputs stuff with -s.
        Moved to 15JAN95 this date.

 8428.  January 6, 1995          Single dish                Eric
        Changed OTFUV to make the output beam be 257 * BIF.  This will
        let it look like antenna BIF's autocorrelation to the data
        selection routines.  Changed PRTSD to check the BEAM random
        parameter for this patern and to then display the antenna
        number.  Changed DATGET to force DOACOR to true and to skip
        selection on UVRANGE for single-dish data.
        Moved to 15JAN95 this date.

 8429.  January 9, 1995            BLING                    Chris
        Fixed a bug in the output routine for 'INDE' mode which meant
        that the user had to enter 'Q' multiple times to abort the
        program.
        Moved to 15JAN95 this date.

 8430.  January 9, 1995            FRING                  Leonia
        The multi-band delay is stored in the SN table as a phase ramp
        across IFs, there was a bug in the calculation of this phase
        ramp if the first IF was not the reference frequency. In this
        case the frequency offset in the FQ table for IF#1 was negative
        since its sky frequency lay below that of the reference
        frequency. When this happened FRING calculated the same phase
        for the first and second IF. The error was caused because the
        frequency shift for the second IF was equal zero.
        The relevant change has been implemented in subroutines FRNDR
        and FRNMS.
        Moved nowhere.

 8431.  January 9, 1995           FRING                  Leonia
        I have canceled the previous change because it forced the
        reference IF to #1 that is generaly wrong. It is necessary
        to evaluate the reference IF using criteria frequency shift
        equals zero. The change will be implemented after complete
        investigation of the problem.
        Moved nowhere.

 8432.  January 5-6 & 9, 1995          More plotting             Eric
        Numerous tasks do plots without giving the user any control over
        the axis labeling.  While the pixel and relative types may not
        be meaningful, types 1, 2, 3, 7, and the negatives are.  These
        tasks used, effectively 3 at all times before.  Added LTYPE to:
        SNPLT    3 places labeling is done
        POSSM    Had lots of things stopping single-dish plots.
        UVPLT    also moved string placement some
        VBPLT, VPLOT, CLPLT, DFTPL, FRPLT, FRMAP  saved parameters
        better
        Changed AU8A (EXTLIST) to compensate for the changes in the
        inputs files of VBPLT, VPLOT, SNPLT, POSSM, CLPLT, DFTPL, FRPLT,
        FRMAP made some long time ago.  The last 3 needed new code in
        AU8A.
        Also corrected a bad wording in TVINIT's help file and made
        new plot type numbers (21 - 25) in GINIT's comments.
        Moved nowhere.

 8433.  January 10, 1995              FRING                Leonia
        I have implemented changes in subroutenes FRNDR and FRNMS to
        overcome the problem discribed in 8430. Reference IF is that
        one for which frequency shift in FQ table is equal zero.
        Moved nowhere.

 8434.  January 10, 1995             SDGRD                    Eric
        Fixed HI record on weighting to include UVWTFN string.
        Moved to 15JAN95 this date.

 8435.  January 10, 1995             SPLIT                 Leonia
        SPLIT calculated erroniously header frequency and shift frequency
        for different IF in the case when the first IF's frequency does
        not equal zero. It was realized with M. Rupen data in which the
        first IF frequency is negative. But the task could not work
        properly with any data if a portion of IFs (starting with not
        the first IF) was copyed. The relevant change in subroutine
        SPLCOP has been implemented. Now the first IF's frequency is
        forced to zero and corresponded correction of the rest frequency
        is being done.
        Moved nowhere.

 8436.  January 12, 1995             WFCLN                     Eric
        The routine to read clean boxes only read the 1st 50 cards in
        the file.  Changed that to 5000 and fixed the END and ERR
        branches to go to a reasonable point.
        Moved nowhere - should go to 15JAN95.

 8437.  January 12 & 14, 1995            LABINI              Eric
        Changed a character limit by a little.
        Moved nowhere.

 8438.  January 13, 1995            UVFLG                    Eric
        Some user has complained about Leonia's English in the UVFLG
        help file.  Actually, it was one of his better efforts and was
        quite clear, but I reworded it to be more pedantic.
        Moved nowhere.

 8439.  January 13, 1995          GREYS, DOGREY              Eric
        Correct GREYS to honor LTYPE in labeling the wedge - it labeld
        it even when LTYPE = 1 or 2.  Create a new adverb DOGREY, making
        a help file and changing POPSDAT.HLP and NEWPARMS.001.  It will
        be used in KNTR.
        Moved nowhere.

 8440.  January 15, 1995          KNTR                       Eric
        Changed KNTR to do grey scales and/or contours.  Pulled the beam
        plotting routine, made suitably generic, from the code as a
        separate routine PLTBEM ($YSUB).  Also help file of course plus
        AU8A for EXTLIST.  This means that CNTR and GREYS are obsolete.
        Changed POPSDAT.HLP and NEWPARMS.001 to add adverb CBPLOT and
        LABEL.  Made new help files for the 2 new adverbs.
        Moved nowhere.

 8441.  January 16, 1995          UVFLG                     Leonia
        Changed the help to take it more clear (I hope). Changed logic a
        little bit. Excluded the low limit of weight.
        Moved nowhere.

 8442.  January 18, 1995          PCNTR, EXTLIST            Eric
        Changed PCNTR to process I-P-A images as before plus I-Q-U
        images and I-Q-U cubes.  Upgraded EXTLIST (AU8A) to support the
        improvemnets.
        Moved nowhere.

 8443.  January 20, 1995          $APGNOT/SNSMO.FOR         Athol
        SNSMO did not resolve the 2 pi ambiguity before direct smoothing
        of phases. Corrected this to be consistent with what is done
        in CLCAL.
        Moved nowhere.

 8444.  January 20, 1995          $APGNOT/AVSPC & SPLIT       Phil
        When averaging all channels and all IFs together both routines
        called AVGIF. AVGIF is flawed and had been replaced with AVGCIF
        a long time ago. SOmewhow these two tasks were overlooked when
        AVGCIF was written. Fixed this.
        Also ensured that SPLIT uses the reference frequency determined
        by UVGET rather than recomputing it before exit. Although it
        gets the anwer right I can forsee it coming up with a different
        answer after all the uvw's have been scaled. So this must be
        prevented.
        Moved nowhere.

 8445.  January 21, 1995             POSSM                    Eric
        Fixed it to work when NCOUNT > 0.  I had messed it up adding the
        new labeling, since parameters were not yet known when they were
        needed.  Changed things around to do more sensible scaling and
        labeling and get things like the velocity label right (and use
        it only when appropriate).  Change frame scaling to put the
        plots directly next each other with no interior labeling when
        the plots are fully user scaled.  Fixed frame scaling so outer
        labels did not have a big space away from the plot.  Fixed it to
        put the relevant antennas into XANTEN for EXTLIST.
        Moved nowhere.

 8446.  January 23, 1995             $APLSUB/AVGIF.FOR         Phil
        Removed this flawed routine from the system. It had been
        replaced eons ago by AVGCIF but was still lurking in a couple
        of routines.
        Moved nowhere.

 8447.  January 23, 1995             $YPGNOT/VPLOT.FOR        Leonia
        There was a difference between VBPLT and VPLOT in interaction
        of adverbs ANTENNAS and BASELINE.
        VBPLT did not have opportunity to plot the baselines between
        antennas named in a given list.
        VPLOT did not have opportunity to plot the baselines between
        antennas named in a given list and any antenna.
        I have changed the function REQBAS  to have both these
        options in VPLOT. The help file has been changed to clarify
        the interaction of adverbs ANTENNAS and BASELINE.
        Moved nowhere.

 8448.  January 24, 1995  $APGNOT/LISTR.FOR  $HLPFIL/LISTR.HLP  Athol
        Added a new option to OPTYPE='GAIN', namely STOKES='POLD',
        which, for any CL or SN table, will print the R/L ampl. gain
        ratio or R-L phase gain difference as selected by DPARM(1)
        (0=amp; 1=phase). This option is ignored for other values of
        DPARM(1) or OPTYPE <> 'GAIN'.
        Moved nowhere.

 8449.  January 25, 1995        $APGNOT/PCLOD.FOR               Phil
        The LO Freq in the ascii file is used to identify which phase
        cal tone belongs in which IF. I had assumed that the value
        given needed to be adjusted by 0.5 * bandwidth. This is not the
        case.
        Also if the data had < 4 Stokes parameters PCLOD assumed that
        there was only one polzn in the tables, this does not deal with
        the case of RR & LL only.
        Also provided a little more information on the # of entries read
        as the task proceeds.
        Moved nowhere.

 8450.  January 25, 1995          $YPGNOT/SNPLT               Phil
        When plotting multiple IFs per page SNPLT refused to plot data
        from PC tables. Fixed it and also ensured the phase-cal tone
        being plotted was recorded in the accompanying text.
        Moved nowhere.

 8451.  January 25, 1995            KNTR                      Eric
        Changed PLTBEM to test for beam too large and to give messages.
        Changed KNTR to set default windows when doing only one image.
        Moved nowhere.

 8452.  January 26, 1995            MAXFIT                    Eric
        There was a way through AU9 that could generate the FIT FAILS
        message without setting ERROR.  Stopped it - this was when the
        fit actually worked, but the peak was outside the search area by
        more than 1 pixel.
        Moved nowhere.

 8453.  January 27, 1995         $YPGNOT/POSSM.FOR            Athol
        Change POSSM to append to the text file specified by OUTFILE,
        rather than rewriting the file. Setting SOLINT will now
        write a sequence of spectra to the output text file. Also
        corrected a minor error in POSSPL: pressing button D did
        not terminate plotting if a text file was written as the
        GFINIS return code was overwritten by ZTXCLS.
        Moved nowhere.

 8454.  January 27, 1995           SETPAR                     Eric
        Corrected it - the SP disk keeps the assigned users for only 15
        disks, not the 35 that can occur.  Changed SETPAR to limit the
        range of disks to 1 - MIN(15,NVOL), rather than 2 - NVOL.  The
        first disk can be assigned too these days.
        Moved to the patch area 31 January.

 8455.  January 30, 1995         $YPGNOT/POSSM.FOR           Athol
        Corrected a logic error in IF range selection when SOLINT <> 0.
        Also the scan center time and second antenna on each XC baseline
        were not written correctly to OUTFILE.
        Moved nowhere.

 8456.  January 30, 1995  $HLPFIL/UVGLU.HLP;  $APGNOT/UVGLU.FOR  Athol
        Modify UVGLU to allow input data files that do not contain
        exactly the same number of visibility points, perhaps as a
        result of independent gain calibration. In this case the
        data are assumed to be in time-baseline sort order.
        Moved nowhere.

 8457.  January 30, 1995       MK3IN             Chris/Walter Alef
        Incorporated changes from Walter Alef to allow MK3IN to read
        experiments with up to 66 baselines.  MK3IN now carries a
        mapping from extent numbers to baseline numbers (LXTNT) since
        the type 51 extents only store the baseline numbers modulo
        64.  Also removed the call to MK3ANT from MK3DAT and changed
        the reference date test to use the value of RDATE in the
        AN table.  Since the AN table keywords are not updated by
        ANTINI, the calls to MK3ANT from MK3DAT could cause the
        wrong reference date to be used in the AN table if the
        data were not written onto tape in sequential order;  MK3ANT
        should now only be called once per run (immediately after
        the correlator parameters are shown).  The revised reference
        date test should get rid of spurious warnings when appending
        to an existing file.

 8458.  January 31, 1995           UVINIT                     ERic
        Believe it or not, found a significant bug.  If the apparent
        read size was an integer * 512 bytes then the extra safety
        margin was set to 0.  Then, if the buffer size did not allow
        this read size, the read size was reset, but not the safety
        margin.  This led to wrong I/O!  Changed it to reset the margin.
        Moved to the patch area this date.

 8459.  February 2, 1995            WFCLN, UVUTIL             Eric
        Found a bug in UVUTIL (UVFRQS) - it ignored BIF and returned
        frequencies for IFs 1 through NIF.  These were then applied to
        data of BIF and up leading to wrong scales for images made with
        BIF > 1.  WFCLN was clipping out data outside some UMAX based on
        the reference frequency.  In bandwidth synthesis or
        spectral-line imaging, this UMAX should be adjusted to the max
        frequency in each image.  Since it was not, it was easily
        possible for WFCLN to attempt to grid samples well off the grid
        (and off the address space of the task).  Corrected it to (1)
        scale the U/V in range tests properly to require all channels of
        a sample to fit inside the used portion of the data grid, (2)
        apply the usual defaults for GUARD taking into account the
        taper, and (3) count samples off the grid and the like to report
        the discarded samples and to suggest better cell sizes.
        Moved nowhere.

 8460.  February 2, 1995         FRING                     Chris
        Added a check on the AP memory requirement in FRNFIT.  This
        should catch most instances where FRING would fail with
        SOLINT messages after running for some time.  This check
        should really be moved to a point before the data selection
        and averaging but it appears that this would require major
        surgery.
	Moved nowhere.

 8461.  February 2, 1995         $APLNOT/NXTFLG.FOR        Athol
        Modified NXTFLG to ignore flag table entries which cover
        an IF or spectral channel range incompatible with the
        header structure of the underlying u-v file. Flag entries
        which do overlap with the IF and channel range in the
        u-v file are adjusted and retained in the common block
        flag tables used by DATFLG. This error could cause
        memory overwrites in DATFLG with unpredictable effects.
        Moved nowhere.

 8462.  February 3, 1995         $APGNOT/LISTR.FOR         Athol
        Revise correction #8448 to LISTR. Was not dealing correctly
        with multi-IF tables in all cases.
        Moved nowhere.

 8463.  February 3, 1995        $YPGNOT/POSSM.FOR         Phil
        Trivial correction dealing with an obscure bug when labelling
        multi plot per page plots.
        Moved nowhere.

 8464.  February 3, 1995        UVUTIL, WFCLN                 Eric
        Corrected UVUTIL (U2IDES) to take into account the channel
        averaging which affects the number of frequencies in the output
        image and the reference and alternate reference pixels.  Changed
        WFCLN to put the number of channels averaged into the UV data
        object and to take this into account in doing the loop over
        channels.  Also fixed the default GUARD value - forgot the SQRT.
        Improved the ECHAN description too in the help file.
        Moved nowhere.

 8465.  February 6, 1995          MCREAT, UVCREA             Eric
        Changed message format to add a digit for disk number.
        Moved nowhere.

 8466.  February 6, 1995              SCMAP                  Eric
        Add GUARD to SCMAP inputs.  Changed SCMAP to put the Guard-band
        parameters and UMAX/VMAX into the UV data object for UV2SCR.
        Changed UVUTIL (UV2SCR) to do the guard-band tests on U and V
        and to limit the data passed to UMAX and VMAX correctly adjusted
        for frequency of the highest-frequency channel.  Also changed
        UV2SCR to put the largest U in the UV file header as MAXBLINE.
        This saves a read of the whole file to get it later in UVPREP.
        Moved nowhere.

 8467.  February 7, 1995              UPDAT                  Pat
        Martin Shepherd reported this task did not work when it tried to
        read USERLIST.HLP in $HLPFIL; apparently it used ZTOPEN and ZTREAD
        to access the file, and ZCLOSE to close it.  This caused it to
        die before it did any conversions.  Changed to ZTCLOS.
        Moved nowhere.

 8468.  February 8, 1995         $QPGNOT/CVEL           Phil
        Found a stupid screw-up in CVEL. When I did the changes a few
        months ago I was using an array called AVDELI to track the
        amount by which the BP entries were shifted so I could flag
        those channels. What I didn't do was change the original use of
        that array in $QNOT/DSHIFT. It was used to report the amount by
        which spectra were frequency shifted. Anyway, as that array was
        filled with values from DSHIFT more and more channels were
        flagged as CVEL went through the data until eventually all
        channels were flagged. The fix was trivial - use different
        arrays. Also put DSHIFT back into CVEL since it is the only task
        that calls it. Removed DSHIFT from $QNOT.
        Will move CVEL to the patch area for 15JAN95 this afternoon.

 8469.  February 8, 1995            PSEUDO                 Eric
        Found bugs when recompiling verbs and pseudoverbs as in RUN
        NEWPARMS.  These bugs caused the wrong info to be put in the
        wrong place, converting NEWPARMS from a proc to a verb or
        pseudoverb.  WE're lucky that's all it did!
        Moved to the patch area.

 8470.  February 13, 1995        $APGNOT/SNSMO           Phil
        When using SMOTYPE='VLMB' the phases for each IF were replaced
        in the SN table with the wrong sign. The multi-band delay was
        OK. Thanks to Michael Bietenholz for pointing this out.
        Moved nowhere.

 8471.  February 13, 1995        &APGNOT/FILLM           Gustaaf
        FILLM put the wrong reference channel in the header for BW codes
        8 and 9. Reason was that FILLM assumed that the sum of the LO
        frequencies equals the frequency of the beginning of the band.
        For BW codes 8 and 9 there is a full bandwidth offset between
        these two frequencies. Must have been there all the time, but
        not spotted due to relatively rare use of these BW codes.
        Moved nowhere.

 8472.  February 14, 1995        $APGNOT/UVFLG           Phil
        A task called TSM generates the Tsys and flagging files for
        data from the VLBA correlator. These files are in a form that
        can be read into AIPS with little modification. Previously
        though, for flag files, a user would have to change the TIMEOFF
        value, change the day of year in the timerange to 0-relative
        numbers and change the antenna names to numbers.
        A new version of TSM is coming out this week that modifies the
        format of the flag tables slightly. Now the user need make no
        change to the file UVFLG will read and understand the commands
        as they are written.
        UVFLG will also still deal with the old format ascii files.
        UVFLG.HLP also updated.
        Moved nowhere.

 8473.  February 14, 1995          SDGRD                 Eric
        SDGRD failed to place the Stokes adverb in the appropriate
        common for the data reading routines, so it was ignored.
        Changed the strings for RR and LL too (in help and code).
        Moved to the patch area.

 8474.  February 16, 1995         $APGNOT/UVFIX          Gustaaf
        Added the long overdue leapsecond information of 1 July 1995
        to UVFIX.
        Moved nowhere

 8475.  February 16, 1995      $APGNOT/UVCOP             Leonia
        When UVCOP runs with selection criteria (timerang, sources list
        antennas/baseline) it used these criteria for selecting data and
        sources in SU table. CL table has been copyed not paying attention
        on the selection criteria. The new version of the task copyes the
        part of the CL table in accordance with the selection criteria.
        To make it I added some lines in COPYIN to determine the list of
        selected antennas from ANTENNAS/BASELINE data, attached CLSEL to
        the text of the task and made germane change in it. I have excluded
        subroutine COPRST which copied the tables if all IFs need to copy.
        A subroutine COPTAB intended for a copy of a portion of IFs, can
        serve in that particular case as well. I have modified HELP file
        to ilucidate the relation of ANTENNAS/BASELINE in the case of
        auto correlation.
        Moved nowhere

 8476.  February 17, 1995         $APGNOT/VBGLU             Phil
        The frequency scaling of u,v.w was calculated with the
        expression old freq / new freq instead of the inverse.
        Fixed.
        Moved nowhere.

 8477.  February 17, 1995  $HLPFIL/POPSDAT.HLP  $RUNSYS/NEWPARMS.001 Athol
        Add two new scalar adverbs, TYVER and GCVER, for the system
        temperature and gain curve tables.
        Moved nowhere.

 8478.  February 21, 1995      $YPGNOT/CLPLT.FOR             Leonia
        The task has not worked when averaging the frequency channels.
        The reading of the first portion of data  by UVGET was skipped
        in subroutine CLOSAV. As a result, the frequency averaging
        procedure (AVGCIF) fell in confusion. Additionally, the default
        value of STOKES was 'HALF' instead of correct 'I   '. So the task
        has not worked with the default value of STOKES.
        Fixed.
        Moved nowhere.

 8479.  February 21, 1995     $APGNOT/MK3IN.FOR              Athol
        Increased parameter MXFQID from 3 to 24 to accomodate datasets
        with a large amount of frequency switching (precipitated by
        difficulties in loading data from a pre-SVLBI maser survey).
        Also moved the call to MK3FQ, which writes the FQ table, to
        MK3TB to deal with the case where the FQ-ID's are not all
        contained in the first set of header extents.
        Moved nowhere.

 8480.  February 21, 1995  $HLPFIL/POPSDAT.HLP, $RUNSYS/NEWPARMS.001 Phil
        Added a new adverb, DIGICOR, to control the application of the
        digital corrections in FITLD.
        Moved nowhere.

 8481.  February 21, 1995      $APGNOT/UVFLG           Phil
        A user had a VLBA ascii flag file with 3000 entries. One of them
        had a start time > end time. UVFLG told him this but gave no
        clue as to where in the file this might lie. Fixed to print out
        the offending times. Also ensured that in the new format any
        lower case antenna names are converted to upper case when read
        in.
        Moved nowhere.

 8482.  February 21, 1995        $QPGNOT/BPASS          Phil
        BPASS specifically did not normalize BP tables generated from
        VLBA data. The reason I did that no longer holds so changed the
        code to ensure that BPASS does so if requested and prints a
        message that it is doing so.
        Moved nowhere.

 8483.  February 21, 1995    $APGNOT/LISTR.FOR                 Athol
        OPTYPE='GAIN' was working correctly for STOKES=' ' but not
        STOKES='HALF'. Fixed this. Also corrected a long-standing
        error for OPTYPE='GAIN'; STOKES='L'; this did not work if
        the gain table contained data for both polarizations. In this
        case RCP gains were printed in error.
        Moved nowhere.

 8484.  February 22, 1995	$RUNSYS/VLAPROCS.001		Dave
	The default for SNVER was 1 in VLACALIB; I changed it to zero.
	Moved nowhere.

 8485.	February 22, 1995          $HLPFIL/DIGICOR.HLP         Phil
        As Eric pointed out I had forgotten the helpfile for the new
        adverb DIGICOR. It is now written.
        Moved nowhere.

 8486.  February 22, 1995	$APGNOT/TBOUT.FOR		Dave
        Michael Rupen pointed out the following: in the header of
        the disk file created by TBOUT, I*4 columns were quoted as
        a format of I12; however, I11 was what was actually used for
        the actual row output and column calculation. Since 11 is
        used several places in the code, I just changed the string
        in the header (FORM(4)) to read I11; also ITLEN(4)=11.
        Moved nowhere.

 8487.  February 23, 1995    $HLPFIL/TYVER.HLP $HLPFIL/GCVER.HLP  Athol
        Help files for new adverbs TYVER and GCVER (see #8477).
        Moved nowhere.

 8488.  February 23, 1995	$APLSUB/TRIM.FOR		Dave
        Another bug from Michael Rupen: TBIN was trashing everything
        past column 132. It was due to the temporary storage
        array in TRIM being only 132 characters; I upped it to
        1024 and recompiled TBIN.
        Moved nowhere.

 8489.  February 23--, 1995    TV Object, revised imaging        Eric
        Changes for TV Object and revised imaging:
        OLDMAP     New: the old version of MAKMAP
        HORUS      Changed to call OLDMAP.
        UVGET      Corrected faulty logic setting EIF defaults.
        DMPR.INC   Changed to add Robust, weight power, weight function.
        OBJMNGR    Changed OBVHKW to check whether a keyword was already
                   defined rather than just automatically appending it
                   to a rather finite (50) list.
        POPSDAT    Help file changed to add ROBUST, UVBXFN, UVSIZE.
        NEWPARMS   Run file changed to add ROBUST, UVBXFN, UVSIZE.
        AU6        Changed to call TVZOME, TVPSUD, TVFLAM
        TVZOME     New: interactive TV zoom from AU6
        TVPSUD     New: interactive TV pseudo colors from AU6
        TVFLAM     New: interactive TV flame colors from AU6
        Moved nowhere.

 8490.  February 23, 1995        PLTBEM, KNTR, PCNTR              Eric
        Changed KNTR to take into account offsets of one image from the
        other.  Changed PLTBEM to offer other modes filling in the beam
        some.  Changed PCNTR and KNTR and their helps to support these
        modes.
        Moved nowhere,

 8491.  February 24, 1995       $APGNOT/SPLIT             Phil
        SPLIT will not now copy the (sometimes rather large) HF table to
        the single-source output file.

 8492.  February 24, 1995       $APGNOT/SETJY           Phil
        Ensured that the alternate refernce pixel is set to the true
        reference pixel as a default when velocities are being set. This
        was causing some confusion for ATNF data.
        Moved nowhere.

 8493.  February 24, 1995     New adverb: WTTHRESH          Phil
        Added another new adverb to POPSDAT.HLP and NEWPARMS.001. Also
        wrote a helpfile. WTHTHRESH will be used in FITLD to generate
        an FG table based on the input data weights.
        Moved nowhere.

 8494.  February 25, 1995         TV                       Eric
        changed
        IMCHAR   Support all 4 angles
        IMANOT   Support all 4 angles
        GRBOXS   To make the number of boxes an output variable up to a
                 given max.
        AU5C     To call the revised version of GRBOXS - simpler than
                 before.
        TVBOX    Changed help file.
        REBOX    Changed help file.
        Moved nowhere.

 8495.  February 27, 1995       $APGNOT/FILLM              Gustaaf
        Realtime FILLM on the IBMs failed when NFILES > 0. Strictly
        speaking this is pilot error, but difficult to track down when
        it occurs. So I bypassed the file skipping when FILLM is used
        in its online mode. Strangely enough, NFILES > 0 worked on
        Suns.

 8496.  February 27, 1995          BLING                   Chris
        Moved call to UVFRQS in SETFRQ to get rid of benign but
        annoying error messages about BIF/EIF and removed superfluous
        calls from FIX0, FIX1, FIX2 and FIX3.
        Moved nowhere.

 8947.  February 27, 1995      Name conflict                Eric
        A name conflict between OOP and TV has arisen.  Changed:
        COLORF   New - was IMFCLR
        COLORH   New - was IMPCLR
        COLORC   New - was IMCCLR the actual conflict
        COLORL   New - was IMLCLR
        TVMOVI  to call COLORC
        TVFIDL   to call COLOR
        TVFLAM   to call COLOR
        TVPSUD   to call COLOL, COLORH, COLORC
        Moved nowhere.

 8948.  February 28, 1995          CURVAL, TVBLIN          Eric
        Changed TVBLINK to do all of the blinking operation including
        the enhancements.  Moved it from $AIPSUB to $YSUB.  Created
        $YSUB/TVALUE.FOR to do CURVALUE.  Changed AU6A and AU6B to call
        these subroutines.  Now these functions can go in the TV object.
        Moved nowhere.

 8499.  February 28, 1995           SETJY                  Chris
        Widened the format used to print the alternate reference pixel
        to cope with channel numbers in the thousands.
        Moved nowhere.

 8500.  February 28, 1995  $QPGOOP/SCMAP.FOR                Bill C.
        Fixed bug which occurred when the data contained multiple
        subarrays.  The self calibration was putting the solutions in
        separate SN tables and then only calibrating the final subarray.
        Moved nowhere.

 8501.  February 28, 1995  $APLOOP/UVUTIL.FOR               Bill C.
        SLFCAL, UVFRSC now only force a new SN table if the subarray
        number is 1.
        Moved nowhere.

 8502.  March 1, 1995      $APLCVEX/ZTACT2, ZTKILL          Pat
        Created convex-specific versions of these routines.  The problem
        arises in the decoding of the process id from the lock file, e.g.
        /tmp/FUBAR1.12345 -> 12345.  This is achieved via a scanf with a
        %d in the format string in the $APLUNIX versions, but pid_t is a
        short on ConvexOS, and an int just about everywhere else.  This
        resulted in antisocial behaviour such as AIPS deleting the lock
        file in /tmp before the task was finished.
        Moved nowhere.

 8503.  March 1, 1995        $APGNOT/FITLD.FOR            Phil
        A major release of FITLD. I have added the routines written by
        Leonid Kogan to perform the digital corrections necessary for
        data from the VLBA correlator. The user has the choice of
        whether to apply these corrections or not through the use of
        the adverb DIGICOR. DIGICOR <= 0 will not apply the corrections,
        DIGICOR = 1 will apply them to all data, DIGICOR = 2 will apply
        the corrections to all cross-power data and only to the
        total-power if zero-padding was used in the correlator.
        2 other minor problems were fixed: a format statement in BTRTAB
        was wrong, thanks to Bill C for pointing this out; the
        LO-offsets can only be set at the antennas to increments of
        10kHz, I adjusted the DOPOFF parameter in the IM/CL tables to
        reflect this. This fixed a bug that results in these numbers
        when the correlator writes > 256 channels per IF.
        Also updated the helpfile.
        Moved nowhere.

 8504.  March 2, 1995        $APGNOT/SNSMO.FOR             Athol
        Corrected minor bug in SNSMO which disabled clipping of
        rates in most circumstances as a result of not checking
        the rate threshold in the correct units.
        Moved nowhere.

 8505.  March 2, 1995        New subroutine: $APLNOT/MBDREF    Phil
        Routine to rereference the multi-band delay column of an SN
        table. This is cosmetic really because the MBD is stored as a
        phase slope across IFs, but users have noticed that this column
        is not referefenced when a ref. antenna changes and it worries
        them. Got to keep the users happy.
        Moved nowhere.

 8506.  March 2, 1995    $APLNOT/CALADJ   $QPGNOT/FRING       Phil
        Modified to call MBDREF where appropriate. Also stored BCHAN &
        ECHAN in the history for FRING.
        Moved nowhere.

 8507.  March 2, 1995            SPLIT                   Chris
        Removed a booby-trap which would prevent the reference frequency
        being set correctly if (i) channels were to be averaged, (ii)
        a subrange of channels was selected and (iii) BCHAN and ECHAN
        did not include the entire range of channel numbers.  The
        culprit was a test for inclusion of all channels after UVGET
        was called; UVGET modifies the header block to reflect the
        number of channels it will return after BCHAN/ECHAN selection
        instead of the original number of channels.
        Moved nowhere.

 8508.  March 1, 1995            task help                  Eric
        Changed TSKHLP to take a task name argument.  This lets all
        Cleans call it CLEAN and lets there be more than one menu per
        task.  Changed TVFLG, SPFLG, IBLED, TVRGB, TVHUI for call seq
        change.
        Moved nowhere.

 8509.  March 3, 1995            TVBOX, REBOX                Eric
        Changed GRBOXS to do circular as well as rectangular boxes.
        Added to $YSUB two support subroutines call LMBOXS and DRBOXS to
        limit the cursor position and to draw the boxes.  Changed help
        files HLPCLEAN, TVBOX, REBOX as well.
        Moced nowhere.

 8510.  March 6, 1995          FITLD                          Phil
        Added the DIGICOR information to the HI file. Also corrected a
        mildly amusing typo in one of the messages printed while
        running.
        Moved nowhere.

 8511.  March 6, 1995          CVEL                       Phil
        Found the potentially serious bug that was causing the spectra
        out of CVEL to be subtly different from those out of POSSM. The
        address of the start of the spectrum in a large buffer was off
        by 2 words and so the time and antenna number were being passed
        into the shifting routines as though they were data.
        This will need a patch.
        Moved nowhere.

 8512.  March 7, 1995         CVEL                       Phil
        I have been having persistant problems with the sorting of the
        CL table. Finally sorted them out by ensuring the sort was done
        early on in the task execution.
        Moved nowhere.

 8513.  March 7, 1995         $APLNOT/KEYIN.FOR              Athol
        Mode=1 in KEYIN is meant to echo KEYIN input, which is useful
        in debugging large input KEYIN files such as are used in VLBI
        amplitude calibration. Enabled reflection for mode=1, and
        also introduced a new mode=4 which is simply mode=3 with
        relection. Only the first 64 characters of each KEYIN line
        are printed if reflection is activated.
        Moved nowhere.

 8514.  March 7, 1995         $APGNOT/ACCOR.FOR              Leonia
        Calibration of a cross correlation spectrum supposes knowing
        parameters of samplers (digitizers in particular). Unfortunately
        these parameters are not identical to optimal ones and are not
        known with enough accuracy. As a result the cross correlation
        spectrum amplitudes are measured with errors. These errors can be
        estimated having measured the mean value of auto correlation spectrum
        of a given interferometer's antennas. The new task ACCOR provides
        correction using this algorithm. The task estimates the mean values of
        the auto correlation spectra of all antennas of a given VLBI network
        and records them in SN table. The following application of the
        correction is provided by standard procedure of applying the SN
        table to an CL table (CLCAL) and following application this table with
        DOCALIB = 1 in relevant tasks.
        Moved nowhere.

 8515.  March 8, 1995         $APGNOT/FILLM                  Gustaaf
        FILLM greatly exaggerated the number of shadowed visibilities.
        Reason of this was that the test for shadowing antennas took
        place *before* any other test of eligibility; consequently many
        visibilities which wouldn't have made the output data set were
        reported as shadowed. The fix was simply to count only those
        shadowed visibilities which met the other criteria as well.

 8516.  March 8, 1995         $HLPFIL/ACCOR.HLP              Leonia
        I has  written ACCOR.HLP with lines longer than 72 characters.
        So it was difficult legible. I've fixed it.
        Moved nowhere.

 8517.  March 8, 1995         $APGOOP/MBDLY.FOR              Ed F
        Made lots of changes to improve MBDLY, especially for use with
        the Calc/Solve programs.  The major changes are:  Added
        TIMERANG adverb to limit MBDLY range of execution.  Added
        BIF and EIF adverbs to pick out only those IF's associated
        with one frequency.  This is needed for dual frequency
        (S/X) data bases.  More careful checking of bad fringe fits
        various scatter rms's amongst the IF's.  Default values
        improved.  Moved nowhere.

 8518.  March 8, 1995         $HLPFIL/MBDLY.HLP              Ed F
        Improved help file in conjuction with code in previous
        entry.  Added TIMERANG, BIF and EIF adverbs.  Improved
        the help and explain files.  Moved nowhere.

 8519.  March 8, 1995         $APGOOP/CL2HF.FOR              Ed F
        Made lots of changes to improve CL2HF.  The major changes
        are:  Fix geometric calculations for converting earth
        center to station center (Haystack style) rates and
        delays.  Took out INFILE adverb for station names and
        put selection in code.  Include TIMERANG adverb for
        selection.  Fixed several other minor errors in
        converting from CL to HF format.  Source observations
        below 0.5 degree elevation elliminated.  Moved
        nowhere.

 8520.  March 8, 1995         $HLPFIL/CL2HF.FOR              Ed F
        Improved help file in conjuction with code in previous
        entry.  Removed INFILE adverb and added TIMERANG adverb.
        Improved help and explain file.  Move nowhere.

 8521.  March 8, 1995         $HLPFIL/POPSDAT.HLP            Athol
        Add new task-specific adverbs to POPSDAT.HLP, namely
        TREC(30), TAU0(30) and DOFIT(30), which are used for
        antenna-specific receiver temperatures, zenith opacities
        and control of the opacity fitting respectively.
        Moved nowhere.

 8522.  March 8, 1995         $APGOOP/HF2SV.FOR              Ed F
        Made lots of changes to improve HF2SV.  Added OUTFILE
        adverb to specify directory of the binary output from
        HF2SV.  Fixed a few small bugs in program.  Moved
        nowhere.

 8523.  March 8, 1995         $HLPFIL/HF2SV.HLP              Ed F
        Added OUTFILE adverb for location of output binary
        data.  Moved nowhere.

 8524.  March 8, 1995         $APGOOP/HFPRT.FOR              Ed F
        New task HFPRT prints the contents of the HF extension
        file.  Moved nowhere.

 8525.  March 8, 1995         $HLPFIL/HFPRT.HLP              Ed F
        Help file for new task HFPRT which prints the contents
        of the HF table.  Moved nowhere.

 8526.  March 9, 1995         $APLGEN/ZWHOMI.FOR             Pat
        Changed the assignment of graphics device number for the REMOTE
        category (i.e. where you're at a graphics terminal).  Instead of
        the arbitrary numbers 241-255 (240 + POPS#), use the first 15
        devices after the last TV device.  Assuming AIPS managers set up
        their SP files correctly, this should not be a problem.  The new
        rule will be #tek devices = 35 + #tv devices.
        Also changed $SYSUNIX files TVDEVS.SH, AIPSEXEC and START_AIPS.
        Moved START_AIPS to /AIPS locally.

 8527.  March 13, 1995          $HLPFIL/TABED.HLP           Leonia
        It was not clear from the HELP that OUTVERS has to be equal
        INVERS for header functions (OPTYPE='key'). This statement has
        been clarified. The erronious statement: "Input file is ignored
        for OPTYPE = 'key' has been changed for correct: "Output file .."
        Moved nowhere

 8528.  March 13, 1995              UVFIT                    Chris
        At some time (probably when antenna gain fitting was added)
        the maximum number of parameters to be fit without was changed
        from 24 to 52 without changing the sizes of some internal arrays
        nor the workspace of DVDMIN.  This caused anything from infinite
        loops to nonsensical fits.  Changed the internal arrays to
        be dimensioned by XMXPRM and increased the array sizes in
        DVDMIN to cope with up to 64 parameters.  Also added a frightening
        error message to DVDMIN in case its limits are exceeded.
        Moved nowhere.

 8529.  March 14, 1995            $APGNOT/ACCOR.FOR         Leonia
        The logic of determining whether the disired SN table had existed or
        not was wrong. As a result there was an annoying warnings in some
        cases. Additionnaly the task could not work in the very rare case
        of zero auto correlation spectrum amplitude and non zero corresponded
        weights.
        Moved nowhere

 8530.  March 15, 1995        $YPGNOT/UVPLT          Craig/Phil
        Craig passed along some changes that enable UVPLT to self-scale
        each axis seperately and automatically when requested. He also
        tidied up the self-scaling algorithm.
        Moved nowhere.

 8531.  March 15, 1995       Gain curve routines               Athol
        Added or updated several routines and include files for the
        new gain curve (GC) table format. These include:
        $INC/PGCV.INC   -  parameter include containing column
                           pointers for GC table.
        $INC/DGCV.INC   -  declaration of row variables for reading
                           or writing to the GC table.
        $APLNOT/GCINI.FOR -  initialise a GC table.
        $APLNOT/TABGC.FOR -  read/write a GC table row.
        $APLNOT/GCKEY.FOR -  read/write the GC table keywords.
        Moved nowhere.

 8532.  March 15, 1995   $APGNOT/ANTAB.FOR  $HLPFIL/ANTAB.HLP     Athol
        New task which, in conjunction with a forthcoming task APCAL,
        will constitute an alternative to ANCAL. This task (ANTAB) reads
        an external amplitude calibration text file and updates the
        TY, GC and BL tables accordingly. Numerous new features have
        been added to allow greater flexibility in the allowed format
        of the calibration file. This includes the ability to specify
        an arbitrary many-to-many mapping of Tsys/Tant column number
        to IF/polzn, the ability to have IF, polzn. and freq. specific
        gain curves, the possibility of entering tabulated gain curves
        and the ability to run the task multiple times with the same
        tables without difficulty.
        Moved nowhere.

 8533.  March 16, 1995  $APGNOT/UVFLG.FOR           Leonia/PHIL
        The new parameter DTIMRANG has been added in INFILE giving
        opportunity to expand a TIMERANG interval in both side by
        DTIMRANG seconds. The relevant adding to HELP has been done.
        An error has been fixed to ensure flagging is applied to all
        source qualifiers if no qualifier is specified.
        Moved nowhere.

 8534.  March 16, 1995      $APLNOT/TABGC.FOR             Athol
        Dec Alpha required that the order of two declaration statements
        be reversed before it would compile TABGC correctly.
        Moved nowhere.

 8535.  March 17, 1995      $YPGNOT/POSSM.FOR             Leonia
        If reverse of X-axis has been desired but labeling was in channels
        POSSM labeled the axis finishing by zero donot paiing attention on
        BCHAN and ECHAN. I fixed it.
        Moved nowhere

 8536.  March 17, 1995      $APGNOT/SPLIT.FOR            Phil
        When multiple sources are selected and BIF > 1 then after the
        first source BIF was reset to 1 in subroutine SPLCOP. Fixed.
        Moved nowhere.

 8537.  March 20, 1995      $APGNOT/ANCAL.FOR             Athol
        Allow multiple runs of ANCAL if necessary. Also check EIF
        against the catalog header and set accordingly if not
        specified.
        Moved nowhere.

 8538.  March 20, 1995           CALIB                  Chris
        The DOPTMD flag is now set only if IN2NAME and IN2CLASS are
        both blank.  The previous behavious was at variance with the
        help file and bypassed some consistency checks on the adverbs.
        Moved nowhere.

 8539.  March 21, 1995              TABCOP                 Eric
        Changed to suppress the copied message if 31990 <= MSGSUP <
        32000.  Otherwise the message is sent with level 3 to MSGWRT
        where other MSGSUP rules apply.
        Moved nowhere.

 8540.  March 21, 1995          POSSM                  Chris
        Subroutine POSSPL was using OPTICL, ALTRFP and REFVEL without
        setting them.  This should have had some observable consequences
        when plotting against velocity.  Modified LABLAX to return
        these values.
        Move nowhere.

 8541.  March 21, 1995          $RUNSYS/NEWPARMS.001       Athol
        Add TREC(30), TAU0(30) and DOFIT(30) to NEWPARMS.
        Moved nowhere.

 8542.  March 22, 1995            TV object                  Eric
        Created a TV class and added it to the system.  Changed:
        HLPCLEAN   $HLPFIL/ New Clean object TV interactive help file.
        TVDEVICE   $APLOOP/ TV device class does class functions and
                   basic TV functions (by calling $YSUB routines)
        TVUTIL     $APLOOP/ utility functions of simple call sequence
                   to do TV operations
        GENERIC    $APLOOP/ added TV class knowledge
        QCLEAN     $QOOP/ Add CLNTV and CLBCHK routines to do TV.
        TVMENU     $YSUB/ new to display menu and return selection
        TVTPOS     $YSUB/ read TV cursor with prompt & timeout options
        PLAY       $APGOOP/ New task
        PLAY       $HLPFIL/ Help for new task
        HLPPLAY    $HLPFIL/ Interactive help for new task
        Moved nowhere.

 8543.  March 22, 1995           IMAGR                    Eric
        New task intended to replace all older imaging tasks.  It is
        WFCLN with all of the calibration adverbs exposed.  Changed
        QUVUTIL    Set new adverbs into DMPR common.
        UVUTIL     Changed UV2SCR to suppress table copied messages and
                   added Bill's CP2SCR which copies uvdata to a scratch
                   file looping over subarray.
        QWTGET     New: returns a row of weight summing array w robust
                   summing.
        QWTGRD     New: convolves weights to summing grid, counts
                   samples to robust count grid.
        QWTSUM     New: does summing needed by robust option.
        ROBUST     New: Help file for new adverb - uniform weight
                   tempering parameter.
        UVBOX      Help file updated for extended UVBOX meaning.
        UVBXFN     New: Help file for new adverb - box counting function
                   and shape.
        UVSIZE     New: Help file for uniform weighting array size.
        UVWTFN     Help file revised to show the options clearly.
        UVWAIT     New: do uniform and other weightings.
        WTFUNC     New: compute weight counting functions and put them
                   into the AP.
        GRDFIT     New: determine whether the proposed weighting and
                   gridding operations will fit into the AP memory with
                   and without sorting.
        MAKMAP     Changed to call GRIDUV
        GRIDUV     $QNOT new: Does only one pass on data.
        Moved nowhere.

 8544.  March 22, 1995           PCAL                Chris
        Incorporated a fix from Martin Shepherd that stops PCAL from
        overwriting sections of the CATBLK if there is no IF axis
        present in the input data file.
        Moved nowhere.

 8545.  March 23, 1995           IMAGR                    Eric
        Changed QCLEAN to display the dirty image (allowing you to set
        windows at that stage) on the TV.
        Moved nowhere.

 8546.  March 23, 1995              KNTR                  Eric
        Changed KNTR to allow you to control whether the edge between
        blanked and good regions is plotted or not.  Changed KNTR.HLP,
        POPSDAT.HLP, NEWPARMS.001 and created DOBLANK.HLP to give this
        control.  DOBLANK might replace other adverbs used for similar
        purposes some day.
        Moved nowhere.

 8545.  March 23, 1995             MBDLY                  Pat
        Remove references to external BLAS routines ISAMAX and SMIN as
        these are not used.  Besides, the Dec Alpha compiler for OSF/1 1.2
        does not contain the BLAS library.
        Moved nowhere.

 8546.  March 23, 1995            POSSM               Chris
        Changed OUTFILE writing to take possible reversals of the
        AMP and PHASE arrays (caused by APARM(10) = 1) into account.
        Channel data is now written out in channel/IF order.  Previously
        channel and velocity labels were written in channel/IF order
        but the amplitudes and phases were reversed.
        Moved nowhere.

 8547.  March 24, 1995    $APLNOT/GCTAB.FOR and $APLNOT/GCIO.FOR     Athol
        Removed these two routines which have been replaced by TABGC
        and GCKEY respectively (see #8531).
        Moved nowhere.

 8548.  March 24, 1995        DBCON                     Leonia
        Having different header frequencies in concataneted files
        the task calculated wrong frequencies for a source not existed
        in the first file. In this case the task took the header frequency
        from the first file but frequency entries for SU table from the
        second file. As a result the frequency for such a source was wrong.
        I added the difference between the header frequencies to the
        frequency entries for SU table from the second file, if the source
        exists in the second file but does not in the first one.
        Moved nowhere.

 8549.  March 27, 1995        $APLNOT/BPFSEL              Phil
        As BPFSEL copied BP tables it would replace the imaginary column
        by the real column, obviously due to a typo. Fixed.
        Moved nowhere.

 8550.  March 27, 1995         $QPGNOT/CVEL               Phil
        For some unknown reason the copy of CVEL at the AOC was not the
        same as the copy on baboon. The MNJ must have failed.
        Fixed up a minor problem with a buffer size and will watch the
        MNJ carefully tomorrow.
        Moved nowhere.

 8551.  March 27, 1995        $APGOOP/HFPRT               Pat
        This task was not compiling under Linux, as there was mixing of
        integer*2 and integer in calling sequences (the int*2 are
        necessary for the HF table format, I think).  Changed key
        variables to regular INTEGER, uppercased code, split common into
        character and numeric commons, shortened variable names to at most
        6 characters, and removed a bogus variable from a format
        statement.
        Moved nowhere.

 8552.  March 28, 1995        Gain curve routines         Athol
        Added or updated several new gain curve (GC) table routines used
        in amplitude calibration tasks such as APCAL.
           The new routines are:
        $APLNOT/GETGC.FOR - read all gain curve information for a specific
           antenna,suba. and fqid. Analogous to GETSOU/GETANT etc.
        $APLNOT/GCVAL.FOR - compute gain value at a specific sky position
           after calling GETGC. Analogous to SOUELV.
        $APLNOT/DGNRAO.FOR - compute Legendre-type polynomials cutomarily
           used to define the GB 140ft gain curve.
        $APLNOT/INTERP.FOR - unweighted 1-d linear interpolation routine
           used for interpolating tabluated gains and elsewhere in APCAL.
           Updated code:
        $INC/DGCV.INC - include file used by GETGC and GCVAL corrected for
           faulty subscripting.
        Moved nowhere.

 8553.  March 29, 1995     $APLNOT/GETGC & GCVAL  $INC/DGCV.INC    Athol
        Temporarily removed these routines. Large declared buffers to
        accomodate GC records were causing shared library problems.
        Moved nowhere.

 8554.  March 31, 1995     $SYSUNIX/LIBR, $UPDUNIX/UPDREMOVE       Pat
        (Actually most of the work was done by Athol and Martin Shepherd).
        When I changed the shared library location to $LIBR/<name>.so
        instead of $LIBR/<name>/SUBLIB.so, I updated the code in the LIBR
        shell script but not the UPDREMOVE one.  This caused the .so's at
        the Midnight Job sites using shared libraries to become out of
        step with reality.  Also, under SunOS, use of the -d qualifier to
        the ld command is apparently necessary to avoid an unusual failure
        of ld.so to map large common blocks at runtime.
        Moved to the AOC (aguila, laphroaig, pilabo, miranda) this date
        and last night.

 8555.  March 31, 1995     $QPGNOT/PCAL, $APGNOT/SPLIT             Pat
        Thanks to Colin Lonsdale for finding these bugs.  Apparently they
        both declared a hollerith scalar HSOLT but then proceeded to treat
        it as an 8-byte quantity.  Modified both declarations so that it's
        HSOLT(2) instead; Colin reports this cured the problem (but not
        his shaky faith in AIPS :-)
        Moved nowhere.

 8556.  March 31, 1995             IMAGR                       Eric
        Changed:
        GETCTL   $APLNOT: to put out I polarization.. message iff MSGSUP
                 < 31900, but return the messge in MSGTXT in any case.
        ALGSUB   $QNOT: corrected computation of how many rows of grid
                 are needed for bandwidth synthesis, corrected AP memory
                 usage to allow for more when the # vis limit kicks in,
                 added a message re polarization and channels
                 suppressing the message from GETCTL.  This corrected a
                 bug that let channels not be subtracted!
        UVMSUB   $QNOT: commented out the gridded-interpolation model
                 message.
        ALGSTB   $QNOT: reduced the AP core used for vis's to 20% and
                 added a message giving pol and channels, suppressing
                 the one from GETCTL.
        GRDFIT   $QSUB: added tests on size needed for gridded
                 subtraction.
        IMAGR    $QPGOOP: changed call seq to GRDFIT passing the
                 subtraction method.
        Moved nowhere.

 8557.  April 3, 1995         $SYSUNIX/TVDEVS.SH              Pat
        Minor modification enabling the user to use the buffered I/O
        feature of XAS.  If you define the environment variable
        AIPS_TV_BUFFERED to be YES (uppercase), then the TVDEVxx variable
        will in turn be defined automagically with SSSINB instead of
        SSSIN, thereby triggering appropriate code in XAS.  This should
        help with slow network links such as a 14.4k modem.
        Moved nowhere.

 8558.  April 3, 1995            TV change                    Eric
        Giving up only 4 more colors to the graphics planes it is
        possible to have 8 graphics channels rather than 4.  This should
        make for some interesting further graphics work.  Changed GRCH
        limits in a lot of help files and changed code to think of
        channel NGRAPH rather than 4 as the background channel.  Changed
        $HLPFIL CNTR  DFTPL  GAL  GAPLT  GNPLT  GRCHAN  GRCLEAR  GREYS
                GROFF  GRON  IMEAN  IMVIM  IRING  ISPEC  KNTR  OFFSCROL
                PCNTR  PFPL1  PFPL2  PFPL3  PLCUB  PLROW  POPSDAT  POSSM
                PROFL  SL2PL  SNPLT  TVSTAR  TAPLT  TVANOT  TVPL  TVSCROL
                UVHGM  UVPLT  VBPLT  FRPLT  TVLINE  TVDIC  GREAD  GWRITE
                TVCPS  CLPLT  CCNTR  CONPL  VPLOT  PLAY  XAS
        $AIPSUB AU5     AU5B    AU5E
        $YSUB   IAXIS1  IMANOT  ITICS  TVALUE
        $YPGNOT TVCPS - new coloring scheme
        $YSERV  XAS.SHR
        Moved nowhere.

 8559.  April 4, 1995    $QYPGNOT/MX.FOR                      Athol
        Warn if AC data are being mapped; these can be de-selected with
        UVRANG if necessary. Max. U-baseline was scaled twice for the
        frequency offset, both in MXSEL and the gridding subroutines;
        corrected this. Also fixed minor bug in checking BMAJ before
        deciding whether a residual map was required; this would fail
        for BMAJ in the range -10mas to zero - too coarse for VLBI.
        Moved nowhere.

 8560.  April 4, 1995            IMAGR                     Eric
        Changed IMAGR to get the correct numerical size of the beam from
        the BEAM object before deciding on whether or not to sort.
        Corrected GRDFIT to use the correct ULIM in cells for the image
        (beam or clean) in its second test rather than in cells for the
        weighting.
        Changed IMAGR to insert the zero-spacing in the file copy so
        that it applies in the weighting as well as the gridding and
        dropped it from the CLEANO objects so that it does not go into
        the images.  Changed IMAGR help file to explain the new ZEROSP
        adverb meanings.  Changed GRIDUV to check the sort order and if
        X sort is required to die if the sort is not done.
        Moved nowhere.

 8561.  April 4, 1995  $APGNOT/UVCOP.FOR   $HLPFIL/UVCOP.HLP   Athol
        Added facility to allow clipping data with weights below
        a certain threshold. This limit is specified by UVCOPPRM(5)
        if flagging data with bad weights is enabled.
        Moved nowhere.

 8562.  April 5, 1995  $SYSUNIX/EHEX.PL                       Jeff
        Perl front end to $SYSPERL/ehex.pl "library" for dec-to-ehex
        (and ehex-to-dec) conversions.  Itty-bitty standalone utility.
        Moved nowhere.

 8563.  April 5, 1995  $SYSUNIX/DADEVS.PL                     Jeff
        Perl version of $SYSUNIX/DADEVS.SH (much faster than the shell
        version).  Not yet implemented, but will be soon on systems that
        have Perl versions >= 4.036 available (which will be
        auto-detected).
        Moved nowhere.

 8564.  April 6, 1995               SAD                     Eric
        Changed code and help file to:
        (1) Reject only some components in a multiple distinct
        component island rather than rejecting them all when any one is
        deemed inacceptable.  If it attempts to fit a complex area with
        two components and 1 of those is rejected it will revert to the
        single-componet (poor) fit.
        (2) Add option to constrain widths to > Clean beam min and to
        encourage widths >= Clean beam max.
        Moved nowhere.

 8565.  April 6, 1995             TVANOT                   Eric
        Changed AU5B to handle graphics channel assignment better.
        GRCH = 8 means letter in 8, not letter and background in 8.
        Moved nowhere.

 8566.  April 6, 1995            FITLD                   Phil
        I added the code necessary to deal with FREQIDs that are
        actually the same but that get renumbered at correlator job
        boundaries. FITLD will now tell users about FREQIDs as it reads
        the data in. Removed subroutine CA2CL which is not used.
        Moved nowhere.

 8567.  April 7, 1995       $YPGNOT/FRMAP               Leonia
        I installed the default value for TIMERANG, which is equal
        to the time range of the data itself. The help file is
        updated and improved.
        Moved nowhere.

 8568.  April 7, 1995        $HLPFIL/TVCPS.HLP              Phil
        The upper limit for the value of GRCHAN in the helpfile was too
        low following Eric's changes to the # of graphics channels.
        Moved nowhere.

 8569.  April 9, 1995        $SYSLOCAL/NOSHARE.LIS          Athol
        Add FRING to NOSHARE.LIS.
        Moved nowhere.

 8570.  April 10, 1995       $QPGNOT/CVEL.FOR           Leonia
        A floating point error occured in ALPHA (CfA). It happened
        because upper limit of one of the loop on antennas MAXANT is
        much bigger than number of antennas in data. The calculation for
        the unexisting antennas leaded to the floating point error. I
        change the upper limit from MAXANT to NSTNS-number of antennas
        in data which is calculated in GETANT.
        Moved nowhere.

 8571.  April 10, 1995             TVCPS                  Chris
        Replaced faulty code for colouring the graphics planes with
        code to XOR the graphics planes together.  I assume, in the
        absence of any comments explaining the intent of the code,
        that this is what was intended.  The previous code had the
        end effect of setting the colours of all the graphics planes
        to black and potentially accessed an array beyond its declared
        bounds.  THIS IS WRONG - it does not work that way anymore - I
        WILL DO SOMETHING ELSE. (ERIC)
        Moved nowhere.

 8572.  April 10, 1995          SAD                         Eric
        Changed it to scale the width constraint by DPARM(9) rather than
        0.1 which is probably too small.  0 => 0.3 and the limits are
        0.01 to 1.0.
        Moved nowhere.

 8573.  April 11, 1995             TVCPS et al               Eric
        Changed TVCPS by fixing my version.  The colors of the graphics
        channels are Xor'd for channels 1-4 only.  Channels 5,6,7,8
        appear only if no lower numbered one is on.  Also made Phil's
        fix to all affected help files: GRCLEAR, GROFF, GRON, OFFSCROL,
        TVANOT, TVDIC, TVLINE, and TVSCROL.
        Moved nowhere.

 8574.  April 11, 1995              IMAGR                    Eric
        Changed $QNOT UVSORT to respond to errors from SRTIN.  Changed
        SRTIN to use non-excluive ZOPENs if the two files being opened
        are the same.  Apparently, the file locking used at the AOC
        (flock) does not allow the same process exclusive use of the
        same file twice while the network-wise fcntl has other superior
        wisdoms and does allow this operation.
        Moved nowhere.

 8575.  April 11, 1995      START_AIPS, AIPSPATH, RUN, etc   Pat
        Inserted support for DADEVS.PL (the perl equivalent of DADEVS.SH)
        in the various shell scripts.  First, AIPSPATH.SH/CSH now check
        the path specified to perl in the first line of $SYSUNIX/DADEVS.PL
        and see if it's really there (default /usr/local/bin/perl; I'll
        have INSTEP1 set this).  If so, this sets an environment variable
        that START_AIPS, RUN, and START_TPSERVERS all know about.  Each of
        these in turn will check if that environment variable is set, and
        if so, run DADEVS.PL (and then "dot" and delete the temporary
        output file it produces); otherwise they just "dot" the DADEVS.SH
        script.  The improvement in speed of DADEVS.PL over DADEVS.SH
        cannot be understated; it's impressive (I didn't do DADEVS.PL,
        Jeff did).
        Moved relevant scripts to $AIPS_ROOT in CV today.

 8576.  April 11, 1995             TV                          Eric
        Changed IENHNS to use graphics channel NGRAPH-1 rather than 1.
        Changed TVFLG and SPFLG to know this and take less defensive
        action than before (usually).  Also removed unused variables.
        Changed TVDEVICE for IENHNS and to support up to 8 channels and
        graphics planes.  Changed TVUTIL to handle 8 also.  Changed
        QCLEAN to turn off all graphics channels initially.
        Moved nowhere.

 8577.  April 11, 1995         FITLD                      Phil
        My fix #8566 did not deal with all of parameter space. I fixed
        the immediate problem I was dealing with but then broke most
        others since I did not update the FQ table with the new FQIDs
        (if necessary of course) at job boundaries. This resulted in
        disconnected data within the file. This is now fixed and should
        now work for all data - famous last words.
        Moved nowhere.

 8578.  April 11, 1995           *TESS                    Eric
        Changed DTCIO.INC to increase buffers to 16K words.  Recompiled
        a shit load of subroutines in $APLNOT and $QNOT.  Changed UTESS,
        LTESS, STESS, and IMERG to set the buffer size correctly - most
        were setting it to 4K words or 8K words, not XBUFSZ words.
        Relinked these and VTESS which did it correctly.
        Moved nowhere.

 8579.  April 11, 1995         $APGNOT/ANTAB.FOR           Athol
        A few added features: allow DPFU = RCP,LCP as in ANCAL;
        print bad times in HH:MM.MM format to be compatible with
        calibration file format; improve consolidation of TY
        records for the case of Ta/Tsys entries.
        Moved nowhere.

 8580.  April 12, 1995         $SYSUNIX/DADEVS.PL          Jeff
        Now catches signals and removes /tmp/DADEVS.$$ file (forcing
        DADEVS.SH script to run on some OS's).  Returns exit status of 1
        if signal caught.  Calling scripts should probably now check its
        exit status and act accordingly, if the desired effect of a
        signal is to abort the startup under all OS's.
        Moved nowhere.

 8581.  April 12, 1995    $SYSUNIX/*.PL $SYSPERL/*.pl      Jeff
        Minor fixups to work under Perl version 5.  Added library
        function to be called by scripts to check for a "tested" version
        of Perl (currently only 4.036 and 5.001 are tested), with a
        non-fatal warning message displayed if an untested version of
        Perl is being used.  All scripts modified to call this.
        Moved nowhere.

 8582.  April 12, 1995       FITLD                      Phil
        A rounding error in comparing the frequency from the catalogue
        header and the freq. keyword in the FR table was causing
        spurious freqids to be generated, especially with high frequncy
        observations. I used the knowledge that all frequencies to be
        encountered from the VLBA correlator are modulo 10kHz and so
        overcame this nasty little problem.
        Moved nowhere.

 8583.  April 13, 1995     $YPGNOT/FRMAP.FOR            Leonia
        I have discovered several small bugs in the programm having
        tested it with the data having big value of preavrage interval.
        The rounding of time worked wrong when time's step is named
        equal to the preavrage interval of the data. The program does
        allow to have namber of solution interval more than 10. There
        was not a warning about this limit. The problem are fixed.
        Moved nowhere.

 8584.  April 13, 1995    $YPGNOT/APCAL.FOR $HLPFIL/APCAL.HLP  Athol
        New task for amplitude calibration, primarily of VLB data.
        Takes as input the system temperature (TY) table and gain
        curve (GC) table produced by ANTAB and writes a SN table
        containing amplitude gain corrections. Can solve for
        atmopsheric opacity and plot the resulting solutions or
        use a pre-defined receiver temperature in making the
        opacity corrections. Opacity algorithms still under
        evaluation but placed in TST for wider access. Use plot
        type 1 for now; update AU8A.FOR shortly.
        Moved nowhere.

 8585.  April 13, 1995               FITTP et al                 Eric
        FITTP has been writing an extra header-like record in place of
        table data when there is no table data.  Changed EXTREQ to skip
        records looking for the next table (or TABNAME old tables or
        SIMPLE a new data file) and count those skipped.  Changed MLREOF
        to take the count as an input/output variable.  Changed IMLOD,
        UVLOD, GSCAT and FITLD to handle this count and report it.
        Changed PRTTP to skip records, count, and report also.
        Moved nowhere.

 8586.  April 13, 1994            IMAGR, MX, WFCLN            Eric
        All Clean tasks have the idea that, when the clean is within 10%
        of the max number of iterations, a major cycle ought to keep
        going.  While, with small jobs this is reasonable, with CasA and
        1000000 iterations this means that the last major cycle is about
        100000 iterations.  But, with CasA, all other major cycles are
        about 3000 iterations or less.  This ain't right.  Changed
        QCLEAN and MX to make the limit 0.5 of the last major cycle or
        of CLNLIM, whichever is smaller.  This means that a cycle is
        extended no more than half of its expected length.
        Moved nowhere.

 8587.  April 13, 1995            VPLOT                     Leonia
        The task did not work with negative SOLINT. Inspite of the fact
        that only positive or zero values were recomended in HELP for
        SOLINT, the failure of the task when SOLINT is negative bothered
        users. Now both SOLINT=0 and SOLINT<0 correspond to abcense of
        time averaging. Help file is updated.
        Moved nowhere.

 8588.  April 17, 1995          OOP imaging               Eric
        Preparing for SCMAP, corrected bugs and changed:
        UVUTIL   (UV2SCR) to do coordinate rotation and correct the sort
                 order for it.
        GRIDUV   Changed to require the AP for no more than 2048 vis
                 recs rather than simply using a quarter of the AP.
                 This changed a limit, for example of 239 rows to 314
                 rows - enough to fit a 512x1024 in this case.
        ALGSTB   Was using too much AP by far for data - causing us to
                 skip the sort and then do multiple passes in ALGSTB.
        ALGSUB   Was also using too much AP for data.
        GRDFIT   Changed call seq and code to do specific tests or all
                 of them depending on a TYPE argument.  Correct
                 computation for GRIDUV, ALGSUB, ALGSTB requirements.
        GRDFLT   Added message control levels.
        QUVUTIL  Changed OUNFWT and OUVIMG to decide about sorting and
                 sort if needed for the weighting or gridding resp.
        QCLEAN   Added CLNSRT and changed CLNUV to call it to make the
                 same decisions re gridded component subtraction.
        IMAGR    Dropped IMSORT, leaving the work to the above.  Added
                 CPARM(10) option to control beam image size.
        IMAGR    Help - changed for CPARM(10).
        Moved nowhere.

 8589.  April 17, 1995             SCMAP                     Eric/Bill
        Suprisingly enough it seems to work.  Added all the new imaging
        adverbs - UVSIZE, ROBUST, UVBXFN, ROTATE, MAXPIXEL, FLAGVER,
        DOTV - plus BPARM and CPARM to allow sub-array weighting and
        different reference antennas for each subarray.  It really zips
        along for VLB data sets.
        Moved nowhere.

 8590.  April 17, 1995          $SYSUNIX/REVENV.C             Pat
        Small, not very smart program to do (fast) reverse lookup of an
        environment variable.  In other words, you give it the value, it
        gives you the first name to match that value.  Like its sibling
        PRINTENV.C it chdir()'s to "/" to avoid the usual PWD ambiguity.
        This will shortly be used in the various shell scripts that
        currently do ugly things with PRINTENV and "grep -v".
        Moved nowhere, but have to allow for it in MNJ's and INSTEP1...

 8591.  April 17, 1995        $APGNOT/ACCOR                 Leonia
        I added a source ID, FREQID, SUBARRAY in the SN table.
        The first task had forced these parameters to constant.
        Moved nowhere.

 8592.  April 18, 1995     $APGOOP/HFPRT, MBDLY             Pat
        Corrected typos in several format statements after reports from
        the Bonn HP-UX based midnight job that they failed.  AIPS
        Programmers should note that the HP Fortran compiler is
        EXTREMELY fussy about correct syntax in FORMAT statements.  If
        you leave out ONE comma (e.g. FORMAT (1X,'Hi there' I4) no comma
        between the text and the I4), the compile will fail.
        Moved nowhere.

 8593.  April 18, 1995               SAD                       Eric
        Changed a bad write statement in the history routine.
        Moved nowhere.

 8594.  April 18, 1995             IMAGR                       Eric
        Changed TVDEVICE to implement read/write graphics colors and
        read/write (!) the TV window.  Changed QCLEAN (CLNTV) to test
        the window size and increase it if needed.
        Moved nowhere.

 8595.  April 18, 1995              SCMAP                     Eric
        Changed program and help to start implementing a TV optiion to
        be doen at the end of each full Clean.  So far all it lets you
        do is look and stop the self-cal.  It should be able to do more
        such as looking at the restored image and editing vis data!
        Moved nowhere.

 8596.  April 18, 1995             $APGNOT/SNSMO.FOR          Athol
        Fixed some IF statements in subroutine REFFAZ which relied
        on short-circuit Boolean evaluation and thus failed on
        the DEC Alphas. Also check whether the preceding point
        is blanked before extrapolating phase to resolve 2pi
        ambiguity.
        Moved nowhere.

 8597.  April 19, 1995          $APLULTRX/ZTAP2.C             Pat
        This has been removed (though I have a copy stashed away).
        Apparently on Ultrix systems with DAT drives it didn't work, in
        the same way an old version of the Alpha equivalent didn't.  A
        site in Italy had a problem so I recommended they try the Alpha
        version (in $APLDEC) which worked perfectly for them.
        Nothing to move.

 8598.  April 19, 1995            IMAGR et al                 Eric
        Fixed QCLEAN (CLNSRT) to put the correct dimension on the sort
        order requested.  Sorting was failing if attempted at this
        point.  Also changed it to do the sort only if there will be
        components to subtract and to know if the dirty map (or 1st
        residual) is both the first and the last image and so not do all
        the TV interaction, just the TV display.
        Moved nowhere.

 8599.  April 19, 1995           Alpha found                  Eric
        POPSGN  $AIPPGM: used POTERR without setting it
        APCLN   $QYPGM: used R1 without setting it, replaced with 1.0.
        BBUILD  $AIPSUB: used PRGNAM with the needed DATA.
        PRINTER $APLOOP: mis-spelled INDXF in PRTIMH.
        UVDPAD  $APLNOT: continued a string constant across a line which
                    probably included a large number of blanks
        UVMSUB  $QNOT: also continued the same string across lines.
        UINIT   $AIPSUB: had all the POPS errror management code and
                    never branched to it.
        MFILL   $APLNOT: never branched to one error type.
        IMREF1  $APLNOT: never branched to two error types.
        ZTTOPN  $APLDEC: skipped lots of code - removed it.
        ZSSOPN  $APLGEN: never branched to one error condition, removed
                    an unused variable too.
        IMGMEM  $QNOT: never branched to the MSGWRT call.
        APUTIL  $QOOP: removed all 995 CALL MSGWRT statements - none
                    were used
        QCLEAN  $QOOP: removed some of the extra MSGWRT calls at the end
                    since some were not called.
        ARRAY   $APLOOP: removed 12 of 990 CALL MSGWRT not used.
        CLEAN   $APLOOP: removed 1 excess MSGWRT call.
        IMAGE   $APLOOP: removed 1 excess MSGWRT call.
        IMAGEUTIL $APLOOP: removed 1 excess MSGWRT call.
        UVDATA  $APLOOP: removed 1 excess MSGWRT call.
        UVUTIL  $APLOOP: removed 3 excess MSGWRT calls.
        Moved nowhere.

 8600.  April 19, 1995          COMLNK, FC                   Pat
        Modified COMLNK so that it now marks the COMLNK.UPD "midnight
        job" log file ONLY if the file compiled/linked successfully.
        Also modified COMLNK and FC to allow compiling and linking to be
        done in a single command.
        Moved nowhere.

 8601.  April 20, 1995           AP in OOP                Eric
        Nowhere in AIPS OOP do we defend ourselves from one object using
        the AP while another object thinks it has it all to itself.
        Therefore:
        APDEVICE   $APLOOP: new class allows one AP open at a time.
        GENERIC    $APLOOP: recognize AP device calls.
        APUTIL     $QOOP: add APOBJ to do usual AP open/close (NOTE:
                       this is not a QINIT or QRLSE which are done
                       separately wherever.  The AP object name has the
                       subroutine name in it, allowing for unique ID and
                       traceback of failures (if any).
        QARRAY     $QOOP: add calls to QINIT, QRLSE and APOBJ to ARRFFT.
        QCLEAN     $QOOP: add calls to APOBJ in CLNCYC, CLRGRD, CLGRID
        QINTER     $QOOP: add calls to APOBJ in IMGINT, IMGHGE, IMGIAE
        QUVUTIL    $QOOP: add calls to APOBJ in ODFT, OUNFWT, OUMSUB,
                       OUMDIV, OUPDIV, OUCDFT, OUFDFT, OUVIMG, OUVSRT
        IMAGR      $QPGOOP: add calls to APOBJ in IMTAV, IMACPY
        WFCLN      $QPGOOP: add calls to APOBJ in WFTAV, WFCOPY
        CXCLN      $QPGOOP: add calls to APOBJ in CXLEAN.
        Moved nowhere.

 8602.  April 21, 1995      $APLSGI/ZTPWAD            Pat/Jeff Pedelty
        Under SG-Irix 5.3 (unlike 5.2 and earlier versions) the error
        return for an access to a record beyond EOF in a direct access
        FORTRAN file is not 27 or -1, but 168.  Modified this routine to
        check for all three.
        Moved nowhere (tested in 15JAN95 at GSFC by Jeff).

 8603.  April 21, 1995     $SYSALPHA/LINK                       Pat
        I created this at the start of the week in an attempt to let the
        linker (ld) know the optimization level.  Due to the increibly
        baroque manner in which the compile/linking is done in these
        (adjectives fail me) scripts, and the inadequacies of the sun4
        version of awk, I was unable to achieve this short of gutting
        the scripts altogether and starting over (in perl).  Removed
        this version of LINK.
        Moved nowhere.

 8604.  April 24, 1995 $APGNOT/BLAVG.FOR & BLAVG.HLP     K.Leppanen/Athol
        New task created by Kari Leppanen to average cross-polarized
        data over baseline and time, allowing a more robust
        estimation of R-L delay and phase differences.
        Moved nowhere.

 8605.  April 25, 1995 $RUNSYS/FXAVG.001 $HLPFIL/FXAVG.HLP    Athol
        New procedure to set the keyword SPEC_AVG in the AN table
        so enabling or disabling the delay de-correlation
        amplitude corrections required for the VLBA. This is
        basically a wrapper for TABED, a task which can present
        problems for the uninitiated.
        Moved nowhere.

 8606.  April 26, 1995		$APGOOP/SPECR.FOR		Dave
	SPECR was not properly dealing with single-source files; it
	would fail when no SU table was found. I added a call to
	MULSDB and put an IF in front of the call to SUUPDT.
	Moved nowhere.

 8607.	April 26, 1995  $SYSUNIX/*.PL $SYSPERL/check_version.pl  Jeff
        Changed calling convention for Perl version-checking to use
        process name vice a passed parameter.  Simpler and cleaner.
        Moved nowhere.

 8608.	April 27, 1995    $APGNOT/SNSMO.FOR                     Athol
        Correct IF statements relying on short-circuit Boolean
        evaluation. These brought to my attention by Martin Shepherd
        at Caltech.
        Moved nowhere.

 8609.  April 27, 1995    $HLPFIL/BPCOR.HLP                     Athol
        Correct wrap-around of a line in BPCOR.HLP.
        Moved nowhere.

 8610.  April 27, 1995  $APGNOT/ANCAL.FOR & ANCAL.HLP           Athol
        A default b-factor of 2.5 was assumed if keyword BDEFAULT was
        not set in the calibration file. This is an unsafe practice
        given that ANCAL now processes data from a variety of
        correlators. Changed the default to 1.0 and emphasised in the
        HLP file that this keyword should be set explicitly in the
        calibration file.
        Moved nowhere.

 8611.  April 27, 1995          SWPOL                           Chris
        The GEODLY array in SWPCAL was not large enough to hold the
        six polynomial terms used for VLBA data.  This resulted in
        array overruns and possible crashes when processing VLBA data.
        Increased the size of the array to 8 elements and doubled the
        size of TABUFF to agree with the dimension required by TABCAL.
        Moved to the patch area on this date.

 8612.  April 28, 1995       $APLGEN/ZWHOMI                     Pat
        (Actually April 27; I forgot to document what I did).  The
        remote graphics terminal option ("aips remote" on command line)
        was not working.  The startup scripts were setting 35
        environment variables TKDEVxx=/dev/tty where xx starts at the
        number of TV's (ehex) plus 1, and then setting TKDEV to
        "REMOTE".  While ZWHOMI picked up on the "REMOTE" string, it did
        nothing to the TKDEV environment variable.  Thus, any attempt to
        use the graphics "device" met with "no such device" errors.
        Modified the code so that it changes the TKDEV environment
        variable to TKDEVxx as appropriate, based on NTKDEV, the
        assigned graphics device (=#tvs plus POPS number).
        The "aips remote" functionality is now restored with the
        following caveat: the information in the image catalog for the
        tek devices is *site-wide*, whereas the assignment of remote
        graphics terminals is only host-specific.  In other words, two
        people could get the same graphics device number on two
        different hosts in a single site, and they would then be using
        the same slot in the IC file.  This will affect things like
        cursor lookup.  One possible solution is to make the ICv000000;
        file host-specific instead of site-wide (in SYSETUP, INSTEP1).
        Moved nowhere.

 8613.  May 4, 1995    $APGNOT/ANTAB    $YPGNOT/APCAL           Athol
        Neglected to check for valid JLOCIF in determing the IF
        axis dimension.
        Moved nowhere.

 8614.  May 7, 1995                IMAGR                       Eric
        Changes:
        QCLEAN    to limit the TV blow up factor of 256x256 images to 2
                  so as to leave some of the screen for other things.
        TVDEVICE  to use a variable rather than a constant for the type
                  parameter to IENHNS - it is an in/out variable.  This
                  caused Solaris machines to abort.
        UVWAIT    to avoid 0 divides without changing low but real sums
                  of weights to 1.  This led to "noise increases" < 1.
                  Also added code to write the WTNOISE to the image
                  header as a keyword.
        IMGMEM    to read the WTNOISE from the UV file and put it in the
                  image file header.
        MAKMAP    to read the WTNOISE from the UV file and put it in the
                  image file header.
        Moved nowhere.

 8615.  May 9, 1995            OOP and IMAGR                  Eric
        Changed:
        IMAGR      to get the paralactic angle for multi-source files
                   and to not claim to die if that trivia fails.
        TVDEVICE   to use the full buffer size - not half - IN TVLOAD.
        QUVUTIL    to use the full buffer sizes - not half - all over
        QARRAY     to use full buffer sizes in calls to PASS1 and 2.
        IMAGR      help file to limit ti 8192 not 4096 - may not work
                   that big however!
        ARRAY      Maxrow -> 8192
        CXIMAGE    Maxrow -> 8192
        CXUTIL     ROW -> 16384
        QCFFT      DWORK -> 16400
        QRFFT      TABLR, TABLI -> 2048
        QXFOUR     IBITRV -> 8192, C, S -> 2048
        QCLEAN     SIZROW -> 16384
        QIMAGE     MIN (-> 8192.
        Moved to the IBMs to try it out today.

 8616.  May 10, 1995          Compiler scripts               Chris
        Modified the AOC-specific compiler definitions to override the
        normal compiler pathnames only if the OS version is 5.3 since
        the compilers have revert to their normal location with the
        Solaris 2.4 upgrade at the AOC.
        Moved nowhere.

 8617.  May 10, 1995       buffer sizes                      Eric
        Increased buffer sizes in:
        $INC:    DBUF (WaWa IO)
        $APLSUB  IOSET
        $APLPGM: AHIST, COMB, MCUBE, PBCOR, PRTIM, SQASH, SUBIM
                 TAFFY, XBASL, XGAUS, XMOM, XPLOT, XSMTH, SAD,
                 SUMIM (from 2048!)
        $YSUB    CONDRW
        $YPGM:   CCNTR, CNTR, GREYS, IMEAN, IMVIM, PCNTR, PROFL
        $YPGNOT: KNTR, PFPL1, PFPL2, PFPL3, PLCUB, PLROW
        Found that a lot oof the OOP code was passing buffer sizes in
        words to routines that expected bytes.  Thus, we were using only
        1/2 of the buffers.  Fixed ARRAY.FOR May 11.
        Moved nowhere.

 8618.  May 14, 1995               TVMOVIE                  Eric
        Fixed AU5D to apply defaults to TXINC, TYINC, and TZINC.
        Divides by zero and odd things when TXINC = -2 (et al.) used to
        occur.
        Moved nowhere.

 8619.  May 14, 1995           imaging, IMAGR                   Eric
        Corrected ALGSTB - the gridded model subtraction routine for
        data with rotations or non-XY sorts.  It truncated a max U
        computation before frequency computation wher it should have
        rounded after increasing by the max frequency.  This led to very
        bad vis's in the residual file!  This could have affected many
        tasks - it was found in IMAGR.
        Changed HLPCLEAN.HLP to put in the TURN OFF DOTV option.
        Moved nowhere.

 8620.  May 14, 1994              SCMAP                      Eric
        Corrected:
        (1) Units for UV-range display
        (2) Handling of TVFIELD parameter so that the TV display at the
        end of each self-cal cycle could know what to do with windows
        even when the Clean TV display is off.
        (3) Display of final Clean image even if the Clean cycle TV
        display is off.
        (4) Increase of TV size to display the image adjusted.
        (5) Created HLPSCMAP.HLP for on-line helps.
        Moved nowhere.

 8621.  May 15, 1995                 CONPL                    Eric
        Had the wrong scaling for the convolution function - resulting
        in too narrow Gaussians.  Corrected to 4 / BPARM(9)**2 rather
        than 2 / DPARM(9).
        Moved nowhere.

 8622.  May 15, 1995              OOP, SCMAP                   Eric
        Changed:
        INPUT      to close onjects on error.  We run out of buffers if
                   we continue without doing this.
        SCMAP      to correct the lists of adverbs copied on TELL,
                   modify where the TELL calls are placed, etc. to get
                   the TELL to work.
        Moved nowhere.

 8623.  May 16, 1995               IMAGR                      Eric
        Added a large explain file section, partly stolen (and edited)
        from MX.
        Moved nowhere.

 8624.  May 17-18, 1995             imaging                    Eric
        All CC model subtraction and division programs EXCEPT MX go
        through GRDAT to initialize para,eters.  This routine made a
        simple linear computation hard and incorrect by doing a
        non-linear one instead.  With some A-array data at declination
        86 degrees this made a 0.2 cell error which would give the
        gridded subtraction subroutine a bad time.  GRDCRM reports
        problems > 0.05 cells but probably should complain on even
        smaller errors.
        FXSHFT has been complaining about shift and reference pixels not
        agreeing.  Changed the code to do an exact forward computation
        first to see if the invers transcendental equation even has to
        be solved.  I found that the forward and invers computations
        agree and in fact the header IS WRONG.  I do not know why for
        sure - perhaps because IMCREA used REAL*4's for some of the
        variables.  Changed that too and we shall see.
        This theory may be no good - there are 2 IMCREA's and the one in
        APLOOP probably won in IMAGR - so long as MAKMAP never had to
        make a map file.  Changed $APLOOP/IMAGR to rename IMCREA in
        there to IMCRET.
        Typo fixed in GRDAT on the 18th - after DDT fell apart.
        Moved nowhere.

 8625.  May 18, 1995      $APGNOT/VBGLU.FOR              Athol/Chris
        Constants were being passed to TABKEY in certain calls in
        subroutine GLUTAB where variables were required. On SUNs
        this precipitated curious I/O behaviour and generated an
        I/O error on a valid internal write further downstream
        (perhaps due to an overwrite of something crucial in I/O).
        IBM's survived this error without failure or apparent
        corruption of the tables.
        Moved nowhere.

 8626.  May 18, 1995                Misc                        Eric
        Changed
        SAD      to drop the width constraint option which did not work
                 right and raise the number of digits in the display of
                 RMS.
        POPSDAT  to fix TVALL to clear the background graphics channel
                 of the labeling (now 8 not 4).
        KNTR     fixed format of panel labeling to take needed accuracy
                 into account.
        Moved nowhere.

 8627.  May 18, 1995             TVWEDGE                      Eric
        Moved the wedge writing to a new subroutine called IWEDGE and
        took it out of AU5C which now calls IWEDGE.  All in preparation
        for adding functionality to the TV class.
        Moved nowhere.

 8628.  May 19, 1995      $APGNOT/ANTAB.FOR              Athol
        Corrected a minor bug in parsing the INDEX keyword which
        caused the program to fail complaining that it did not
        recognize 'X', a valid INDEX argument.
        Moved nowhere.

 8629.  May 22, 1995      $QPGNOT/CONVL.FOR              Athol
        Warn the user when the deconvolution calculation fails,
        and, in all cases, print the CLEAN beam size and
        convolving beam size used by CONVL. This information
        previously only recorded in the HI records.
        Moved nowhere.

 8630.  May 22, 1995      $APLNOT/AFRFI.FOR              Leonia
        The new subroutine AFRFI estimates the values of frequency,
        initial phase and amplitude of a complex exponent given
        (with noise) in the data set. A three step process is used, first
        an FFT stage with zero padding. The errors of the parameters
        determined in this stage are less than 0.5/N for the frequency;
        45 degrees for the phase and 10% for the amplitude, where N is
        the number of points in the data. In the second stage a search
        of the frequency and phase inside of the ranges mentioned above
        is performed. The theoretically known dependence of the phase
        change on the frequency change is used here. The final solution
        of the amplitude, frequency and phase is found by least square
        method. The output of the frequency is dimentionless. It has to
        be devided by period of data samples to obtain the correct value.
        Moved nowhere.

 8631.  May 23, 1995      $APGNOT/CLCOR.FOR              Athol
        As a result of a user request, enhance validation of input
        parameters for opcode 'ANTP', which corrects for antenna
        and source position offsets. These are: i) Abort with
        an error message if ANTENNAS=0 is used for this opcode;
        ii) check the array name in the AN table header in
        deciding whether VLA data are being corrected, rather
        than relying exclusively on CLCORPRM(7).
        Moved nowhere.

 8632.  May 23, 1995           TV IO errors                  ERic
        When the TV connection is broken during a TV operation, the
        attempt to clean up - off the cursor, off any display hold,
        close, ... - usually causes an interupt for broken PIPE and an
        abort.  Changed:
        DTVD.INC  Added parameter (TVBROK) to tell ZSSSXF not to do any
                  more IO.
        ZSSSXF    Test TVBROK to skip the IO, set TVBROK on error
        ZSSSOP    Reset TVBROK before open
        ZSSSCL    Reset TVBROK after close
        ZSSSX2    Set IO codes to 333 and 444 to be safer since ierr is
                  also used for the XAS error code (usually -1).
        Removed unused DTVD.INC from:
        AU5C, AU5E, AU6C, IENHNS, IMANOT, TVALUE, TVFIDL, TVLOAD,
        IWEDGE, OFMGAM, OFMCON
        Moved nowhere.

 8633.  May 24, 1995             TV Class                     Eric
        Changed
        TVDEVICE   Add functions TVDWED, TVDLAB, TVDOFM
        TVUTIL     Add functions to use these.
        AU5E       Change calls to OFMCON, OFMGAM, OFMMOD.
        OFMCON     Move to $YSUB, change call seq
        OFMGAM     Move to $YSUB, change call seq
        OFMMOD     Move to $YSUB, change call seq
        Moved nowhere

 8634.  May 24, 1995             TV changes                  Eric
        Changed:
        ITICS     to support labels to right and above and to specify
                  the graphics channel
        IAXIS1    to specify graphics chan to use to support labels to
                  right and above and to pass the chan on to ITICS
        IWEDGE    to specify which side of the image the wedge is on in
                  the call seq and to bury that info away in the header
                  for IAXIS1 to use.
        IMANOT    to not specify channel 4 as the background
        AU5B      to call new IAXIS1
        AU5C      to call the new IWEDGE
        PLAYR     to demonstrate all the new options of the TV class.
        PLAYR     help from PLAY.HLP to have new options.
        Dropped the older task PLAY in favor of a new name and added
        options called PLAYR.
        Moved nowhere.

 8635.  May 25, 1995        $YPGNOT/FRMAP                   Phil
        The two arrays ANT1 & ANT2 were declared to be of size MXBAS
        (local variable) rather than MXBASE. Fixed up and re-arranged
        order of includes slightly.
        Moved nowhere.

 8536.  May 25, 1995                  SAD                      Eric
        Corrected formats of RMS displays.  I had messed up one and not
        fixed the other.
        Moved nowhere.

 8537.  May 25, 1995               CONPL                       Eric
        Added a text file output option.
        Moved nowhere.

 8538.  May 25, 1995               SDGRD                       Eric
        Corrected an error in which the upper level routine asked the
        low level one to grid one extra sample each time (except the
        last).  This sample must have been 0 most of the time, but
        something on the IBM caused it to give trouble in the form of a
        5x5 square of constant largish amplitude (added to any real data
        at that point).  The amplitude was variable and 0 in some of the
        channels: it had values of 2, 4, 6, and 8 in my tests in other
        channels.  Why this should occur I have no idea - I even put in
        traps for large weights - since weight maps had large values at
        this squares - but nothing was triggered.  Sigh...
        Moved nowhere should go to patch.

 8539.  May 26, 1995             SDGRD                       Eric
        Changed the computation of the max number of channels that we
        can grid at a time.  It left little room for data.
        Yesterday's bug is better understood: it was getting data from
        the uniform weighting in the AP and got a lot of weight by
        gridding it many times rather than by an intrinsic large weight.
        There was also a chance due to another bug of overwriting one of
        the convolution functions with data.
        Moved to patch area.

 8540.  May 26, 1995               REMAG                     Eric
        Threw away the old version entirely and modified TAFFY to do
        what we wanted.  The old one used WaWA IO so poorly that a lot
        of its power was lost and the output image was correct only in
        the first plane, the rest were zero.
        Moved nowhere.

 8541.  May 26, 1995              IMEAN                      Eric
        The reversed plot (flux on x axis) had the X axis label going
        vertical.
        Moved nowhere.

 8639.  May 29, 1995              SDGRD                      Eric
        Changed the default weighting  to natural - uniform really does
        not make a lot of sense when doing interpolation images.
        Added a mode to compute an image which estimates 1/sigma**2
        for the convolved image.  This is te lead up to making a
        weighted image summing task.  Meant revising QGRIDA to have mode
        5 and making QGRD8 for this and QGRD7 for direct calling.
        Changed SDGRD and QGRD5, QGRD6, QGRD7, QGRD8 to do the
        multiplication of the uniform weighting factor in the gridding,
        and to find the maximum gridded/convolved weight to use to scale
        REWEIGHT(2) and the pure convolved and weight output images.
        Moved nowhere.

 8640.  May 29-30, 1995         GET4NAME, CLR4NAME              Eric
        Changed POPSDAT.HLP, NEWPARMS.001, and AU8.FOR to make new verbs
        to get and clear the 4th file name.  New help files too.
        Moved nowhere.

 8641.  May 30, 1995              WTSUM                       Eric
        New task to do a weighted sum.  The input weight images may be
        planes of cubes and may be of the rms or of 1/rms**2.  Had to
        create HENCO4 to store some of the history.
        Moved nowhere.

 8642.  May 30, 1995              UVFLG                       Eric
        It was changed by someone to demand an antennas file.  For
        single dish, this means that it does not work.  Changed it to
        test for AN files and to die if they really are needed (I hope).
        Also changed the handling of BDROP and EDROP to test for TABLE
        true and die since vis numbers do not go in the FG table and to
        apply BDROP and EDROP sensibly to single dish, rather than
        using "sample" numbers.
        Moved nowhere.

 8643.  June 1, 1995            GNU preparations             Eric
        Changed:
        $SYSUNIX/PP.FOR   to omit GNU copyleft statements found in
                          include files from the output .f file
        $APLSUB/OFMDIR    to ignore lines beginning with a semicolon on
                          read and to write the gnu copy left on write.
        Moved nowhere.

 8644.  June 1, 1995              Misc                      Eric
        CALIB    Will not do point solutions if GRID or IMAG is
                 specified.  The help does not say this nor did the
                 task.  Changed the latter.
        UVFIX    Switched the pointer INFILE for CNO but not for disk.
                 Changed to switch for both.  Thanks to Michael
                 Bietenholz.
        Moved nowhere.

 8645.  June 2, 1995              SCMAP                     Eric
        Changed NXTAVG in UVUTIL to read the uv data set to guess the
        data interval if the averaging time is zero on OPEN.  Changed
        the TV load in SCMAP to avoid excessive blowups of the image.
        Changed other default handling as well.
        Moved nowhere.

 8646.  June 2, 1995            IMAGR                      Eric
        Corrected QCLEAN to put the data product in the output image
        headers.  Changed warning msg format in IMAGR.
        Moved nowhere.

 8647.  June 2, 1995              XAS                      Eric
        Changed it to avoid using the lowest color values in the color
        table, therby leaving your first-created colors alone when it
        makes its non-default color map.  Then, your xterms should
        remain readable even when the cursor is in the TV window.
        Moved nowhere.

 8648.  June 3 & 4, 1995             Misc                     Eric
        GETJY   Added HI writing of input file name
        LISTR   Changed handling of ANTENNAS and BASELINE in LIST mode.
                It should work now without leaving things out or looping
                Also fixed an abort gotcha when there was no data in
                MATX.
        Something has caused my TVGAMA to be reset to 1.5 more than
        once.  I cannot figure out what causes that (say a TVOPEN, then
        a YTVCIN call and then a TVCLOS), but I am removing some
        possibilities.  YTVCIN should not be called in normal tasks -
        removed it from AIPS, APCLN, SDCLN, TVCPS, UVMAP, UTESS, VTESS,
        and TVDIC.
        YTVOPN, YTVCLS also should not normally be called - changed them
        to TVOPEN and TVCLOS in TVCPS and TVDIC.  Found a way that TVCPS
        could reset TVGAMA (most likely to 1.0) and fixed that.
        Moved nowhere.

 8649.  June 5, 1995             FITLD                       Phil
        My memory is failing me, thought I'd done this.
        As from 3 weeks ago the correlator labels the weight function as
        HANN instead of HANNING. Of course nobody told us and FITLD
        looks for HANNING. As a result the amplitude scaling for some
        projects is wrong (by a constant factor). Fixed FITLD to
        recognize both strings.
        Moved nowhere.

 8650.  June 6, 1995             FITLD                    Phil
        An obscure one. If a user read files off the tape which were
        written into separate files on disk (say C, S & X band) then
        stopped and deleted one of the bands. Then carried on with FITLD
        loading more files and appending to the existing files then,
        when FITLD had to create a new file after having appended to an
        existing one, it failed complaining about a lack of an FQ table.
        This happened because the logical DOFMAP was not reset
        correctly.
        Moved nowhere.

 8651.  June 6-7, 1995         CookBook                 Eric
        Anticipating changing chapters 5 and 6 into 1 chapter, I have
        revised most of the chapters of the CookBook ($AIPSPUBL/COOK*).
        Chapter 2 and Appendices A, B, G, and Y were not changed.  In
        Chapters 3 (basic), 6 (display) , 8 (line), and 9 (VLB),
        references to MX were changed to discuss IMAGR instead.
        GET4NAME was added to chapter 3 and PLAYR to Chapter 6.
        Chapter 13 (the lists of help files available via ABOUT) was
        updated by running SHOPH, changing all relevant ABOUT help
        files, and then making the same changes to COOK13.TEX.  The
        HYB.HLP file gave bad information (it called itself a task for
        starters) which was corrected and SHOPH re-run.  Help files
        changed were:
        ZZVLBI      ZZTASK      ZZRUN       ZZIMAGING   ZZCALIBRAT
        ZZAP        ZZVERB      ZZUV        ZZTV-APPL   ZZTV
        ZZTABLE     ZZSPECTRAL  ZZSINGLEDI  ZZPROCEDUR  ZZPLOT
        ZZOOP       ZZMODELING  ZZINTERACT  ZZCATALOG   ZZASTROMET
        ZZANALYSIS  ZZADVERB
        Moved nowhere - the WWW will be updated later.

 8652.  June 7, 1995             ZFREE                Eric
        Now that user 1 is automatically given access to reserved disks,
        ZFREE need to say "resrved" rather than "not you" to user 1.
        Moved nowhere.

 8653.  June 7, 1995             UVPLT                  Eric
        Changed the help file to explain "Craig's" scaling changes - he
        made 0.0 always mean self-scale when one might want it for a
        limit.  Added the option to weight the data in binning.
        Moved nowhere.

 8654.  June 7, 1995             MCUBE                Gustaaf
        When creating a new output cube, in which the first input map
        is not located at the first pixel in the output map, the
        location of the alternative reference pixel was wrong. Fixed
        this by changing the pixel location, not the value.
        Moved nowhere.

 8655.  June 8, 1995              $APGOOP/DTSUM           Phil
        DTSUM only dealt with single freqids. Fixed it so that it now
        prints information for all freqids in the file.
        Moved nowhere.

 8656.  June 9, 1995           500 boxes !  FILEBOX              Eric
        Changed TVUTIL, GRBOXS, AU5C, PLAYR, IMAGR, WFCLN, SCMAP to use
        the new include file DCLN.INC which gives the numebr of clean
        boxes from adverb CLBOX (50) and max allowed (now 500).  Wrote
        new verb FILEBOX to do REBOX with output to a text file (for
        IMAGR and WFCLN).  Changed POPSDAT.HLP, NEWPARMS.001, AU5C.FOR,
        and (new) FILEBOX.HLP for this.  Also COOK6.*.
        Moved nowhere.

 8657.  June 11, 1995              FILEBOX                      Eric
        The way I designed this was all wrong.  Changed AU5C and
        FILEBOX.HLP to read in the file if it pre-exists, modify those
        boxes in the currently chosen field which fit on the TV image,
        and write the lot back out.  Created new adverb BOXFILE to use
        for this: changed IMAGR and WFCLN helps to use this adverb,
        changed POPSDAT.HLP and NEWPARMS.001 to create it, and wrote a
        help file.  Also COOK6.TEX.
        To make it work I needed to use a scratch file.  So changed
        ZTXOPN, ZTXOP2, and ZTXZAP to accept any length file name and to
        call ZFULLN only if there is a colon in the file name.  Thus,
        one can either use it with a "standard" aips name or with a
        fully expanded name.  AU5C then calls ZFULLN to construct a
        scratch name and uses ZTXOPN to open it and ZTXZAP to delete it.
        Fixed a bug in IMAGR's reading of the BOXFILE.  It did not read
        round boxes correctly.
        Moved nowhere.

 8658.  June 11, 1995             UVCOP.FOR                    Leonia
        UVCOP has not modified the FREQID entries in IM table when
        splitting off a specific FREQID. Since FITLD loads all frequencies
        into one file this made some programs (INDXR for example, which
        looks at the IM table to make the new CL table) very confused.
        I added several selection critera including FREQID, ANTENNAS, IFs,
        TIMERANGE and SOURCES. IM table was excluded (in subroutine COPYHI)
        from the tables list copied by subroutine ALLTAB.FOR. The new
        subroutine IMSEL.FOR has been written for copying IM table with
        the selection criteria. FREQID is modified now to 1 if a specific
        FREQID is given in input adverbs and is copied without modification
        if FREQID=0 in input adverbs.
        Moved nowhere.

 8659.  June 12, 1995             $APGNOT/ANTAB.FOR            Athol
        Tidy up the reporting of bad time stamps found in reading tabulated
        TSYS or TANT data. Check time validity before searching NX table.
        Moved nowhere.

 8660.  June 12, 1995             $APGNOT/APCAL.FOR            Athol
        Improve clarity of error message concerning missing source flux
        densities in the SU table.
        Moved nowhere.

 8661.  June 12, 1995             $QPGNOT/PCAL.FOR             Athol
        Increase internal buffer size to double the number of allowed
        visibilities after averaging from 10,000 to 20,000. Also add
        code forwarded by Eric to add the full filename description to
        HI file.
        Moved nowhere.

 8662.  June 13, 1995      New CQ table routines               Athol
        Add new routines for correlator parameter frequency (CQ)
        table. Needed for VLBA FX correlator delay decorrelation
        corrections within the calibration system.
        $APLNOT/CQINI.FOR   -   Creates/initalizes CQ table
        $APLNOT/TABCQ.FOR   -   I/O to CQ table
        $INC/PCQV.INC       -   Parameter include for CQ table
        $APLNOT/CQMAKE.FOR  -   Utility subroutine to build a
                                CQ table if missing.
        Moved nowhere.

 8663.  June 13, 1995     $APGNOT/FXVLB.FOR  $HLPFIL/FXVLB.HLP  Athol
        New task to create a CQ table using information contained
        in the FQ and MC tables and the catalog header. Will replace
        $RUNSYS/FXAVG.001 shortly, and is provided for backward
        compatibility with files for which FITLD has not written a
        CQ table.
        Moved nowhere.

 8664.  June 12, 1995       Clean up old mail               Eric
        Changed:
        HOLGR     $HLPFIL - Rick's rewording suggestions.
        UVPRT     $HLPFIL - changed the holography added info to the
                  modern version.
        UVPLT     $YPGNOT - corrected the handling of UVGET calls for
                  the multiple FQ id mode.  An empty/missing FQ could
                  kill it because of an useless UVGET INIT call ahead of
                  the GINIT call or if the data were not self-scaled.
        Moved nowhere.

 8665.  June 17, 1995              ROBUST                   Eric
        Changed IMAGR, QUVUTIL, and UVWAIT to use 10**ROBUST rather than
        100**ROBUST.  Changed IMAGR and ROBUST help file for this and
        ran ispell on IMAGR's help file and otherwise cleaned up some
        wrong things.
        Moved nowhere.

 8666.  June 17, 1995             FILEBOX                   Eric
        Changed meaning of NFIELD = 0.  Now, on this it tries to get the
        field number from the CLASS of the loaded image.  It takes 1 as
        a last resort.  Changed AU5C and the help file.
        Moved nowhere.

 8667.  June 19, 1995             UVCOP                     Leonia
        The new subroutine IMSEL added to UVCOP (see #8658) has been
        detached from UVCOP.FOR and put in the $APLNOT.
        Moved nowhere.

 8668.  June 20, 1995            CookBook                   Eric
        Put back the new draft chapter on imaging - COOK5 - and revised
        the table of contents and a number of other chapters (in their
        references to 5).  Also updated some ZZ*.HLP and the FXVLB.HLP
        to add VLBI to its categories.
        Moved to the WWW/ftp area.

 8669.  June 21, 1995            CQ routines                 Athol
        Modified $INC/PCQV.INC, $APLNOT/CQINI.FOR and $APLNOT/TABCQ.FOR
        to add an extra field for FFT overlap. Corrected channel
        bandwidth filled by $APLNOT/CQMAKE.FOR. No impact as CQ tables
        not yet activated in calibration system.
        Moved nowhere.

***********************************************************************

        Changes while 15JUL95 was NEW:

***********************************************************************

 8670.  July 3, 1995           $SYSUNIX/LINK                 Pat
        Fixed a subtle but nasty bug in LINK.  If the LINK environment
        variable set in the $SYSLOCAL/LDOPTS.SH file contained a qualifier
        that started with -n (e.g. -native on SunOS), the bourne shell
        command "LINK=`echo $LINK | sed -e ...`" to change it to something
        else will not work as expected.  "echo" will see the "-n" and
        apparentyly ignore the rest of the string, thus resetting the
        variable to empty.  In the LINK script, this was happening to the
        LDOPTS variable when it tried to "squeeze out extra blanks" via a
        sed command like the above.  Removed the offending command (we can
        live with a few extra spaces).
        Moved to 15JAN96 this date.

 8671.  July 4, 1995           ZACTV8, FILEBOX              Eric
        A couple of fixes I could not do during the freeze:
        AU5C    Fix the default naming for the 1st field
        ZACTV8  Be self-defensive on the returned path name
        Moved to 15JUL95 this date.

 8672.  July 11, 1994            Help files                 Eric
        Fixed the one-liner for WTSUM and re-ran SHOPH.  This stated
        that changes were needed to 8 ABOUT files: ANALYSIS, ASTROMET,
        IMAGING, SINGLEDI, SPECTRAL, TABLE, TASK, and VLBI.  Updated
        these help files and changed COOK13 and COOK0 and RECIPE.TEX to
        adjust for it all.
        Moved to 15JUL95 as needed.

 8673.  July 12, 1995             FILEBOX                   Eric
        Redisigned FILEBOX in AU5C to write a complete backup file in
        the user's area with a related (but scratch) name and then zap
        and re-write the output file.  The backup is kept if there is
        any error and its name reported to the user.  The $FITS area is
        used only if the user does not include a logical area in the
        input file name.
        Moved to 15JUL95 this date.

 8674.  July 12, 1995               GNU                     Eric
        Created a GNUGPL.HLP from the short text in the help and the
        full GPL text in the Explain sections.  Changed AIPS.FOR to put
        out some lines witb info.
        Moved to 15JUL95 this date.

 8675.  July 12, 1995          ZACTV9 in APLUNIX         Chris
        Stopped ZACTV9 changing the process name of the debugger
        to that of the task.  Revision 3.0 and later of the
        SPARCworks debuggers use the process name to search for
        icon files and to obtain license-manager tokens and will
        not run if the process name is messed with.
        Moved from 15JAN96 on this date.

 8676.  July 13, 1995              PP                       Eric
        Removed "new version" message - it's not that new anymore.
        Corrected variable name that caused it to include the gnu
        copyleft stuff at first level includes.
        Moved to 15JUL95 this date.

 8677.  July 13, 1995             SCMAP                     Eric
        Corrected saving of WINdows - it used the old 50 boxes dimension
        rather than the parameterized one (now 500).  Later routines
        were correct and OOP defended itself.
        Moved to 15JUL95 this date.

 8678.  July 13, 1995           PLAYR                       Eric
        Corrected minor errors in help file.  Typed up a new
        HLPPLAYR.HLP file since the old one was lost in a putbck
        screwup.  Corrected the code to allow for HLPPLAYR and to see
        that graphics planes are off when empty.
        Moved to 15JUL95 this date.

 8679.  July 14, 1995            OTFUV                      Eric
        Changed OTFUV to add time smoothing - an averaging interval and
        an output increment - to the task.  This should save disk space
        without comromising the imaging.  It has suprisingly large
        effects on SDGRD's output, but after baseline removal an
        averaging of 2 or 3 has only a little effect.
        Moved to 15JUL95 this date.

 8680.  July 18, 1995    $APGNOT/PCLOD.FOR   $HLPFIL/PCLOD.HLP  Athol
        Upgrade PCLOD, which reads VLBA pulse-cal information from
        an ASCII text file, to correctly handle data with multiple
        freq. ID's. In addition, now reads the NX table to assign source
        ID's to the SN table entries and is more robust in handling
        mixed state count/pulse cal. modes.
        Moved to 15JAN96 this date.

 8681.  July 18, 1995              EGETNAME                 Eric
        Fixed AU8 to do EGETNAME again.  It got lost in the code
        clean-up accompanying the new GET4NAME...
        Moved to 15JUL95 this date.

 8682.  July 18, 1995           IMAGR, SCMAP                 Eric
        Fixed both tasks to force the IMSIZE to be a power of two.
        Changed SCMAP to set NITER to 300 if the user sets it <= 0.
        Moved to 15JUL95 this date.

 8683.  July 18, 1995            AIPS                        Eric
        Tried centering the GNU message to see if that's more readable.
        Moved to 15JUL95 this date.

 8684.  July 20, 1995        $YSERV/XAS.SHR (Makefile*)       Pat
        Made some changes to the Makefile that avoid the need to edit the
        file on most systems.  Ultrix (4.3) needs its own; its version of
        make is more primitive.  Otherwise it works without editing on
        all our other architectures.  It now includes the -R option for
        Solaris 2.x systems to burn in the library locations.
        Moved from 15JAN96 this date.

 8685.  July 20, 1995               ZMSSRV                   Jeff/Eric
        Corrected the length argument to gethostbyaddr.  Giving it too
        much was okay with everybody until Solaris 2.4.
        Moved to 15JUL95 this date.

 8686.  July 20, 1995            HISTORY, SCMAP              ERic
        Added more adverbs to history from SCMAP and corrected HISTORY
        which had too small a buffer for possible adverbs to go to
        history.  Raised it from 50 to 500 - CLBOX requires 200.
        Moved to 15JUL95 this date.

 8687.  July 21, 1995 $QPGNOT/LPCAL.FOR & LPCAL.HLP  Kari Leppanen via Athol
        New polarization calibration task, contributed by Kari Leppanen.
        Algorithm is described in his thesis, also Leppanen, Zensus and
        Diamond, 1995, ApJ (in press).
        Moved to 15JAN96 this date.

 8688.  July 21, 1995   $APGOOP/CCEDT.FOR   CCEDT.HLP  K.Leppanen/ Athol
        New features in CCEDT which are required by new polarization
        calibration task LPCAL. These include the ability to write
        multiple CC output tables and an option to automatically
        select CC boxes satisfying a flux constraint.
        Moved to 15JAN96 this date

 8689.  July 26, 1995          $YPGNOT/VPLOT.FOR          Leonia
        The task plots different baselines for ANTENNAS=0,
        BASELINE=list and BASELINE=0, ANTENNAS=list. Inspite of
        exhaustive comment in HELP complains occurs somtimes.
        I have added a couple of warnings.
        Moved to 15JAN96 July 25

 8690.  July 26, 1995        $APGNOT/ACCOR                  Leonia
        The task has put unit in the SN table in the case of data absence
        for a given time interval. It provided some errors in result of
        application of output SN table near gaps of the data.
        I have changed the unit on blank.
        Moved to 15JAN96 July 25

 8691.  July 26, 1995   $APGNOT/PCCOR.FOR                       Leonia
        The new task PCCOR corrects instrumental phase and delay offsets
        using pulse-calibration information in the PC table.
        Pulse-calibration tones are injected into the VLBA receivers and,
        in conjunction with the cable calibration system, can be used to
        measure and track instrumental variations in delay and phase
        between separate baseband converters. The measured phases of the
        tones allow the connection of the phase across all the IFs.
        The phase difference between two tones in the same IF allows the
        estimation of the instrumental single-band delay for that IF.
        The measurement of single band instrumental delay is however
        subject to ambiguity due to the 2pi*N ambiguity in measured
        phase. To resolve this ambiguity, the task uses observed
        visibility data taken on a calibrator. The ambiguity factor is
        determined by the condition of maximum coherence. The ambiguity
        factor is determined in this manner for each polarization, IF and
        antenna relative to the reference antenna. The adverbs, TIMERANG,
        CALSOUR and FREQID select both UV and PC table calibrator data.
        Currently PCCOR assumed only two tones are measured for each IF.
        Each FREQID and SUBARRAY must be processed separately.
        Moved to 15JAN96 July 25

 8692.  July 26, 1995           $APGNOT/CLCOR.FOR          Leonia
        Right handed coordinate system is used in VLA.
        Left handed coordinate system is used in VLBA.
        I have changed the codes to have an agreements with HELP and
        make the task provide a correct correction with default
        value of CLCORPRM(4)=0 for VLBA and VLA.
        The relevant change of HELP has been done as well.
        Moved to 15JAN96 this date

 8693.  July 26, 1995        $APGNOT/UVCRS.FOR             Leonia
        The task has not worked if a start day is more than 1.
        I have fixed it
        Moved to 15JAN96 this date

 8694.  July 28, 1995        New adverb: DELCORR              Phil
        Added a new adverb to control the generation of the CQ table in
        FITLD. The default is to create the CQ table. Once generated,
        and when delay corrections are applied to VLBA data at a later
        point, the 2nd order corrections described in Athol's AIPS Memo
        90 will be applied to the data.
        Moved from 15JAN96 today.

 8695.  July 28, 1995            FITLD                        Phil
        Several changes:
        We have known for a few weeks now that AIPS has problems in some
        areas, especially fringe-fitting, if the reference frequency is
        not in IF 1. FITLD would always sort the incoming VLBA data into
        increasing freq. order but would not adjust the reference IF
        from that labelled at the correlator. Now it performs the
        adjustemnt so that IF 1 always contains the ref. freq.
        Also increased the size of a couple of buffers to deal with the
        large number of channels being routinely generated by the VLBA &
        ATNF.
        When FITLD encountered a file with a large number of FQIDs the
        output FQ table did not correctly describe the data due to an
        indexing bug in labelling the rows of the FQ table as it was
        being written.  Fixed, also increased the maximum number of
        FQIDs to 100 from 10.
        Moved nowhere yet.
        Added the DELCORR adverb and ensured that CQMAKE is called if
        necessary.
        Moved from 15JAN96 today.

 8696.  July 30, 1995     Update HLP files                   Athol
        Update some help files in preparation for the new release:
        FXVLB.HLP:  Add EXPLAIN section
        ANTAB.HLP:  Document DPFU=RCP,LCP mode more clearly
        PCLOD.HLP:  Change contact person for PCLOD text files.
        Moved from 15JAN96 today.

 8697.  July 31, 1995               OTFUV                    Eric
        Change output header to put the SD 12m beam width in the Clean
        beam major and minor axis.
        Moved to 15JUL95 this date.

 xxxx.  July 30, 1995        Convolving functions           Eric
        Add circular functions and a type 6 = BESSJ1(x)/x * exp.
        Changes:
        Moved nowhere.

 8698.  July 31, 1995               SDGRD                    Eric
        Change CONVFN to add type 6 and circular storage, GRDFLT to add
        type 6 and circular; clean up code and create BESSJ1 function.
        Changed QGRD6 and QGRD7 to do circular as well as separable
        convolving functions.  Changed SDGRD by appending all these (so
        that they will not affect other tasks) and to allow for circular
        functions, Bessel functions, and functions specified in arc
        seconds rather than cells.
        Moved by appending method from 15JAN96.

 8699.  Aug 1, 1995                 FITLD                      Phil
        Very minor change to avoid trying to create a new CQ table when
        one already exists.
        Moved from 15JAN96.

 8700.  Aug 1, 1995     VLBA delay decorrelation           Athol
        Perform delay decorrelation corrections for VLBA data using
        information in the CQ table. These include spectral averaging
        and segmentation loss corrections, which are further described
        in AIPS Memo. 90. This method replaces the previous use of the
        SPEC_AVG keyword in the AN table so that these corrections
        are implemented in a more robust form that is less sensitive
        to changes in the frequency structure of the uv-data during
        calibration. Several options which are possible in the VLBA
        correlator, but not yet implemented, have been anticipated
        in the new format. For further information, consult the
        AIPS Memo. mentioned above or type EXPLAIN FXVLB.
          Changes include:
        $INC/DSEL.INC - Add new arrays to contain the information
           required for the segmentation corrections.
        $APLNOT/SELINI.FOR - Reset new DSEL.INC variables.
        $APLNOT/GAININ.FOR - New call format to DSMEAR
        $APLNOT/DSMEAR.FOR - Re-written to use CQ information
        $APLNOT/FXSEG.FOR  - New routine to calculate segmentation
           losses.
        $APLNOT/DATGET.FOR - pass subarray number to DATCAL
        $APLNOT/DATCAL.FOR - add segmentation corrections, also
           warning if VLBA data with no CQ information but delay
           solutions are being applied.
        Move from 15JAN96 Aug 1, 1995.

 8701.  Aug 1, 1995       $APGNOT/SPLIT.FOR              Athol
        Disable copy of the GC and CQ tables. Also add a history
        record noting whether the CQ table in present and hence
        VLBA delay decorrelation corrections are activated.
        Move from 15JAN96 on Aug, 1, 1995.

 8702.  Aug 1, 1995       $APGNOT/VBGLU.FOR              Athol
        Disable copy of CQ table. Also increase MAXBAS to 1000000
        as recently modified in TST.
        Moved from 15JAN96 on Aug 1, 1995.

 8703.








