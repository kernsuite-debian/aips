      DEFINE TPVF1(ITY,A,N,KY,BV,IWK,I)
"-----------------------------------------------------------------------
"! FPS VFC routine: Undocumented routine.
"# AP-appl
"-----------------------------------------------------------------------
";  Copyright (C) 1995
";  Associated Universities, Inc. Washington DC, USA.
";
";  This program is free software; you can redistribute it and/or
";  modify it under the terms of the GNU General Public License as
";  published by the Free Software Foundation; either version 2 of
";  the License, or (at your option) any later version.
";
";  This program is distributed in the hope that it will be useful,
";  but WITHOUT ANY WARRANTY; without even the implied warranty of
";  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
";  GNU General Public License for more details.
";
";  You should have received a copy of the GNU General Public
";  License along with this program; if not, write to the Free
";  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
";  MA 02139, USA.
";
";  Correspondence concerning AIPS should be addressed as follows:
";         Internet email: aipsmail@nrao.edu.
";         Postal address: AIPS Project Office
";                         National Radio Astronomy Observatory
";                         520 Edgemont Road
";                         Charlottesville, VA 22903-2475 USA
"-----------------------------------------------------------------------
"-----------------------------------------------------------------------
      LOCAL KYN,KM1,IY,IAJ,IDP,IDM,ITM,JTM,JTM1,IMKY,IMKYN
      LOCAL III,ITYI,ITYIM1,J,KMJ,ILO,JJ,JJN,JJM1,ILOM1,JJM1N
      LOCAL II1,II2,II3,II4
      KYN=KY*N
      KM1=KY-1
"                                      AP ADDRESSES:
      IY=IWK
      IAJ=IY+1
      IDP=IAJ+KYN
      IDM=IDP+KY
      ITM=IDM+KY
      JTM=ITM+N
      JTM1=JTM+1
"
      CALL VCLR(BV,1,N)
      IMKY=I-KY
      IMKYN=IMKY*N
      III=A+IMKYN
      CALL VMOV(III,1,IAJ,1,KYN)
      IF KY = 1 GOTO ZZ
      CALL VFILL(IY,IDM,1,KY)
      CALL VNEG(IDM,1,IDP,1,KY)
      ITYI=ITY+I
      ITYIM1=ITYI-1
      CALL VADD(ITYI,1,IDP,1,IDP,1,KY)
      CALL VSUB(ITYIM1,-1,IDM,1,IDM,1,KY)
      J=0
 AA:     J=J+1
         KMJ=KY-J
         ILO=KMJ
         JJ=0
 BB:        JJ=JJ+1
            JJN=JJ*N
            JJM1=JJ-1
            ILOM1=ILO-1
            JJM1N=JJM1*N
            II1=IAJ+JJN
            II2=IDM+ILOM1
            II3=IAJ+JJM1N
            II4=IDP+JJM1
            CALL VSMUL(II1,1,II2,ITM,1,N)
            CALL VSMA(II3,1,II4,ITM,1,ITM,1,N)
            CALL VADD(II2,1,II4,1,JTM,1,1)
            CALL VCLR(JTM1,1,1)
            CALL VTSADD(JTM1,1,2049,JTM1,1,1)
            CALL VDIV(JTM,1,JTM1,1,JTM1,1,1)
            CALL VSMUL(ITM,1,JTM1,II3,1,N)
            ILO=ILO-1
            IF JJ < KMJ GOTO BB
         IF J < KM1 GOTO AA
 ZZ:  CALL VMOV(IAJ,1,BV,1,N)
      END
