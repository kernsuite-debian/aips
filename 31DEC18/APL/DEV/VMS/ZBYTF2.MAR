        .TITLE ZBYTF2 (NWORDS, BYTFLP, NBITWD, INBUF, OUTBUF)
;----------------------------------------------------------------------
;! interchange bytes in buffer if needed to go between local & standard
;# Z2 Tape FITS
;-----------------------------------------------------------------------
;;  Copyright (C) 1995
;;  Associated Universities, Inc. Washington DC, USA.
;;
;;  This program is free software; you can redistribute it and/or
;;  modify it under the terms of the GNU General Public License as
;;  published by the Free Software Foundation; either version 2 of
;;  the License, or (at your option) any later version.
;;
;;  This program is distributed in the hope that it will be useful,
;;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;  GNU General Public License for more details.
;;
;;  You should have received a copy of the GNU General Public
;;  License along with this program; if not, write to the Free
;;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
;;  MA 02139, USA.
;;
;;  Correspondence concerning AIPS should be addressed as follows:
;;         Internet email: aipsmail@nrao.edu.
;;         Postal address: AIPS Project Office
;;                         National Radio Astronomy Observatory
;;                         520 Edgemont Road
;;                         Charlottesville, VA 22903-2475 USA
;-----------------------------------------------------------------------
;----------------------------------------------------------------------
;   ZBYTF2 will interchange the low order and high order bytes for all
;   words in the input buffer and put the results in an output buffer.
;   The input buffer is unchanged except in the special case where the
;   input buffer has the same starting address as the output buffer.
;   Inputs:
;      NWORDS   I       The length of the input buffer in 16 bit words.
;      BYTFLP   I       Byte flip code: 0 none, 1 bytes, 2 word, 3 both
;      NBITWD   I       Number bits / word
;      INBUF    I*2(*)  Input buffer
;   Output:
;      OUTBUF   I*2(*)  Buffer containing byte swapped words
;   VMS version - assumes BYTFLP = 3
;----------------------------------------------------------------------
;                                       Define augument list offsets
NWORDS = 4
BYTFL = 8
NBITWD = 12
INBUF  = 16
OUTBUF = 20
;----------------------------------------------------------------------
        .PSECT  CODE,NOWRT
        .ENTRY  ZBYTF2,^M<R2,R3,R4,R5>
;                                       Put arguments in registers
        MOVL    @NWORDS(AP),R2          ; No. of words in R2.
        TSTW    R2                      ; Compare no. words to zero
        BLEQ    EOB                     ; Return if .LE. 0.
        MOVL    INBUF(AP),R3            ; Addr. of input buffer in R3.
        MOVL    OUTBUF(AP),R4           ; Addr. of output buff. in R4.
                                        ;
                                        ; LOOP FOR NUMBER OF WORDS
                                        ;
LOOP:   MOVB    (R3)+,R5                ; 1st byte of input into R5.
        MOVB    (R3)+,R6                ; 2nd byte of input in R6.
        MOVB    R6,(R4)+                ; Put back in reverse order
        MOVB    R5,(R4)+
        SOBGTR  R2,LOOP                 ; Loop for next word.
                                        ;
EOB:    RET
        .END
