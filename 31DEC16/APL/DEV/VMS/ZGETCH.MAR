      .TITLE ZGETCH (ICHAR, WORD, NCHAR)
;-----------------------------------------------------------------------
;! get a character from a REAL word
;# Z Binary
;-----------------------------------------------------------------------
;;  Copyright (C) 1995
;;  Associated Universities, Inc. Washington DC, USA.
;;
;;  This program is free software; you can redistribute it and/or
;;  modify it under the terms of the GNU General Public License as
;;  published by the Free Software Foundation; either version 2 of
;;  the License, or (at your option) any later version.
;;
;;  This program is distributed in the hope that it will be useful,
;;  but WITHOUT ANY WARRANTY; without even the implied warranty of
;;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;  GNU General Public License for more details.
;;
;;  You should have received a copy of the GNU General Public
;;  License along with this program; if not, write to the Free
;;  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
;;  MA 02139, USA.
;;
;;  Correspondence concerning AIPS should be addressed as follows:
;;         Internet email: aipsmail@nrao.edu.
;;         Postal address: AIPS Project Office
;;                         National Radio Astronomy Observatory
;;                         520 Edgemont Road
;;                         Charlottesville, VA 22903-2475 USA
;-----------------------------------------------------------------------
;-----------------------------------------------------------------------
;   Extracts the character in position NCHAR of the REAL argument WORD
;   and inserts it in the least significant bits of the INTEGER argument
;   ICHAR with zero in the rest.  It should also work for INTEGER WORD
;   as long as NCHAR is valid.  Characters are numbered from 1 in the
;   order in which they would be printed by a Fortran "A" format
;   specifier.  NOTE - we actually get 8 bits here - so this routine
;   works for bytes too.
;   Inputs:
;      WORD   R   Word from which the character is to be extracted
;      NCHAR  I   Position of character to extract
;   Output:
;      ICHAR  I   Extracted character in LS bits, zero in the rest
;   VMS version - checks NCHAR between 1 and 4.
;-----------------------------------------------------------------------
ICHAR = 4
WORD = 8
NCHAR = 12
;-----------------------------------------------------------------------
        .PSECT  CODE,NOWRT
        .ENTRY ZGETCH,^M<R2>
                                        ;
        MOVL    @NCHAR(AP),R2
        CMPl    R2,#4                   ; See if NCHAR .GT. 4
        BGTR    QUIT
        CMPl    R2,#1                   ; See if NCHAR .LT. 1
        BLSS    QUIT
        SUBL2   #1,R2
        MOVZBL  @WORD(AP)[R2],@ICHAR(AP)
QUIT:
        RET
        .END
