      DEFINE TPVF2(II,NX,IBR,IH,IX,ICOEF,JCOEF,L,K,IRFMM,IWK2,IY)
"-----------------------------------------------------------------------
"! FPS VFC routine: Undocumented routine.
"# AP-appl
"-----------------------------------------------------------------------
";  Copyright (C) 1995
";  Associated Universities, Inc. Washington DC, USA.
";
";  This program is free software; you can redistribute it and/or
";  modify it under the terms of the GNU General Public License as
";  published by the Free Software Foundation; either version 2 of
";  the License, or (at your option) any later version.
";
";  This program is distributed in the hope that it will be useful,
";  but WITHOUT ANY WARRANTY; without even the implied warranty of
";  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
";  GNU General Public License for more details.
";
";  You should have received a copy of the GNU General Public
";  License along with this program; if not, write to the Free
";  Software Foundation, Inc., 675 Massachusetts Ave, Cambridge,
";  MA 02139, USA.
";
";  Correspondence concerning AIPS should be addressed as follows:
";         Internet email: aipsmail@nrao.edu.
";         Postal address: AIPS Project Office
";                         National Radio Astronomy Observatory
";                         520 Edgemont Road
";                         Charlottesville, VA 22903-2475 USA
"-----------------------------------------------------------------------
"-----------------------------------------------------------------------
      LOCAL MM,LL,KK
      CALL VFLT(II,1,II,1,NX)
      CALL VINDEX(IBR,II,1,IH,1,NX)
      CALL VNEG(IH,1,IH,1,NX)
      CALL VADD(IH,1,IX,1,IH,1,NX)
      CALL MTRANS(ICOEF,1,JCOEF,1,L,K)
      CALL VCLR(IY,1,NX)
      MM=0
      LL=K*L
      LL=JCOEF+LL
 A:      KK=IRFMM+MM
         MM=MM+1
         CALL VSMUL(IY,1,KK,IY,1,NX)
         CALL VMUL(IY,1,IH,1,IY,1,NX)
         LL=LL-L
         CALL VINDEX(LL,II,1,IWK2,1,NX)
         CALL VADD(IY,1,IWK2,1,IY,1,NX)
         IF MM<K GOTO A
      END
